(()=>{var e={9176:e=>{"use strict";e.exports={mask:(e,t,s,i,r)=>{for(var n=0;n<r;n++)s[i+n]=e[n]^t[3&n]},unmask:(e,t)=>{const s=e.length;for(var i=0;i<s;i++)e[i]^=t[3&i]}}},1098:(e,t,s)=>{"use strict";try{e.exports=s(8495)(__dirname)}catch(t){e.exports=s(9176)}},4570:(e,t,s)=>{"use strict";const i=s(7147),r=s(1017),n=i.lchown?"lchown":"chown",o=i.lchownSync?"lchownSync":"chownSync",h=i.lchown&&!process.version.match(/v1[1-9]+\./)&&!process.version.match(/v10\.[6-9]/),a=(e,t,s)=>{try{return i[o](e,t,s)}catch(e){if("ENOENT"!==e.code)throw e}},l=h?(e,t,s,r)=>n=>{n&&"EISDIR"===n.code?i.chown(e,t,s,r):r(n)}:(e,t,s,i)=>i,c=h?(e,t,s)=>{try{return a(e,t,s)}catch(r){if("EISDIR"!==r.code)throw r;((e,t,s)=>{try{i.chownSync(e,t,s)}catch(e){if("ENOENT"!==e.code)throw e}})(e,t,s)}}:(e,t,s)=>a(e,t,s),u=process.version;let d=(e,t,s)=>i.readdir(e,t,s);/^v4\./.test(u)&&(d=(e,t,s)=>i.readdir(e,s));const f=(e,t,s,r)=>{i[n](e,t,s,l(e,t,s,(e=>{r(e&&"ENOENT"!==e.code?e:null)})))},p=(e,t,s,n,o)=>{if("string"==typeof t)return i.lstat(r.resolve(e,t),((i,r)=>{if(i)return o("ENOENT"!==i.code?i:null);r.name=t,p(e,r,s,n,o)}));if(t.isDirectory())m(r.resolve(e,t.name),s,n,(i=>{if(i)return o(i);const h=r.resolve(e,t.name);f(h,s,n,o)}));else{const i=r.resolve(e,t.name);f(i,s,n,o)}},m=(e,t,s,i)=>{d(e,{withFileTypes:!0},((r,n)=>{if(r){if("ENOENT"===r.code)return i();if("ENOTDIR"!==r.code&&"ENOTSUP"!==r.code)return i(r)}if(r||!n.length)return f(e,t,s,i);let o=n.length,h=null;const a=r=>{if(!h)return r?i(h=r):0==--o?f(e,t,s,i):void 0};n.forEach((i=>p(e,i,t,s,a)))}))},_=(e,t,s)=>{let n;try{n=((e,t)=>i.readdirSync(e,t))(e,{withFileTypes:!0})}catch(i){if("ENOENT"===i.code)return;if("ENOTDIR"===i.code||"ENOTSUP"===i.code)return c(e,t,s);throw i}return n&&n.length&&n.forEach((n=>((e,t,s,n)=>{if("string"==typeof t)try{const s=i.lstatSync(r.resolve(e,t));s.name=t,t=s}catch(e){if("ENOENT"===e.code)return;throw e}t.isDirectory()&&_(r.resolve(e,t.name),s,n),c(r.resolve(e,t.name),s,n)})(e,n,t,s))),c(e,t,s)};e.exports=m,m.sync=_},2276:(e,t,s)=>{"use strict";const i=s(7008),r=s(2361).EventEmitter,n=s(7147);let o=n.writev;if(!o){const e=process.binding("fs"),t=e.FSReqWrap||e.FSReqCallback;o=(s,i,r,n)=>{const o=new t;o.oncomplete=(e,t)=>n(e,t,i),e.writeBuffers(s,i,r,o)}}const h=Symbol("_autoClose"),a=Symbol("_close"),l=Symbol("_ended"),c=Symbol("_fd"),u=Symbol("_finished"),d=Symbol("_flags"),f=Symbol("_flush"),p=Symbol("_handleChunk"),m=Symbol("_makeBuf"),_=Symbol("_mode"),y=Symbol("_needDrain"),w=Symbol("_onerror"),b=Symbol("_onopen"),g=Symbol("_onread"),E=Symbol("_onwrite"),S=Symbol("_open"),v=Symbol("_path"),k=Symbol("_pos"),R=Symbol("_queue"),O=Symbol("_read"),x=Symbol("_readSize"),T=Symbol("_reading"),L=Symbol("_remain"),C=Symbol("_size"),N=Symbol("_write"),I=Symbol("_writing"),A=Symbol("_defaultFlag"),D=Symbol("_errored");class P extends i{constructor(e,t){if(super(t=t||{}),this.readable=!0,this.writable=!1,"string"!=typeof e)throw new TypeError("path must be a string");this[D]=!1,this[c]="number"==typeof t.fd?t.fd:null,this[v]=e,this[x]=t.readSize||16777216,this[T]=!1,this[C]="number"==typeof t.size?t.size:1/0,this[L]=this[C],this[h]="boolean"!=typeof t.autoClose||t.autoClose,"number"==typeof this[c]?this[O]():this[S]()}get fd(){return this[c]}get path(){return this[v]}write(){throw new TypeError("this is a readable stream")}end(){throw new TypeError("this is a readable stream")}[S](){n.open(this[v],"r",((e,t)=>this[b](e,t)))}[b](e,t){e?this[w](e):(this[c]=t,this.emit("open",t),this[O]())}[m](){return Buffer.allocUnsafe(Math.min(this[x],this[L]))}[O](){if(!this[T]){this[T]=!0;const e=this[m]();if(0===e.length)return process.nextTick((()=>this[g](null,0,e)));n.read(this[c],e,0,e.length,null,((e,t,s)=>this[g](e,t,s)))}}[g](e,t,s){this[T]=!1,e?this[w](e):this[p](t,s)&&this[O]()}[a](){if(this[h]&&"number"==typeof this[c]){const e=this[c];this[c]=null,n.close(e,(e=>e?this.emit("error",e):this.emit("close")))}}[w](e){this[T]=!0,this[a](),this.emit("error",e)}[p](e,t){let s=!1;return this[L]-=e,e>0&&(s=super.write(e<t.length?t.slice(0,e):t)),(0===e||this[L]<=0)&&(s=!1,this[a](),super.end()),s}emit(e,t){switch(e){case"prefinish":case"finish":break;case"drain":"number"==typeof this[c]&&this[O]();break;case"error":if(this[D])return;return this[D]=!0,super.emit(e,t);default:return super.emit(e,t)}}}class B extends r{constructor(e,t){super(t=t||{}),this.readable=!1,this.writable=!0,this[D]=!1,this[I]=!1,this[l]=!1,this[y]=!1,this[R]=[],this[v]=e,this[c]="number"==typeof t.fd?t.fd:null,this[_]=void 0===t.mode?438:t.mode,this[k]="number"==typeof t.start?t.start:null,this[h]="boolean"!=typeof t.autoClose||t.autoClose;const s=null!==this[k]?"r+":"w";this[A]=void 0===t.flags,this[d]=this[A]?s:t.flags,null===this[c]&&this[S]()}emit(e,t){if("error"===e){if(this[D])return;this[D]=!0}return super.emit(e,t)}get fd(){return this[c]}get path(){return this[v]}[w](e){this[a](),this[I]=!0,this.emit("error",e)}[S](){n.open(this[v],this[d],this[_],((e,t)=>this[b](e,t)))}[b](e,t){this[A]&&"r+"===this[d]&&e&&"ENOENT"===e.code?(this[d]="w",this[S]()):e?this[w](e):(this[c]=t,this.emit("open",t),this[f]())}end(e,t){return e&&this.write(e,t),this[l]=!0,this[I]||this[R].length||"number"!=typeof this[c]||this[E](null,0),this}write(e,t){return"string"==typeof e&&(e=Buffer.from(e,t)),this[l]?(this.emit("error",new Error("write() after end()")),!1):null===this[c]||this[I]||this[R].length?(this[R].push(e),this[y]=!0,!1):(this[I]=!0,this[N](e),!0)}[N](e){n.write(this[c],e,0,e.length,this[k],((e,t)=>this[E](e,t)))}[E](e,t){e?this[w](e):(null!==this[k]&&(this[k]+=t),this[R].length?this[f]():(this[I]=!1,this[l]&&!this[u]?(this[u]=!0,this[a](),this.emit("finish")):this[y]&&(this[y]=!1,this.emit("drain"))))}[f](){if(0===this[R].length)this[l]&&this[E](null,0);else if(1===this[R].length)this[N](this[R].pop());else{const e=this[R];this[R]=[],o(this[c],e,this[k],((e,t)=>this[E](e,t)))}}[a](){if(this[h]&&"number"==typeof this[c]){const e=this[c];this[c]=null,n.close(e,(e=>e?this.emit("error",e):this.emit("close")))}}}t.ReadStream=P,t.ReadStreamSync=class extends P{[S](){let e=!0;try{this[b](null,n.openSync(this[v],"r")),e=!1}finally{e&&this[a]()}}[O](){let e=!0;try{if(!this[T]){for(this[T]=!0;;){const e=this[m](),t=0===e.length?0:n.readSync(this[c],e,0,e.length,null);if(!this[p](t,e))break}this[T]=!1}e=!1}finally{e&&this[a]()}}[a](){if(this[h]&&"number"==typeof this[c]){const e=this[c];this[c]=null,n.closeSync(e),this.emit("close")}}},t.WriteStream=B,t.WriteStreamSync=class extends B{[S](){let e;if(this[A]&&"r+"===this[d])try{e=n.openSync(this[v],this[d],this[_])}catch(e){if("ENOENT"===e.code)return this[d]="w",this[S]();throw e}else e=n.openSync(this[v],this[d],this[_]);this[b](null,e)}[a](){if(this[h]&&"number"==typeof this[c]){const e=this[c];this[c]=null,n.closeSync(e),this.emit("close")}}[N](e){let t=!0;try{this[E](null,n.writeSync(this[c],e,0,e.length,this[k])),t=!1}finally{if(t)try{this[a]()}catch(e){}}}}},7008:(e,t,s)=>{"use strict";const i="object"==typeof process&&process?process:{stdout:null,stderr:null},r=s(2361),n=s(2781),o=s(1123),h=s(1576).StringDecoder,a=Symbol("EOF"),l=Symbol("maybeEmitEnd"),c=Symbol("emittedEnd"),u=Symbol("emittingEnd"),d=Symbol("emittedError"),f=Symbol("closed"),p=Symbol("read"),m=Symbol("flush"),_=Symbol("flushChunk"),y=Symbol("encoding"),w=Symbol("decoder"),b=Symbol("flowing"),g=Symbol("paused"),E=Symbol("resume"),S=Symbol("bufferLength"),v=Symbol("bufferPush"),k=Symbol("bufferShift"),R=Symbol("objectMode"),O=Symbol("destroyed"),x="1"!==global._MP_NO_ITERATOR_SYMBOLS_,T=x&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),L=x&&Symbol.iterator||Symbol("iterator not implemented"),C=e=>"end"===e||"finish"===e||"prefinish"===e;e.exports=class e extends n{constructor(e){super(),this[b]=!1,this[g]=!1,this.pipes=new o,this.buffer=new o,this[R]=e&&e.objectMode||!1,this[R]?this[y]=null:this[y]=e&&e.encoding||null,"buffer"===this[y]&&(this[y]=null),this[w]=this[y]?new h(this[y]):null,this[a]=!1,this[c]=!1,this[u]=!1,this[f]=!1,this[d]=null,this.writable=!0,this.readable=!0,this[S]=0,this[O]=!1}get bufferLength(){return this[S]}get encoding(){return this[y]}set encoding(e){if(this[R])throw new Error("cannot set encoding in objectMode");if(this[y]&&e!==this[y]&&(this[w]&&this[w].lastNeed||this[S]))throw new Error("cannot change encoding");this[y]!==e&&(this[w]=e?new h(e):null,this.buffer.length&&(this.buffer=this.buffer.map((e=>this[w].write(e))))),this[y]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[R]}set objectMode(e){this[R]=this[R]||!!e}write(e,t,s){if(this[a])throw new Error("write after end");return this[O]?(this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0):("function"==typeof t&&(s=t,t="utf8"),t||(t="utf8"),this[R]||Buffer.isBuffer(e)||(i=e,!Buffer.isBuffer(i)&&ArrayBuffer.isView(i)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(e=>e instanceof ArrayBuffer||"object"==typeof e&&e.constructor&&"ArrayBuffer"===e.constructor.name&&e.byteLength>=0)(e)?e=Buffer.from(e):"string"!=typeof e&&(this.objectMode=!0)),this.objectMode||e.length?("string"!=typeof e||this[R]||t===this[y]&&!this[w].lastNeed||(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[y]&&(e=this[w].write(e)),this.flowing?(0!==this[S]&&this[m](!0),this.flowing?this.emit("data",e):this[v](e)):this[v](e),0!==this[S]&&this.emit("readable"),s&&s(),this.flowing):(0!==this[S]&&this.emit("readable"),s&&s(),this.flowing));var i}read(e){if(this[O])return null;try{return 0===this[S]||0===e||e>this[S]?null:(this[R]&&(e=null),this.buffer.length>1&&!this[R]&&(this.encoding?this.buffer=new o([Array.from(this.buffer).join("")]):this.buffer=new o([Buffer.concat(Array.from(this.buffer),this[S])])),this[p](e||null,this.buffer.head.value))}finally{this[l]()}}[p](e,t){return e===t.length||null===e?this[k]():(this.buffer.head.value=t.slice(e),t=t.slice(0,e),this[S]-=e),this.emit("data",t),this.buffer.length||this[a]||this.emit("drain"),t}end(e,t,s){return"function"==typeof e&&(s=e,e=null),"function"==typeof t&&(s=t,t="utf8"),e&&this.write(e,t),s&&this.once("end",s),this[a]=!0,this.writable=!1,!this.flowing&&this[g]||this[l](),this}[E](){this[O]||(this[g]=!1,this[b]=!0,this.emit("resume"),this.buffer.length?this[m]():this[a]?this[l]():this.emit("drain"))}resume(){return this[E]()}pause(){this[b]=!1,this[g]=!0}get destroyed(){return this[O]}get flowing(){return this[b]}get paused(){return this[g]}[v](e){return this[R]?this[S]+=1:this[S]+=e.length,this.buffer.push(e)}[k](){return this.buffer.length&&(this[R]?this[S]-=1:this[S]-=this.buffer.head.value.length),this.buffer.shift()}[m](e){do{}while(this[_](this[k]()));e||this.buffer.length||this[a]||this.emit("drain")}[_](e){return!!e&&(this.emit("data",e),this.flowing)}pipe(e,t){if(this[O])return;const s=this[c];t=t||{},e===i.stdout||e===i.stderr?t.end=!1:t.end=!1!==t.end;const r={dest:e,opts:t,ondrain:e=>this[E]()};return this.pipes.push(r),e.on("drain",r.ondrain),this[E](),s&&r.opts.end&&r.dest.end(),e}addListener(e,t){return this.on(e,t)}on(e,t){try{return super.on(e,t)}finally{"data"!==e||this.pipes.length||this.flowing?C(e)&&this[c]?(super.emit(e),this.removeAllListeners(e)):"error"===e&&this[d]&&t.call(this,this[d]):this[E]()}}get emittedEnd(){return this[c]}[l](){this[u]||this[c]||this[O]||0!==this.buffer.length||!this[a]||(this[u]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[f]&&this.emit("close"),this[u]=!1)}emit(e,t){if("error"!==e&&"close"!==e&&e!==O&&this[O])return;if("data"===e){if(!t)return;this.pipes.length&&this.pipes.forEach((e=>!1===e.dest.write(t)&&this.pause()))}else if("end"===e){if(!0===this[c])return;this[c]=!0,this.readable=!1,this[w]&&(t=this[w].end())&&(this.pipes.forEach((e=>e.dest.write(t))),super.emit("data",t)),this.pipes.forEach((e=>{e.dest.removeListener("drain",e.ondrain),e.opts.end&&e.dest.end()}))}else if("close"===e){if(this[f]=!0,!this[c]&&!this[O])return}else"error"===e&&(this[d]=t);const s=new Array(arguments.length);if(s[0]=e,s[1]=t,arguments.length>2)for(let e=2;e<arguments.length;e++)s[e]=arguments[e];try{return super.emit.apply(this,s)}finally{C(e)?this.removeAllListeners(e):this[l]()}}collect(){const e=[];this[R]||(e.dataLength=0);const t=this.promise();return this.on("data",(t=>{e.push(t),this[R]||(e.dataLength+=t.length)})),t.then((()=>e))}concat(){return this[R]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then((e=>this[R]?Promise.reject(new Error("cannot concat in objectMode")):this[y]?e.join(""):Buffer.concat(e,e.dataLength)))}promise(){return new Promise(((e,t)=>{this.on(O,(()=>t(new Error("stream destroyed")))),this.on("error",(e=>t(e))),this.on("end",(()=>e()))}))}[T](){return{next:()=>{const e=this.read();if(null!==e)return Promise.resolve({done:!1,value:e});if(this[a])return Promise.resolve({done:!0});let t=null,s=null;const i=e=>{this.removeListener("data",r),this.removeListener("end",n),s(e)},r=e=>{this.removeListener("error",i),this.removeListener("end",n),this.pause(),t({value:e,done:!!this[a]})},n=()=>{this.removeListener("error",i),this.removeListener("data",r),t({done:!0})},o=()=>i(new Error("stream destroyed"));return new Promise(((e,h)=>{s=h,t=e,this.once(O,o),this.once("error",i),this.once("end",n),this.once("data",r)}))}}}[L](){return{next:()=>{const e=this.read();return{value:e,done:null===e}}}}destroy(e){return this[O]?(e?this.emit("error",e):this.emit(O),this):(this[O]=!0,this.buffer=new o,this[S]=0,"function"!=typeof this.close||this[f]||this.close(),e?this.emit("error",e):this.emit(O),this)}static isStream(t){return!!t&&(t instanceof e||t instanceof n||t instanceof r&&("function"==typeof t.pipe||"function"==typeof t.write&&"function"==typeof t.end))}}},1074:(e,t,s)=>{const i=s(9796).constants||{ZLIB_VERNUM:4736};e.exports=Object.freeze(Object.assign(Object.create(null),{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_VERSION_ERROR:-6,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,BROTLI_DECODE:8,BROTLI_ENCODE:9,Z_MIN_WINDOWBITS:8,Z_MAX_WINDOWBITS:15,Z_DEFAULT_WINDOWBITS:15,Z_MIN_CHUNK:64,Z_MAX_CHUNK:1/0,Z_DEFAULT_CHUNK:16384,Z_MIN_MEMLEVEL:1,Z_MAX_MEMLEVEL:9,Z_DEFAULT_MEMLEVEL:8,Z_MIN_LEVEL:-1,Z_MAX_LEVEL:9,Z_DEFAULT_LEVEL:-1,BROTLI_OPERATION_PROCESS:0,BROTLI_OPERATION_FLUSH:1,BROTLI_OPERATION_FINISH:2,BROTLI_OPERATION_EMIT_METADATA:3,BROTLI_MODE_GENERIC:0,BROTLI_MODE_TEXT:1,BROTLI_MODE_FONT:2,BROTLI_DEFAULT_MODE:0,BROTLI_MIN_QUALITY:0,BROTLI_MAX_QUALITY:11,BROTLI_DEFAULT_QUALITY:11,BROTLI_MIN_WINDOW_BITS:10,BROTLI_MAX_WINDOW_BITS:24,BROTLI_LARGE_MAX_WINDOW_BITS:30,BROTLI_DEFAULT_WINDOW:22,BROTLI_MIN_INPUT_BLOCK_BITS:16,BROTLI_MAX_INPUT_BLOCK_BITS:24,BROTLI_PARAM_MODE:0,BROTLI_PARAM_QUALITY:1,BROTLI_PARAM_LGWIN:2,BROTLI_PARAM_LGBLOCK:3,BROTLI_PARAM_DISABLE_LITERAL_CONTEXT_MODELING:4,BROTLI_PARAM_SIZE_HINT:5,BROTLI_PARAM_LARGE_WINDOW:6,BROTLI_PARAM_NPOSTFIX:7,BROTLI_PARAM_NDIRECT:8,BROTLI_DECODER_RESULT_ERROR:0,BROTLI_DECODER_RESULT_SUCCESS:1,BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:2,BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_PARAM_DISABLE_RING_BUFFER_REALLOCATION:0,BROTLI_DECODER_PARAM_LARGE_WINDOW:1,BROTLI_DECODER_NO_ERROR:0,BROTLI_DECODER_SUCCESS:1,BROTLI_DECODER_NEEDS_MORE_INPUT:2,BROTLI_DECODER_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:-1,BROTLI_DECODER_ERROR_FORMAT_RESERVED:-2,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:-3,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:-4,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:-5,BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:-6,BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:-7,BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:-8,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:-9,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:-10,BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:-11,BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:-12,BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:-13,BROTLI_DECODER_ERROR_FORMAT_PADDING_1:-14,BROTLI_DECODER_ERROR_FORMAT_PADDING_2:-15,BROTLI_DECODER_ERROR_FORMAT_DISTANCE:-16,BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:-19,BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:-20,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:-21,BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:-22,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:-25,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:-26,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:-27,BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:-30,BROTLI_DECODER_ERROR_UNREACHABLE:-31},i))},952:(e,t,s)=>{"use strict";const i=s(9491),r=s(4300).Buffer,n=s(9796),o=t.constants=s(1074),h=s(7008),a=r.concat,l=Symbol("_superWrite");class c extends Error{constructor(e){super("zlib: "+e.message),this.code=e.code,this.errno=e.errno,this.code||(this.code="ZLIB_ERROR"),this.message="zlib: "+e.message,Error.captureStackTrace(this,this.constructor)}get name(){return"ZlibError"}}const u=Symbol("opts"),d=Symbol("flushFlag"),f=Symbol("finishFlushFlag"),p=Symbol("fullFlushFlag"),m=Symbol("handle"),_=Symbol("onError"),y=Symbol("sawError"),w=Symbol("level"),b=Symbol("strategy"),g=Symbol("ended");Symbol("_defaultFullFlush");class E extends h{constructor(e,t){if(!e||"object"!=typeof e)throw new TypeError("invalid options for ZlibBase constructor");super(e),this[y]=!1,this[g]=!1,this[u]=e,this[d]=e.flush,this[f]=e.finishFlush;try{this[m]=new n[t](e)}catch(e){throw new c(e)}this[_]=e=>{this[y]||(this[y]=!0,this.close(),this.emit("error",e))},this[m].on("error",(e=>this[_](new c(e)))),this.once("end",(()=>this.close))}close(){this[m]&&(this[m].close(),this[m]=null,this.emit("close"))}reset(){if(!this[y])return i(this[m],"zlib binding closed"),this[m].reset()}flush(e){this.ended||("number"!=typeof e&&(e=this[p]),this.write(Object.assign(r.alloc(0),{[d]:e})))}end(e,t,s){return e&&this.write(e,t),this.flush(this[f]),this[g]=!0,super.end(null,null,s)}get ended(){return this[g]}write(e,t,s){if("function"==typeof t&&(s=t,t="utf8"),"string"==typeof e&&(e=r.from(e,t)),this[y])return;i(this[m],"zlib binding closed");const n=this[m]._handle,o=n.close;n.close=()=>{};const h=this[m].close;let u,f;this[m].close=()=>{},r.concat=e=>e;try{const t="number"==typeof e[d]?e[d]:this[d];u=this[m]._processChunk(e,t),r.concat=a}catch(e){r.concat=a,this[_](new c(e))}finally{this[m]&&(this[m]._handle=n,n.close=o,this[m].close=h,this[m].removeAllListeners("error"))}if(this[m]&&this[m].on("error",(e=>this[_](new c(e)))),u)if(Array.isArray(u)&&u.length>0){f=this[l](r.from(u[0]));for(let e=1;e<u.length;e++)f=this[l](u[e])}else f=this[l](r.from(u));return s&&s(),f}[l](e){return super.write(e)}}class S extends E{constructor(e,t){(e=e||{}).flush=e.flush||o.Z_NO_FLUSH,e.finishFlush=e.finishFlush||o.Z_FINISH,super(e,t),this[p]=o.Z_FULL_FLUSH,this[w]=e.level,this[b]=e.strategy}params(e,t){if(!this[y]){if(!this[m])throw new Error("cannot switch params when binding is closed");if(!this[m].params)throw new Error("not supported in this implementation");if(this[w]!==e||this[b]!==t){this.flush(o.Z_SYNC_FLUSH),i(this[m],"zlib binding closed");const s=this[m].flush;this[m].flush=(e,t)=>{this.flush(e),t()};try{this[m].params(e,t)}finally{this[m].flush=s}this[m]&&(this[w]=e,this[b]=t)}}}}const v=Symbol("_portable");class k extends E{constructor(e,t){(e=e||{}).flush=e.flush||o.BROTLI_OPERATION_PROCESS,e.finishFlush=e.finishFlush||o.BROTLI_OPERATION_FINISH,super(e,t),this[p]=o.BROTLI_OPERATION_FLUSH}}class R extends k{constructor(e){super(e,"BrotliCompress")}}class O extends k{constructor(e){super(e,"BrotliDecompress")}}t.Deflate=class extends S{constructor(e){super(e,"Deflate")}},t.Inflate=class extends S{constructor(e){super(e,"Inflate")}},t.Gzip=class extends S{constructor(e){super(e,"Gzip"),this[v]=e&&!!e.portable}[l](e){return this[v]?(this[v]=!1,e[9]=255,super[l](e)):super[l](e)}},t.Gunzip=class extends S{constructor(e){super(e,"Gunzip")}},t.DeflateRaw=class extends S{constructor(e){super(e,"DeflateRaw")}},t.InflateRaw=class extends S{constructor(e){super(e,"InflateRaw")}},t.Unzip=class extends S{constructor(e){super(e,"Unzip")}},"function"==typeof n.BrotliCompress?(t.BrotliCompress=R,t.BrotliDecompress=O):t.BrotliCompress=t.BrotliDecompress=class{constructor(){throw new Error("Brotli is not supported in this version of Node.js")}}},7537:(e,t,s)=>{const i=s(1457),r=s(7252),{mkdirpNative:n,mkdirpNativeSync:o}=s(555),{mkdirpManual:h,mkdirpManualSync:a}=s(8179),{useNative:l,useNativeSync:c}=s(5893),u=(e,t)=>(e=r(e),t=i(t),l(t)?n(e,t):h(e,t));u.sync=(e,t)=>(e=r(e),t=i(t),c(t)?o(e,t):a(e,t)),u.native=(e,t)=>n(r(e),i(t)),u.manual=(e,t)=>h(r(e),i(t)),u.nativeSync=(e,t)=>o(r(e),i(t)),u.manualSync=(e,t)=>a(r(e),i(t)),e.exports=u},389:(e,t,s)=>{const{dirname:i}=s(1017),r=(e,t,s)=>s===t?Promise.resolve():e.statAsync(t).then((e=>e.isDirectory()?s:void 0),(s=>"ENOENT"===s.code?r(e,i(t),t):void 0)),n=(e,t,s)=>{if(s!==t)try{return e.statSync(t).isDirectory()?s:void 0}catch(s){return"ENOENT"===s.code?n(e,i(t),t):void 0}};e.exports={findMade:r,findMadeSync:n}},8179:(e,t,s)=>{const{dirname:i}=s(1017),r=(e,t,s)=>{t.recursive=!1;const n=i(e);return n===e?t.mkdirAsync(e,t).catch((e=>{if("EISDIR"!==e.code)throw e})):t.mkdirAsync(e,t).then((()=>s||e),(i=>{if("ENOENT"===i.code)return r(n,t).then((s=>r(e,t,s)));if("EEXIST"!==i.code&&"EROFS"!==i.code)throw i;return t.statAsync(e).then((e=>{if(e.isDirectory())return s;throw i}),(()=>{throw i}))}))},n=(e,t,s)=>{const r=i(e);if(t.recursive=!1,r===e)try{return t.mkdirSync(e,t)}catch(e){if("EISDIR"!==e.code)throw e;return}try{return t.mkdirSync(e,t),s||e}catch(i){if("ENOENT"===i.code)return n(e,t,n(r,t,s));if("EEXIST"!==i.code&&"EROFS"!==i.code)throw i;try{if(!t.statSync(e).isDirectory())throw i}catch(e){throw i}}};e.exports={mkdirpManual:r,mkdirpManualSync:n}},555:(e,t,s)=>{const{dirname:i}=s(1017),{findMade:r,findMadeSync:n}=s(389),{mkdirpManual:o,mkdirpManualSync:h}=s(8179);e.exports={mkdirpNative:(e,t)=>{t.recursive=!0;return i(e)===e?t.mkdirAsync(e,t):r(t,e).then((s=>t.mkdirAsync(e,t).then((()=>s)).catch((s=>{if("ENOENT"===s.code)return o(e,t);throw s}))))},mkdirpNativeSync:(e,t)=>{t.recursive=!0;if(i(e)===e)return t.mkdirSync(e,t);const s=n(t,e);try{return t.mkdirSync(e,t),s}catch(s){if("ENOENT"===s.code)return h(e,t);throw s}}}},1457:(e,t,s)=>{const{promisify:i}=s(3837),r=s(7147);e.exports=e=>{if(e)if("object"==typeof e)e={mode:511,fs:r,...e};else if("number"==typeof e)e={mode:e,fs:r};else{if("string"!=typeof e)throw new TypeError("invalid options argument");e={mode:parseInt(e,8),fs:r}}else e={mode:511,fs:r};return e.mkdir=e.mkdir||e.fs.mkdir||r.mkdir,e.mkdirAsync=i(e.mkdir),e.stat=e.stat||e.fs.stat||r.stat,e.statAsync=i(e.stat),e.statSync=e.statSync||e.fs.statSync||r.statSync,e.mkdirSync=e.mkdirSync||e.fs.mkdirSync||r.mkdirSync,e}},7252:(e,t,s)=>{const i={}.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:r,parse:n}=s(1017);e.exports=e=>{if(/\0/.test(e))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:e,code:"ERR_INVALID_ARG_VALUE"});if(e=r(e),"win32"===i){const t=/[*|"<>?:]/,{root:s}=n(e);if(t.test(e.substr(s.length)))throw Object.assign(new Error("Illegal characters in path."),{path:e,code:"EINVAL"})}return e}},5893:(e,t,s)=>{const i=s(7147),r=({}.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),n=+r[0]>10||10==+r[0]&&+r[1]>=12,o=n?e=>e.mkdir===i.mkdir:()=>!1,h=n?e=>e.mkdirSync===i.mkdirSync:()=>!1;e.exports={useNative:o,useNativeSync:h}},8495:(e,t,s)=>{var i=s(7147),r=s(1017),n=s(2037),o=require,h=process.config&&process.config.variables||{},a=!!{}.PREBUILDS_ONLY,l=process.versions.modules,c=!(!process.versions||!process.versions.electron)||!!{}.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":"node",u=n.arch(),d=n.platform(),f={}.LIBC||(function(e){return"linux"===e&&i.existsSync("/etc/alpine-release")}(d)?"musl":"glibc"),p={}.ARM_VERSION||("arm64"===u?"8":h.arm_version)||"",m=(process.versions.uv||"").split(".")[0];function _(e){return o(_.path(e))}function y(e){try{return i.readdirSync(e)}catch(e){return[]}}function w(e,t){var s=y(e).filter(t);return s[0]&&r.join(e,s[0])}function b(e){return/\.node$/.test(e)}function g(e){var t=e.split("-");if(2===t.length){var s=t[0],i=t[1].split("+");if(s&&i.length&&i.every(Boolean))return{name:e,platform:s,architectures:i}}}function E(e,t){return function(s){return null!=s&&(s.platform===e&&s.architectures.includes(t))}}function S(e,t){return e.architectures.length-t.architectures.length}function v(e){var t=e.split("."),s={file:e,specificity:0};if("node"===t.pop()){for(var i=0;i<t.length;i++){var r=t[i];if("node"===r||"electron"===r||"node-webkit"===r)s.runtime=r;else if("napi"===r)s.napi=!0;else if("abi"===r.slice(0,3))s.abi=r.slice(3);else if("uv"===r.slice(0,2))s.uv=r.slice(2);else if("armv"===r.slice(0,4))s.armv=r.slice(4);else{if("glibc"!==r&&"musl"!==r)continue;s.libc=r}s.specificity++}return s}}function k(e,t){return function(s){return null!=s&&(!(s.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(s))&&(!(s.abi!==t&&!s.napi)&&((!s.uv||s.uv===m)&&((!s.armv||s.armv===p)&&(!s.libc||s.libc===f)))))}}function R(e){return function(t,s){return t.runtime!==s.runtime?t.runtime===e?-1:1:t.abi!==s.abi?t.abi?-1:1:t.specificity!==s.specificity?t.specificity>s.specificity?-1:1:0}}e.exports=_,_.path=function(e){e=r.resolve(e||".");try{var t=o(r.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");({})[t+"_PREBUILD"]&&(e={}[t+"_PREBUILD"])}catch(e){}if(!a){var s=w(r.join(e,"build/Release"),b);if(s)return s;var i=w(r.join(e,"build/Debug"),b);if(i)return i}var n=O(e);if(n)return n;var h=O(r.dirname(process.execPath));if(h)return h;var _=["platform="+d,"arch="+u,"runtime="+c,"abi="+l,"uv="+m,p?"armv="+p:"","libc="+f,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ");throw new Error("No native build was found for "+_+"\n    loaded from: "+e+"\n");function O(e){var t=y(r.join(e,"prebuilds")).map(g).filter(E(d,u)).sort(S)[0];if(t){var s=r.join(e,"prebuilds",t.name),i=y(s).map(v).filter(k(c,l)).sort(R(c))[0];return i?r.join(s,i.file):void 0}}},_.parseTags=v,_.matchTags=k,_.compareTags=R,_.parseTuple=g,_.matchTuple=E,_.compareTuples=S},9610:(e,t,s)=>{"use strict";s(1150),s(5650),s(3862),s(9318),s(9812),s(7511),s(7633),s(4588),s(3265),s(2944),s(1549),s(630),s(987)},1150:(e,t,s)=>{"use strict";const i=s(764),r=s(7511),n=s(2276),o=s(3862),h=s(1017);e.exports=(e,t,s)=>{if("function"==typeof t&&(s=t),Array.isArray(e)&&(t=e,e={}),!t||!Array.isArray(t)||!t.length)throw new TypeError("no files or directories specified");t=Array.from(t);const r=i(e);if(r.sync&&"function"==typeof s)throw new TypeError("callback not supported for sync tar functions");if(!r.file&&"function"==typeof s)throw new TypeError("callback only supported with file option");return r.file&&r.sync?a(r,t):r.file?l(r,t,s):r.sync?d(r,t):f(r,t)};const a=(e,t)=>{const s=new r.Sync(e),i=new n.WriteStreamSync(e.file,{mode:e.mode||438});s.pipe(i),c(s,t)},l=(e,t,s)=>{const i=new r(e),o=new n.WriteStream(e.file,{mode:e.mode||438});i.pipe(o);const h=new Promise(((e,t)=>{o.on("error",t),o.on("close",e),i.on("error",t)}));return u(i,t),s?h.then(s,s):h},c=(e,t)=>{t.forEach((t=>{"@"===t.charAt(0)?o({file:h.resolve(e.cwd,t.substr(1)),sync:!0,noResume:!0,onentry:t=>e.add(t)}):e.add(t)})),e.end()},u=(e,t)=>{for(;t.length;){const s=t.shift();if("@"===s.charAt(0))return o({file:h.resolve(e.cwd,s.substr(1)),noResume:!0,onentry:t=>e.add(t)}).then((s=>u(e,t)));e.add(s)}e.end()},d=(e,t)=>{const s=new r.Sync(e);return c(s,t),s},f=(e,t)=>{const s=new r(e);return u(s,t),s}},9812:(e,t,s)=>{"use strict";const i=s(764),r=s(7633),n=s(7147),o=s(2276),h=s(1017),a=s(6433);e.exports=(e,t,s)=>{"function"==typeof e?(s=e,t=null,e={}):Array.isArray(e)&&(t=e,e={}),"function"==typeof t&&(s=t,t=null),t=t?Array.from(t):[];const r=i(e);if(r.sync&&"function"==typeof s)throw new TypeError("callback not supported for sync tar functions");if(!r.file&&"function"==typeof s)throw new TypeError("callback only supported with file option");return t.length&&l(r,t),r.file&&r.sync?c(r):r.file?u(r,s):r.sync?d(r):f(r)};const l=(e,t)=>{const s=new Map(t.map((e=>[a(e),!0]))),i=e.filter,r=(e,t)=>{const i=t||h.parse(e).root||".",n=e!==i&&(s.has(e)?s.get(e):r(h.dirname(e),i));return s.set(e,n),n};e.filter=i?(e,t)=>i(e,t)&&r(a(e)):e=>r(a(e))},c=e=>{const t=new r.Sync(e),s=e.file,i=n.statSync(s),h=e.maxReadSize||16777216;new o.ReadStreamSync(s,{readSize:h,size:i.size}).pipe(t)},u=(e,t)=>{const s=new r(e),i=e.maxReadSize||16777216,h=e.file,a=new Promise(((e,t)=>{s.on("error",t),s.on("close",e),n.stat(h,((e,r)=>{if(e)t(e);else{const e=new o.ReadStream(h,{readSize:i,size:r.size});e.on("error",t),e.pipe(s)}}))}));return t?a.then(t,t):a},d=e=>new r.Sync(e),f=e=>new r(e)},2040:(e,t,s)=>{const i="win32"===({}.__FAKE_PLATFORM__||process.platform),r=global.__FAKE_TESTING_FS__||s(7147),{O_CREAT:n,O_TRUNC:o,O_WRONLY:h,UV_FS_O_FILEMAP:a=0}=r.constants,l=i&&!!a,c=a|o|n|h;e.exports=l?e=>e<524288?c:"w":()=>"w"},1549:(e,t,s)=>{"use strict";const i=s(987),r=s(1017).posix,n=s(5304),o=Symbol("slurp"),h=Symbol("type");const a=(e,t)=>{const s=100;let i,n=e,o="";const h=r.parse(e).root||".";if(Buffer.byteLength(n)<s)i=[n,o,!1];else{o=r.dirname(n),n=r.basename(n);do{Buffer.byteLength(n)<=s&&Buffer.byteLength(o)<=t?i=[n,o,!1]:Buffer.byteLength(n)>s&&Buffer.byteLength(o)<=t?i=[n.substr(0,99),o,!0]:(n=r.join(r.basename(o),n),o=r.dirname(o))}while(o!==h&&!i);i||(i=[e.substr(0,99),"",!0])}return i},l=(e,t,s)=>e.slice(t,t+s).toString("utf8").replace(/\0.*/,""),c=(e,t,s)=>u(d(e,t,s)),u=e=>null===e?null:new Date(1e3*e),d=(e,t,s)=>128&e[t]?n.parse(e.slice(t,t+s)):f(e,t,s),f=(e,t,s)=>{return i=parseInt(e.slice(t,t+s).toString("utf8").replace(/\0.*$/,"").trim(),8),isNaN(i)?null:i;var i},p={12:8589934591,8:2097151},m=(e,t,s,i)=>null!==i&&(i>p[s]||i<0?(n.encode(i,e.slice(t,t+s)),!0):(_(e,t,s,i),!1)),_=(e,t,s,i)=>e.write(y(i,s),t,s,"ascii"),y=(e,t)=>w(Math.floor(e).toString(8),t),w=(e,t)=>(e.length===t-1?e:new Array(t-e.length-1).join("0")+e+" ")+"\0",b=(e,t,s,i)=>null!==i&&m(e,t,s,i.getTime()/1e3),g=new Array(156).join("\0"),E=(e,t,s,i)=>null!==i&&(e.write(i+g,t,s,"utf8"),i.length!==Buffer.byteLength(i)||i.length>s);e.exports=class{constructor(e,t,s,i){this.cksumValid=!1,this.needPax=!1,this.nullBlock=!1,this.block=null,this.path=null,this.mode=null,this.uid=null,this.gid=null,this.size=null,this.mtime=null,this.cksum=null,this[h]="0",this.linkpath=null,this.uname=null,this.gname=null,this.devmaj=0,this.devmin=0,this.atime=null,this.ctime=null,Buffer.isBuffer(e)?this.decode(e,t||0,s,i):e&&this.set(e)}decode(e,t,s,i){if(t||(t=0),!(e&&e.length>=t+512))throw new Error("need 512 bytes for header");if(this.path=l(e,t,100),this.mode=d(e,t+100,8),this.uid=d(e,t+108,8),this.gid=d(e,t+116,8),this.size=d(e,t+124,12),this.mtime=c(e,t+136,12),this.cksum=d(e,t+148,12),this[o](s),this[o](i,!0),this[h]=l(e,t+156,1),""===this[h]&&(this[h]="0"),"0"===this[h]&&"/"===this.path.substr(-1)&&(this[h]="5"),"5"===this[h]&&(this.size=0),this.linkpath=l(e,t+157,100),"ustar\x0000"===e.slice(t+257,t+265).toString())if(this.uname=l(e,t+265,32),this.gname=l(e,t+297,32),this.devmaj=d(e,t+329,8),this.devmin=d(e,t+337,8),0!==e[t+475]){const s=l(e,t+345,155);this.path=s+"/"+this.path}else{const s=l(e,t+345,130);s&&(this.path=s+"/"+this.path),this.atime=c(e,t+476,12),this.ctime=c(e,t+488,12)}let r=256;for(let s=t;s<t+148;s++)r+=e[s];for(let s=t+156;s<t+512;s++)r+=e[s];this.cksumValid=r===this.cksum,null===this.cksum&&256===r&&(this.nullBlock=!0)}[o](e,t){for(const s in e)null===e[s]||void 0===e[s]||t&&"path"===s||(this[s]=e[s])}encode(e,t){if(e||(e=this.block=Buffer.alloc(512),t=0),t||(t=0),!(e.length>=t+512))throw new Error("need 512 bytes for header");const s=this.ctime||this.atime?130:155,i=a(this.path||"",s),r=i[0],n=i[1];this.needPax=i[2],this.needPax=E(e,t,100,r)||this.needPax,this.needPax=m(e,t+100,8,this.mode)||this.needPax,this.needPax=m(e,t+108,8,this.uid)||this.needPax,this.needPax=m(e,t+116,8,this.gid)||this.needPax,this.needPax=m(e,t+124,12,this.size)||this.needPax,this.needPax=b(e,t+136,12,this.mtime)||this.needPax,e[t+156]=this[h].charCodeAt(0),this.needPax=E(e,t+157,100,this.linkpath)||this.needPax,e.write("ustar\x0000",t+257,8),this.needPax=E(e,t+265,32,this.uname)||this.needPax,this.needPax=E(e,t+297,32,this.gname)||this.needPax,this.needPax=m(e,t+329,8,this.devmaj)||this.needPax,this.needPax=m(e,t+337,8,this.devmin)||this.needPax,this.needPax=E(e,t+345,s,n)||this.needPax,0!==e[t+475]?this.needPax=E(e,t+345,155,n)||this.needPax:(this.needPax=E(e,t+345,130,n)||this.needPax,this.needPax=b(e,t+476,12,this.atime)||this.needPax,this.needPax=b(e,t+488,12,this.ctime)||this.needPax);let o=256;for(let s=t;s<t+148;s++)o+=e[s];for(let s=t+156;s<t+512;s++)o+=e[s];return this.cksum=o,m(e,t+148,8,this.cksum),this.cksumValid=!0,this.needPax}set(e){for(const t in e)null!==e[t]&&void 0!==e[t]&&(this[t]=e[t])}get type(){return i.name.get(this[h])||this[h]}get typeKey(){return this[h]}set type(e){i.code.has(e)?this[h]=i.code.get(e):this[h]=e}}},764:e=>{"use strict";const t=new Map([["C","cwd"],["f","file"],["z","gzip"],["P","preservePaths"],["U","unlink"],["strip-components","strip"],["stripComponents","strip"],["keep-newer","newer"],["keepNewer","newer"],["keep-newer-files","newer"],["keepNewerFiles","newer"],["k","keep"],["keep-existing","keep"],["keepExisting","keep"],["m","noMtime"],["no-mtime","noMtime"],["p","preserveOwner"],["L","follow"],["h","follow"]]);e.exports=e=>e?Object.keys(e).map((s=>[t.has(s)?t.get(s):s,e[s]])).reduce(((e,t)=>(e[t[0]]=t[1],e)),Object.create(null)):{}},5304:e=>{"use strict";const t=(e,t)=>{t[0]=128;for(var s=t.length;s>1;s--)t[s-1]=255&e,e=Math.floor(e/256)},s=(e,t)=>{t[0]=255;var s=!1;e*=-1;for(var i=t.length;i>1;i--){var r=255&e;e=Math.floor(e/256),s?t[i-1]=n(r):0===r?t[i-1]=0:(s=!0,t[i-1]=o(r))}},i=e=>{for(var t=e.length,s=0,i=!1,r=t-1;r>-1;r--){var h,a=e[r];i?h=n(a):0===a?h=a:(i=!0,h=o(a)),0!==h&&(s-=h*Math.pow(256,t-r-1))}return s},r=e=>{for(var t=e.length,s=0,i=t-1;i>-1;i--){var r=e[i];0!==r&&(s+=r*Math.pow(256,t-i-1))}return s},n=e=>255&(255^e),o=e=>1+(255^e)&255;e.exports={encode:(e,i)=>{if(!Number.isSafeInteger(e))throw Error("cannot encode number outside of javascript safe integer range");return e<0?s(e,i):t(e,i),i},parse:e=>{const t=e[0],s=128===t?r(e.slice(1,e.length)):255===t?i(e):null;if(null===s)throw Error("invalid base256 encoding");if(!Number.isSafeInteger(s))throw Error("parsed number outside of javascript safe integer range");return s}}},3862:(e,t,s)=>{"use strict";const i=s(764),r=s(4588),n=s(7147),o=s(2276),h=s(1017),a=s(6433);e.exports=(e,t,s)=>{"function"==typeof e?(s=e,t=null,e={}):Array.isArray(e)&&(t=e,e={}),"function"==typeof t&&(s=t,t=null),t=t?Array.from(t):[];const r=i(e);if(r.sync&&"function"==typeof s)throw new TypeError("callback not supported for sync tar functions");if(!r.file&&"function"==typeof s)throw new TypeError("callback only supported with file option");return t.length&&c(r,t),r.noResume||l(r),r.file&&r.sync?u(r):r.file?d(r,s):f(r)};const l=e=>{const t=e.onentry;e.onentry=t?e=>{t(e),e.resume()}:e=>e.resume()},c=(e,t)=>{const s=new Map(t.map((e=>[a(e),!0]))),i=e.filter,r=(e,t)=>{const i=t||h.parse(e).root||".",n=e!==i&&(s.has(e)?s.get(e):r(h.dirname(e),i));return s.set(e,n),n};e.filter=i?(e,t)=>i(e,t)&&r(a(e)):e=>r(a(e))},u=e=>{const t=f(e),s=e.file;let i,r=!0;try{const o=n.statSync(s),h=e.maxReadSize||16777216;if(o.size<h)t.end(n.readFileSync(s));else{let e=0;const r=Buffer.allocUnsafe(h);for(i=n.openSync(s,"r");e<o.size;){const s=n.readSync(i,r,0,h,e);e+=s,t.write(r.slice(0,s))}t.end()}r=!1}finally{if(r&&i)try{n.closeSync(i)}catch(e){}}},d=(e,t)=>{const s=new r(e),i=e.maxReadSize||16777216,h=e.file,a=new Promise(((e,t)=>{s.on("error",t),s.on("end",e),n.stat(h,((e,r)=>{if(e)t(e);else{const e=new o.ReadStream(h,{readSize:i,size:r.size});e.on("error",t),e.pipe(s)}}))}));return t?a.then(t,t):a},f=e=>new r(e)},7561:(e,t,s)=>{"use strict";const i=s(7537),r=s(7147),n=s(1017),o=s(4570),h=s(1593);class a extends Error{constructor(e,t){super("Cannot extract through symbolic link"),this.path=t,this.symlink=e}get name(){return"SylinkError"}}class l extends Error{constructor(e,t){super(t+": Cannot cd into '"+e+"'"),this.path=e,this.code=t}get name(){return"CwdError"}}const c=(e,t)=>e.get(h(t)),u=(e,t,s)=>e.set(h(t),s);e.exports=(e,t,s)=>{e=h(e);const a=t.umask,f=448|t.mode,p=0!=(f&a),m=t.uid,_=t.gid,y="number"==typeof m&&"number"==typeof _&&(m!==t.processUid||_!==t.processGid),w=t.preserve,b=t.unlink,g=t.cache,E=h(t.cwd),S=(t,i)=>{t?s(t):(u(g,e,!0),i&&y?o(i,m,_,(e=>S(e))):p?r.chmod(e,f,s):s())};if(g&&!0===c(g,e))return S();if(e===E)return((e,t)=>{r.stat(e,((s,i)=>{!s&&i.isDirectory()||(s=new l(e,s&&s.code||"ENOTDIR")),t(s)}))})(e,S);if(w)return i(e,{mode:f}).then((e=>S(null,e)),S);const v=h(n.relative(E,e)).split("/");d(E,v,f,g,b,E,null,S)};const d=(e,t,s,i,o,a,l,u)=>{if(!t.length)return u(null,l);const p=t.shift(),m=h(n.resolve(e+"/"+p));if(c(i,m))return d(m,t,s,i,o,a,l,u);r.mkdir(m,s,f(m,t,s,i,o,a,l,u))},f=(e,t,s,i,n,o,l,c)=>u=>{u?r.lstat(e,((p,m)=>{if(p)p.path=p.path&&h(p.path),c(p);else if(m.isDirectory())d(e,t,s,i,n,o,l,c);else if(n)r.unlink(e,(h=>{if(h)return c(h);r.mkdir(e,s,f(e,t,s,i,n,o,l,c))}));else{if(m.isSymbolicLink())return c(new a(e,e+"/"+t.join("/")));c(u)}})):d(e,t,s,i,n,o,l=l||e,c)};e.exports.sync=(e,t)=>{e=h(e);const s=t.umask,d=448|t.mode,f=0!=(d&s),p=t.uid,m=t.gid,_="number"==typeof p&&"number"==typeof m&&(p!==t.processUid||m!==t.processGid),y=t.preserve,w=t.unlink,b=t.cache,g=h(t.cwd),E=t=>{u(b,e,!0),t&&_&&o.sync(t,p,m),f&&r.chmodSync(e,d)};if(b&&!0===c(b,e))return E();if(e===g)return(e=>{let t=!1,s="ENOTDIR";try{t=r.statSync(e).isDirectory()}catch(e){s=e.code}finally{if(!t)throw new l(e,s)}})(g),E();if(y)return E(i.sync(e,d));const S=h(n.relative(g,e)).split("/");let v=null;for(let e=S.shift(),t=g;e&&(t+="/"+e);e=S.shift())if(t=h(n.resolve(t)),!c(b,t))try{r.mkdirSync(t,d),v=v||t,u(b,t,!0)}catch(e){const s=r.lstatSync(t);if(s.isDirectory()){u(b,t,!0);continue}if(w){r.unlinkSync(t),r.mkdirSync(t,d),v=v||t,u(b,t,!0);continue}if(s.isSymbolicLink())return new a(t,t+"/"+S.join("/"))}return E(v)}},513:e=>{"use strict";e.exports=(e,t,s)=>(e&=4095,s&&(e=-19&(384|e)),t&&(256&e&&(e|=64),32&e&&(e|=8),4&e&&(e|=1)),e)},5064:e=>{const t=Object.create(null),{hasOwnProperty:s}=Object.prototype;e.exports=e=>(s.call(t,e)||(t[e]=e.normalize("NFKD")),t[e])},1593:e=>{const t={}.TESTING_TAR_FAKE_PLATFORM||process.platform;e.exports="win32"!==t?e=>e:e=>e&&e.replace(/\\/g,"/")},7511:(e,t,s)=>{"use strict";class i{constructor(e,t){this.path=e||"./",this.absolute=t,this.entry=null,this.stat=null,this.readdir=null,this.pending=!1,this.ignore=!1,this.piped=!1}}const r=s(7008),n=s(952),o=s(3265),h=s(2944),a=h.Sync,l=h.Tar,c=s(1123),u=Buffer.alloc(1024),d=Symbol("onStat"),f=Symbol("ended"),p=Symbol("queue"),m=Symbol("current"),_=Symbol("process"),y=Symbol("processing"),w=Symbol("processJob"),b=Symbol("jobs"),g=Symbol("jobDone"),E=Symbol("addFSEntry"),S=Symbol("addTarEntry"),v=Symbol("stat"),k=Symbol("readdir"),R=Symbol("onreaddir"),O=Symbol("pipe"),x=Symbol("entry"),T=Symbol("entryOpt"),L=Symbol("writeEntryClass"),C=Symbol("write"),N=Symbol("ondrain"),I=s(7147),A=s(1017),D=s(4914),P=s(1593),B=D(class extends r{constructor(e){super(e),e=e||Object.create(null),this.opt=e,this.file=e.file||"",this.cwd=e.cwd||process.cwd(),this.maxReadSize=e.maxReadSize,this.preservePaths=!!e.preservePaths,this.strict=!!e.strict,this.noPax=!!e.noPax,this.prefix=P(e.prefix||""),this.linkCache=e.linkCache||new Map,this.statCache=e.statCache||new Map,this.readdirCache=e.readdirCache||new Map,this[L]=h,"function"==typeof e.onwarn&&this.on("warn",e.onwarn),this.portable=!!e.portable,this.zip=null,e.gzip?("object"!=typeof e.gzip&&(e.gzip={}),this.portable&&(e.gzip.portable=!0),this.zip=new n.Gzip(e.gzip),this.zip.on("data",(e=>super.write(e))),this.zip.on("end",(e=>super.end())),this.zip.on("drain",(e=>this[N]())),this.on("resume",(e=>this.zip.resume()))):this.on("drain",this[N]),this.noDirRecurse=!!e.noDirRecurse,this.follow=!!e.follow,this.noMtime=!!e.noMtime,this.mtime=e.mtime||null,this.filter="function"==typeof e.filter?e.filter:e=>!0,this[p]=new c,this[b]=0,this.jobs=+e.jobs||4,this[y]=!1,this[f]=!1}[C](e){return super.write(e)}add(e){return this.write(e),this}end(e){return e&&this.write(e),this[f]=!0,this[_](),this}write(e){if(this[f])throw new Error("write after end");return e instanceof o?this[S](e):this[E](e),this.flowing}[S](e){const t=P(A.resolve(this.cwd,e.path));if(this.filter(e.path,e)){const s=new i(e.path,t,!1);s.entry=new l(e,this[T](s)),s.entry.on("end",(e=>this[g](s))),this[b]+=1,this[p].push(s)}else e.resume();this[_]()}[E](e){const t=P(A.resolve(this.cwd,e));this[p].push(new i(e,t)),this[_]()}[v](e){e.pending=!0,this[b]+=1;const t=this.follow?"stat":"lstat";I[t](e.absolute,((t,s)=>{e.pending=!1,this[b]-=1,t?this.emit("error",t):this[d](e,s)}))}[d](e,t){this.statCache.set(e.absolute,t),e.stat=t,this.filter(e.path,t)||(e.ignore=!0),this[_]()}[k](e){e.pending=!0,this[b]+=1,I.readdir(e.absolute,((t,s)=>{if(e.pending=!1,this[b]-=1,t)return this.emit("error",t);this[R](e,s)}))}[R](e,t){this.readdirCache.set(e.absolute,t),e.readdir=t,this[_]()}[_](){if(!this[y]){this[y]=!0;for(let e=this[p].head;null!==e&&this[b]<this.jobs;e=e.next)if(this[w](e.value),e.value.ignore){const t=e.next;this[p].removeNode(e),e.next=t}this[y]=!1,this[f]&&!this[p].length&&0===this[b]&&(this.zip?this.zip.end(u):(super.write(u),super.end()))}}get[m](){return this[p]&&this[p].head&&this[p].head.value}[g](e){this[p].shift(),this[b]-=1,this[_]()}[w](e){e.pending||(e.entry?e!==this[m]||e.piped||this[O](e):(e.stat||(this.statCache.has(e.absolute)?this[d](e,this.statCache.get(e.absolute)):this[v](e)),e.stat&&(e.ignore||(this.noDirRecurse||!e.stat.isDirectory()||e.readdir||(this.readdirCache.has(e.absolute)?this[R](e,this.readdirCache.get(e.absolute)):this[k](e),e.readdir))&&(e.entry=this[x](e),e.entry?e!==this[m]||e.piped||this[O](e):e.ignore=!0))))}[T](e){return{onwarn:(e,t,s)=>this.warn(e,t,s),noPax:this.noPax,cwd:this.cwd,absolute:e.absolute,preservePaths:this.preservePaths,maxReadSize:this.maxReadSize,strict:this.strict,portable:this.portable,linkCache:this.linkCache,statCache:this.statCache,noMtime:this.noMtime,mtime:this.mtime,prefix:this.prefix}}[x](e){this[b]+=1;try{return new this[L](e.path,this[T](e)).on("end",(()=>this[g](e))).on("error",(e=>this.emit("error",e)))}catch(e){this.emit("error",e)}}[N](){this[m]&&this[m].entry&&this[m].entry.resume()}[O](e){e.piped=!0,e.readdir&&e.readdir.forEach((t=>{const s=e.path,i="./"===s?"":s.replace(/\/*$/,"/");this[E](i+t)}));const t=e.entry,s=this.zip;s?t.on("data",(e=>{s.write(e)||t.pause()})):t.on("data",(e=>{super.write(e)||t.pause()}))}pause(){return this.zip&&this.zip.pause(),super.pause()}});B.Sync=class extends B{constructor(e){super(e),this[L]=a}pause(){}resume(){}[v](e){const t=this.follow?"statSync":"lstatSync";this[d](e,I[t](e.absolute))}[k](e,t){this[R](e,I.readdirSync(e.absolute))}[O](e){const t=e.entry,s=this.zip;e.readdir&&e.readdir.forEach((t=>{const s=e.path,i="./"===s?"":s.replace(/\/*$/,"/");this[E](i+t)})),s?t.on("data",(e=>{s.write(e)})):t.on("data",(e=>{super[C](e)}))}},e.exports=B},4588:(e,t,s)=>{"use strict";const i=s(4914),r=s(1549),n=s(2361),o=s(1123),h=s(3265),a=s(630),l=s(952),c=Buffer.from([31,139]),u=Symbol("state"),d=Symbol("writeEntry"),f=Symbol("readEntry"),p=Symbol("nextEntry"),m=Symbol("processEntry"),_=Symbol("extendedHeader"),y=Symbol("globalExtendedHeader"),w=Symbol("meta"),b=Symbol("emitMeta"),g=Symbol("buffer"),E=Symbol("queue"),S=Symbol("ended"),v=Symbol("emittedEnd"),k=Symbol("emit"),R=Symbol("unzip"),O=Symbol("consumeChunk"),x=Symbol("consumeChunkSub"),T=Symbol("consumeBody"),L=Symbol("consumeMeta"),C=Symbol("consumeHeader"),N=Symbol("consuming"),I=Symbol("bufferConcat"),A=Symbol("maybeEnd"),D=Symbol("writing"),P=Symbol("aborted"),B=Symbol("onDone"),M=Symbol("sawValidEntry"),F=Symbol("sawNullBlock"),U=Symbol("sawEOF"),j=e=>!0;e.exports=i(class extends n{constructor(e){super(e=e||{}),this.file=e.file||"",this[M]=null,this.on(B,(e=>{"begin"!==this[u]&&!1!==this[M]||this.warn("TAR_BAD_ARCHIVE","Unrecognized archive format")})),e.ondone?this.on(B,e.ondone):this.on(B,(e=>{this.emit("prefinish"),this.emit("finish"),this.emit("end"),this.emit("close")})),this.strict=!!e.strict,this.maxMetaEntrySize=e.maxMetaEntrySize||1048576,this.filter="function"==typeof e.filter?e.filter:j,this.writable=!0,this.readable=!1,this[E]=new o,this[g]=null,this[f]=null,this[d]=null,this[u]="begin",this[w]="",this[_]=null,this[y]=null,this[S]=!1,this[R]=null,this[P]=!1,this[F]=!1,this[U]=!1,"function"==typeof e.onwarn&&this.on("warn",e.onwarn),"function"==typeof e.onentry&&this.on("entry",e.onentry)}[C](e,t){let s;null===this[M]&&(this[M]=!1);try{s=new r(e,t,this[_],this[y])}catch(e){return this.warn("TAR_ENTRY_INVALID",e)}if(s.nullBlock)this[F]?(this[U]=!0,"begin"===this[u]&&(this[u]="header"),this[k]("eof")):(this[F]=!0,this[k]("nullBlock"));else if(this[F]=!1,s.cksumValid)if(s.path){const e=s.type;if(/^(Symbolic)?Link$/.test(e)&&!s.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath required",{header:s});else if(!/^(Symbolic)?Link$/.test(e)&&s.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath forbidden",{header:s});else{const e=this[d]=new h(s,this[_],this[y]);if(!this[M])if(e.remain){const t=()=>{e.invalid||(this[M]=!0)};e.on("end",t)}else this[M]=!0;e.meta?e.size>this.maxMetaEntrySize?(e.ignore=!0,this[k]("ignoredEntry",e),this[u]="ignore",e.resume()):e.size>0&&(this[w]="",e.on("data",(e=>this[w]+=e)),this[u]="meta"):(this[_]=null,e.ignore=e.ignore||!this.filter(e.path,e),e.ignore?(this[k]("ignoredEntry",e),this[u]=e.remain?"ignore":"header",e.resume()):(e.remain?this[u]="body":(this[u]="header",e.end()),this[f]?this[E].push(e):(this[E].push(e),this[p]())))}}else this.warn("TAR_ENTRY_INVALID","path is required",{header:s});else this.warn("TAR_ENTRY_INVALID","checksum failure",{header:s})}[m](e){let t=!0;return e?Array.isArray(e)?this.emit.apply(this,e):(this[f]=e,this.emit("entry",e),e.emittedEnd||(e.on("end",(e=>this[p]())),t=!1)):(this[f]=null,t=!1),t}[p](){do{}while(this[m](this[E].shift()));if(!this[E].length){const e=this[f];!e||e.flowing||e.size===e.remain?this[D]||this.emit("drain"):e.once("drain",(e=>this.emit("drain")))}}[T](e,t){const s=this[d],i=s.blockRemain,r=i>=e.length&&0===t?e:e.slice(t,t+i);return s.write(r),s.blockRemain||(this[u]="header",this[d]=null,s.end()),r.length}[L](e,t){const s=this[d],i=this[T](e,t);return this[d]||this[b](s),i}[k](e,t,s){this[E].length||this[f]?this[E].push([e,t,s]):this.emit(e,t,s)}[b](e){switch(this[k]("meta",this[w]),e.type){case"ExtendedHeader":case"OldExtendedHeader":this[_]=a.parse(this[w],this[_],!1);break;case"GlobalExtendedHeader":this[y]=a.parse(this[w],this[y],!0);break;case"NextFileHasLongPath":case"OldGnuLongPath":this[_]=this[_]||Object.create(null),this[_].path=this[w].replace(/\0.*/,"");break;case"NextFileHasLongLinkpath":this[_]=this[_]||Object.create(null),this[_].linkpath=this[w].replace(/\0.*/,"");break;default:throw new Error("unknown meta: "+e.type)}}abort(e){this[P]=!0,this.emit("abort",e),this.warn("TAR_ABORT",e,{recoverable:!1})}write(e){if(this[P])return;if(null===this[R]&&e){if(this[g]&&(e=Buffer.concat([this[g],e]),this[g]=null),e.length<c.length)return this[g]=e,!0;for(let t=0;null===this[R]&&t<c.length;t++)e[t]!==c[t]&&(this[R]=!1);if(null===this[R]){const t=this[S];this[S]=!1,this[R]=new l.Unzip,this[R].on("data",(e=>this[O](e))),this[R].on("error",(e=>this.abort(e))),this[R].on("end",(e=>{this[S]=!0,this[O]()})),this[D]=!0;const s=this[R][t?"end":"write"](e);return this[D]=!1,s}}this[D]=!0,this[R]?this[R].write(e):this[O](e),this[D]=!1;const t=!this[E].length&&(!this[f]||this[f].flowing);return t||this[E].length||this[f].once("drain",(e=>this.emit("drain"))),t}[I](e){e&&!this[P]&&(this[g]=this[g]?Buffer.concat([this[g],e]):e)}[A](){if(this[S]&&!this[v]&&!this[P]&&!this[N]){this[v]=!0;const e=this[d];if(e&&e.blockRemain){const t=this[g]?this[g].length:0;this.warn("TAR_BAD_ARCHIVE",`Truncated input (needed ${e.blockRemain} more bytes, only ${t} available)`,{entry:e}),this[g]&&e.write(this[g]),e.end()}this[k](B)}}[O](e){if(this[N])this[I](e);else if(e||this[g]){if(this[N]=!0,this[g]){this[I](e);const t=this[g];this[g]=null,this[x](t)}else this[x](e);for(;this[g]&&this[g].length>=512&&!this[P]&&!this[U];){const e=this[g];this[g]=null,this[x](e)}this[N]=!1}else this[A]();this[g]&&!this[S]||this[A]()}[x](e){let t=0;const s=e.length;for(;t+512<=s&&!this[P]&&!this[U];)switch(this[u]){case"begin":case"header":this[C](e,t),t+=512;break;case"ignore":case"body":t+=this[T](e,t);break;case"meta":t+=this[L](e,t);break;default:throw new Error("invalid state: "+this[u])}t<s&&(this[g]?this[g]=Buffer.concat([e.slice(t),this[g]]):this[g]=e.slice(t))}end(e){this[P]||(this[R]?this[R].end(e):(this[S]=!0,this.write(e)))}})},4475:(e,t,s)=>{const i=s(9491),r=s(5064),n=s(6433),{join:o}=s(1017),h="win32"===({}.TESTING_TAR_FAKE_PLATFORM||process.platform);e.exports=()=>{const e=new Map,t=new Map,s=new Set,a=s=>{const{paths:i,dirs:r}=(s=>{const i=t.get(s);if(!i)throw new Error("function does not have any path reservations");return{paths:i.paths.map((t=>e.get(t))),dirs:[...i.dirs].map((t=>e.get(t)))}})(s);return i.every((e=>e[0]===s))&&r.every((e=>e[0]instanceof Set&&e[0].has(s)))},l=e=>!(s.has(e)||!a(e))&&(s.add(e),e((()=>c(e))),!0),c=r=>{if(!s.has(r))return!1;const{paths:n,dirs:o}=t.get(r),h=new Set;return n.forEach((t=>{const s=e.get(t);i.equal(s[0],r),1===s.length?e.delete(t):(s.shift(),"function"==typeof s[0]?h.add(s[0]):s[0].forEach((e=>h.add(e))))})),o.forEach((t=>{const s=e.get(t);i(s[0]instanceof Set),1===s[0].size&&1===s.length?e.delete(t):1===s[0].size?(s.shift(),h.add(s[0])):s[0].delete(r)})),s.delete(r),h.forEach((e=>l(e))),!0};return{check:a,reserve:(s,i)=>{s=h?["win32 parallelization disabled"]:s.map((e=>r(n(o(e))).toLowerCase()));const a=new Set(s.map((e=>(e=>{const t=e.split("/").slice(0,-1).reduce(((e,t)=>(e.length&&(t=o(e[e.length-1],t)),e.push(t||"/"),e)),[]);return t})(e))).reduce(((e,t)=>e.concat(t))));return t.set(i,{dirs:a,paths:s}),s.forEach((t=>{const s=e.get(t);s?s.push(i):e.set(t,[i])})),a.forEach((t=>{const s=e.get(t);s?s[s.length-1]instanceof Set?s[s.length-1].add(i):s.push(new Set([i])):e.set(t,[new Set([i])])})),l(i)}}}},630:(e,t,s)=>{"use strict";const i=s(1549),r=s(1017);class n{constructor(e,t){this.atime=e.atime||null,this.charset=e.charset||null,this.comment=e.comment||null,this.ctime=e.ctime||null,this.gid=e.gid||null,this.gname=e.gname||null,this.linkpath=e.linkpath||null,this.mtime=e.mtime||null,this.path=e.path||null,this.size=e.size||null,this.uid=e.uid||null,this.uname=e.uname||null,this.dev=e.dev||null,this.ino=e.ino||null,this.nlink=e.nlink||null,this.global=t||!1}encode(){const e=this.encodeBody();if(""===e)return null;const t=Buffer.byteLength(e),s=512*Math.ceil(1+t/512),n=Buffer.allocUnsafe(s);for(let e=0;e<512;e++)n[e]=0;new i({path:("PaxHeader/"+r.basename(this.path)).slice(0,99),mode:this.mode||420,uid:this.uid||null,gid:this.gid||null,size:t,mtime:this.mtime||null,type:this.global?"GlobalExtendedHeader":"ExtendedHeader",linkpath:"",uname:this.uname||"",gname:this.gname||"",devmaj:0,devmin:0,atime:this.atime||null,ctime:this.ctime||null}).encode(n),n.write(e,512,t,"utf8");for(let e=t+512;e<n.length;e++)n[e]=0;return n}encodeBody(){return this.encodeField("path")+this.encodeField("ctime")+this.encodeField("atime")+this.encodeField("dev")+this.encodeField("ino")+this.encodeField("nlink")+this.encodeField("charset")+this.encodeField("comment")+this.encodeField("gid")+this.encodeField("gname")+this.encodeField("linkpath")+this.encodeField("mtime")+this.encodeField("size")+this.encodeField("uid")+this.encodeField("uname")}encodeField(e){if(null===this[e]||void 0===this[e])return"";const t=" "+("dev"===e||"ino"===e||"nlink"===e?"SCHILY.":"")+e+"="+(this[e]instanceof Date?this[e].getTime()/1e3:this[e])+"\n",s=Buffer.byteLength(t);let i=Math.floor(Math.log(s)/Math.log(10))+1;s+i>=Math.pow(10,i)&&(i+=1);return i+s+t}}n.parse=(e,t,s)=>new n(o(h(e),t),s);const o=(e,t)=>t?Object.keys(e).reduce(((t,s)=>(t[s]=e[s],t)),t):e,h=e=>e.replace(/\n$/,"").split("\n").reduce(a,Object.create(null)),a=(e,t)=>{const s=parseInt(t,10);if(s!==Buffer.byteLength(t)+1)return e;const i=(t=t.substr((s+" ").length)).split("="),r=i.shift().replace(/^SCHILY\.(dev|ino|nlink)/,"$1");if(!r)return e;const n=i.join("=");return e[r]=/^([A-Z]+\.)?([mac]|birth|creation)time$/.test(r)?new Date(1e3*n):/^[0-9]+$/.test(n)?+n:n,e};e.exports=n},3265:(e,t,s)=>{"use strict";const i=s(7008),r=s(1593),n=Symbol("slurp");e.exports=class extends i{constructor(e,t,s){switch(super(),this.pause(),this.extended=t,this.globalExtended=s,this.header=e,this.startBlockSize=512*Math.ceil(e.size/512),this.blockRemain=this.startBlockSize,this.remain=e.size,this.type=e.type,this.meta=!1,this.ignore=!1,this.type){case"File":case"OldFile":case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":case"ContiguousFile":case"GNUDumpDir":break;case"NextFileHasLongLinkpath":case"NextFileHasLongPath":case"OldGnuLongPath":case"GlobalExtendedHeader":case"ExtendedHeader":case"OldExtendedHeader":this.meta=!0;break;default:this.ignore=!0}this.path=r(e.path),this.mode=e.mode,this.mode&&(this.mode=4095&this.mode),this.uid=e.uid,this.gid=e.gid,this.uname=e.uname,this.gname=e.gname,this.size=e.size,this.mtime=e.mtime,this.atime=e.atime,this.ctime=e.ctime,this.linkpath=r(e.linkpath),this.uname=e.uname,this.gname=e.gname,t&&this[n](t),s&&this[n](s,!0)}write(e){const t=e.length;if(t>this.blockRemain)throw new Error("writing more to entry than is appropriate");const s=this.remain,i=this.blockRemain;return this.remain=Math.max(0,s-t),this.blockRemain=Math.max(0,i-t),!!this.ignore||(s>=t?super.write(e):super.write(e.slice(0,s)))}[n](e,t){for(const s in e)null===e[s]||void 0===e[s]||t&&"path"===s||(this[s]="path"===s||"linkpath"===s?r(e[s]):e[s])}}},5650:(e,t,s)=>{"use strict";const i=s(764),r=s(7511),n=s(7147),o=s(2276),h=s(3862),a=s(1017),l=s(1549);e.exports=(e,t,s)=>{const r=i(e);if(!r.file)throw new TypeError("file is required");if(r.gzip)throw new TypeError("cannot append to compressed archives");if(!t||!Array.isArray(t)||!t.length)throw new TypeError("no files or directories specified");return t=Array.from(t),r.sync?c(r,t):d(r,t,s)};const c=(e,t)=>{const s=new r.Sync(e);let i,o,h=!0;try{try{i=n.openSync(e.file,"r+")}catch(t){if("ENOENT"!==t.code)throw t;i=n.openSync(e.file,"w+")}const r=n.fstatSync(i),a=Buffer.alloc(512);e:for(o=0;o<r.size;o+=512){for(let e=0,t=0;e<512;e+=t){if(t=n.readSync(i,a,e,a.length-e,o+e),0===o&&31===a[0]&&139===a[1])throw new Error("cannot append to compressed archives");if(!t)break e}const t=new l(a);if(!t.cksumValid)break;const s=512*Math.ceil(t.size/512);if(o+s+512>r.size)break;o+=s,e.mtimeCache&&e.mtimeCache.set(t.path,t.mtime)}h=!1,u(e,s,o,i,t)}finally{if(h)try{n.closeSync(i)}catch(e){}}},u=(e,t,s,i,r)=>{const n=new o.WriteStreamSync(e.file,{fd:i,start:s});t.pipe(n),f(t,r)},d=(e,t,s)=>{t=Array.from(t);const i=new r(e),h=new Promise(((s,r)=>{i.on("error",r);let h="r+";const a=(c,u)=>c&&"ENOENT"===c.code&&"r+"===h?(h="w+",n.open(e.file,h,a)):c?r(c):void n.fstat(u,((h,a)=>{if(h)return n.close(u,(()=>r(h)));((t,s,i)=>{const r=(e,s)=>{e?n.close(t,(t=>i(e))):i(null,s)};let o=0;if(0===s)return r(null,0);let h=0;const a=Buffer.alloc(512),c=(i,u)=>{if(i)return r(i);if(h+=u,h<512&&u)return n.read(t,a,h,a.length-h,o+h,c);if(0===o&&31===a[0]&&139===a[1])return r(new Error("cannot append to compressed archives"));if(h<512)return r(null,o);const d=new l(a);if(!d.cksumValid)return r(null,o);const f=512*Math.ceil(d.size/512);return o+f+512>s?r(null,o):(o+=f+512,o>=s?r(null,o):(e.mtimeCache&&e.mtimeCache.set(d.path,d.mtime),h=0,void n.read(t,a,0,512,o,c)))};n.read(t,a,0,512,o,c)})(u,a.size,((n,h)=>{if(n)return r(n);const a=new o.WriteStream(e.file,{fd:u,start:h});i.pipe(a),a.on("error",r),a.on("close",s),p(i,t)}))}));n.open(e.file,h,a)}));return s?h.then(s,s):h},f=(e,t)=>{t.forEach((t=>{"@"===t.charAt(0)?h({file:a.resolve(e.cwd,t.substr(1)),sync:!0,noResume:!0,onentry:t=>e.add(t)}):e.add(t)})),e.end()},p=(e,t)=>{for(;t.length;){const s=t.shift();if("@"===s.charAt(0))return h({file:a.resolve(e.cwd,s.substr(1)),noResume:!0,onentry:t=>e.add(t)}).then((s=>p(e,t)));e.add(s)}e.end()}},6208:(e,t,s)=>{const{isAbsolute:i,parse:r}=s(1017).win32;e.exports=e=>{let t="",s=r(e);for(;i(e)||s.root;){const i="/"===e.charAt(0)&&"//?/"!==e.slice(0,4)?"/":s.root;e=e.substr(i.length),t+=i,s=r(e)}return[t,e]}},6433:e=>{e.exports=e=>{let t=e.length-1,s=-1;for(;t>-1&&"/"===e.charAt(t);)s=t,t--;return-1===s?e:e.slice(0,s)}},987:(e,t)=>{"use strict";t.name=new Map([["0","File"],["","OldFile"],["1","Link"],["2","SymbolicLink"],["3","CharacterDevice"],["4","BlockDevice"],["5","Directory"],["6","FIFO"],["7","ContiguousFile"],["g","GlobalExtendedHeader"],["x","ExtendedHeader"],["A","SolarisACL"],["D","GNUDumpDir"],["I","Inode"],["K","NextFileHasLongLinkpath"],["L","NextFileHasLongPath"],["M","ContinuationFile"],["N","OldGnuLongPath"],["S","SparseFile"],["V","TapeVolumeHeader"],["X","OldExtendedHeader"]]),t.code=new Map(Array.from(t.name).map((e=>[e[1],e[0]])))},7633:(e,t,s)=>{"use strict";const i=s(9491),r=s(4588),n=s(7147),o=s(2276),h=s(1017),a=s(7561),l=s(2853),c=s(4475),u=s(6208),d=s(1593),f=s(6433),p=s(5064),m=Symbol("onEntry"),_=Symbol("checkFs"),y=Symbol("checkFs2"),w=Symbol("pruneCache"),b=Symbol("isReusable"),g=Symbol("makeFs"),E=Symbol("file"),S=Symbol("directory"),v=Symbol("link"),k=Symbol("symlink"),R=Symbol("hardlink"),O=Symbol("unsupported"),x=Symbol("checkPath"),T=Symbol("mkdir"),L=Symbol("onError"),C=Symbol("pending"),N=Symbol("pend"),I=Symbol("unpend"),A=Symbol("ended"),D=Symbol("maybeClose"),P=Symbol("skip"),B=Symbol("doChown"),M=Symbol("uid"),F=Symbol("gid"),U=Symbol("checkedCwd"),j=s(6113),z=s(2040),W="win32"===({}.TESTING_TAR_FAKE_PLATFORM||process.platform),G=(e,t,s)=>e===e>>>0?e:t===t>>>0?t:s,V=e=>p(f(d(e))).toLowerCase();class q extends r{constructor(e){if(e||(e={}),e.ondone=e=>{this[A]=!0,this[D]()},super(e),this[U]=!1,this.reservations=c(),this.transform="function"==typeof e.transform?e.transform:null,this.writable=!0,this.readable=!1,this[C]=0,this[A]=!1,this.dirCache=e.dirCache||new Map,"number"==typeof e.uid||"number"==typeof e.gid){if("number"!=typeof e.uid||"number"!=typeof e.gid)throw new TypeError("cannot set owner without number uid and gid");if(e.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=e.uid,this.gid=e.gid,this.setOwner=!0}else this.uid=null,this.gid=null,this.setOwner=!1;void 0===e.preserveOwner&&"number"!=typeof e.uid?this.preserveOwner=process.getuid&&0===process.getuid():this.preserveOwner=!!e.preserveOwner,this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null,this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null,this.forceChown=!0===e.forceChown,this.win32=!!e.win32||W,this.newer=!!e.newer,this.keep=!!e.keep,this.noMtime=!!e.noMtime,this.preservePaths=!!e.preservePaths,this.unlink=!!e.unlink,this.cwd=d(h.resolve(e.cwd||process.cwd())),this.strip=+e.strip||0,this.processUmask=e.noChmod?0:process.umask(),this.umask="number"==typeof e.umask?e.umask:this.processUmask,this.dmode=e.dmode||511&~this.umask,this.fmode=e.fmode||438&~this.umask,this.on("entry",(e=>this[m](e)))}warn(e,t,s={}){return"TAR_BAD_ARCHIVE"!==e&&"TAR_ABORT"!==e||(s.recoverable=!1),super.warn(e,t,s)}[D](){this[A]&&0===this[C]&&(this.emit("prefinish"),this.emit("finish"),this.emit("end"),this.emit("close"))}[x](e){if(this.strip){const t=d(e.path).split("/");if(t.length<this.strip)return!1;if(e.path=t.slice(this.strip).join("/"),"Link"===e.type){const t=d(e.linkpath).split("/");if(!(t.length>=this.strip))return!1;e.linkpath=t.slice(this.strip).join("/")}}if(!this.preservePaths){const t=d(e.path),s=t.split("/");if(s.includes("..")||W&&/^[a-z]:\.\.$/i.test(s[0]))return this.warn("TAR_ENTRY_ERROR","path contains '..'",{entry:e,path:t}),!1;const[i,r]=u(t);i&&(e.path=r,this.warn("TAR_ENTRY_INFO",`stripping ${i} from absolute path`,{entry:e,path:t}))}if(h.isAbsolute(e.path)?e.absolute=d(h.resolve(e.path)):e.absolute=d(h.resolve(this.cwd,e.path)),!this.preservePaths&&0!==e.absolute.indexOf(this.cwd+"/")&&e.absolute!==this.cwd)return this.warn("TAR_ENTRY_ERROR","path escaped extraction target",{entry:e,path:d(e.path),resolvedPath:e.absolute,cwd:this.cwd}),!1;if(e.absolute===this.cwd&&"Directory"!==e.type&&"GNUDumpDir"!==e.type)return!1;if(this.win32){const{root:t}=h.win32.parse(e.absolute);e.absolute=t+l.encode(e.absolute.substr(t.length));const{root:s}=h.win32.parse(e.path);e.path=s+l.encode(e.path.substr(s.length))}return!0}[m](e){if(!this[x](e))return e.resume();switch(i.equal(typeof e.absolute,"string"),e.type){case"Directory":case"GNUDumpDir":e.mode&&(e.mode=448|e.mode);case"File":case"OldFile":case"ContiguousFile":case"Link":case"SymbolicLink":return this[_](e);default:return this[O](e)}}[L](e,t){"CwdError"===e.name?this.emit("error",e):(this.warn("TAR_ENTRY_ERROR",e,{entry:t}),this[I](),t.resume())}[T](e,t,s){a(d(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:t,noChmod:this.noChmod},s)}[B](e){return this.forceChown||this.preserveOwner&&("number"==typeof e.uid&&e.uid!==this.processUid||"number"==typeof e.gid&&e.gid!==this.processGid)||"number"==typeof this.uid&&this.uid!==this.processUid||"number"==typeof this.gid&&this.gid!==this.processGid}[M](e){return G(this.uid,e.uid,this.processUid)}[F](e){return G(this.gid,e.gid,this.processGid)}[E](e,t){const s=4095&e.mode||this.fmode,i=new o.WriteStream(e.absolute,{flags:z(e.size),mode:s,autoClose:!1});i.on("error",(s=>{i.fd&&n.close(i.fd,(()=>{})),i.write=()=>!0,this[L](s,e),t()}));let r=1;const h=s=>{if(s)return i.fd&&n.close(i.fd,(()=>{})),this[L](s,e),void t();0==--r&&n.close(i.fd,(s=>{s?this[L](s,e):this[I](),t()}))};i.on("finish",(t=>{const s=e.absolute,o=i.fd;if(e.mtime&&!this.noMtime){r++;const t=e.atime||new Date,i=e.mtime;n.futimes(o,t,i,(e=>e?n.utimes(s,t,i,(t=>h(t&&e))):h()))}if(this[B](e)){r++;const t=this[M](e),i=this[F](e);n.fchown(o,t,i,(e=>e?n.chown(s,t,i,(t=>h(t&&e))):h()))}h()}));const a=this.transform&&this.transform(e)||e;a!==e&&(a.on("error",(s=>{this[L](s,e),t()})),e.pipe(a)),a.pipe(i)}[S](e,t){const s=4095&e.mode||this.dmode;this[T](e.absolute,s,(s=>{if(s)return this[L](s,e),void t();let i=1;const r=s=>{0==--i&&(t(),this[I](),e.resume())};e.mtime&&!this.noMtime&&(i++,n.utimes(e.absolute,e.atime||new Date,e.mtime,r)),this[B](e)&&(i++,n.chown(e.absolute,this[M](e),this[F](e),r)),r()}))}[O](e){e.unsupported=!0,this.warn("TAR_ENTRY_UNSUPPORTED",`unsupported entry type: ${e.type}`,{entry:e}),e.resume()}[k](e,t){this[v](e,e.linkpath,"symlink",t)}[R](e,t){const s=d(h.resolve(this.cwd,e.linkpath));this[v](e,s,"link",t)}[N](){this[C]++}[I](){this[C]--,this[D]()}[P](e){this[I](),e.resume()}[b](e,t){return"File"===e.type&&!this.unlink&&t.isFile()&&t.nlink<=1&&!W}[_](e){this[N]();const t=[e.path];e.linkpath&&t.push(e.linkpath),this.reservations.reserve(t,(t=>this[y](e,t)))}[w](e){"SymbolicLink"===e.type?(e=>{for(const t of e.keys())e.delete(t)})(this.dirCache):"Directory"!==e.type&&((e,t)=>{t=V(t);for(const s of e.keys()){const i=V(s);i!==t&&0!==i.indexOf(t+"/")||e.delete(s)}})(this.dirCache,e.absolute)}[y](e,t){this[w](e);const s=s=>{this[w](e),t(s)},i=()=>{if(e.absolute!==this.cwd){const t=d(h.dirname(e.absolute));if(t!==this.cwd)return this[T](t,this.dmode,(t=>{if(t)return this[L](t,e),void s();r()}))}r()},r=()=>{n.lstat(e.absolute,((t,i)=>{if(i&&(this.keep||this.newer&&i.mtime>e.mtime))return this[P](e),void s();if(t||this[b](e,i))return this[g](null,e,s);if(i.isDirectory()){if("Directory"===e.type){const t=t=>this[g](t,e,s);return!this.noChmod&&e.mode&&(4095&i.mode)!==e.mode?n.chmod(e.absolute,e.mode,t):t()}if(e.absolute!==this.cwd)return n.rmdir(e.absolute,(t=>this[g](t,e,s)))}if(e.absolute===this.cwd)return this[g](null,e,s);((e,t)=>{if(!W)return n.unlink(e,t);const s=e+".DELETE."+j.randomBytes(16).toString("hex");n.rename(e,s,(e=>{if(e)return t(e);n.unlink(s,t)}))})(e.absolute,(t=>this[g](t,e,s)))}))};this[U]?i():(()=>{this[T](this.cwd,this.dmode,(t=>{if(t)return this[L](t,e),void s();this[U]=!0,i()}))})()}[g](e,t,s){if(e)return this[L](e,t),void s();switch(t.type){case"File":case"OldFile":case"ContiguousFile":return this[E](t,s);case"Link":return this[R](t,s);case"SymbolicLink":return this[k](t,s);case"Directory":case"GNUDumpDir":return this[S](t,s)}}[v](e,t,s,i){n[s](t,e.absolute,(t=>{t?this[L](t,e):(this[I](),e.resume()),i()}))}}const H=e=>{try{return[null,e()]}catch(e){return[e,null]}};q.Sync=class extends q{[g](e,t){return super[g](e,t,(()=>{}))}[_](e){if(this[w](e),!this[U]){const t=this[T](this.cwd,this.dmode);if(t)return this[L](t,e);this[U]=!0}if(e.absolute!==this.cwd){const t=d(h.dirname(e.absolute));if(t!==this.cwd){const s=this[T](t,this.dmode);if(s)return this[L](s,e)}}const[t,s]=H((()=>n.lstatSync(e.absolute)));if(s&&(this.keep||this.newer&&s.mtime>e.mtime))return this[P](e);if(t||this[b](e,s))return this[g](null,e);if(s.isDirectory()){if("Directory"===e.type){const t=!this.noChmod&&e.mode&&(4095&s.mode)!==e.mode,[i]=t?H((()=>{n.chmodSync(e.absolute,e.mode)})):[];return this[g](i,e)}const[t]=H((()=>n.rmdirSync(e.absolute)));this[g](t,e)}const[i]=e.absolute===this.cwd?[]:H((()=>(e=>{if(!W)return n.unlinkSync(e);const t=e+".DELETE."+j.randomBytes(16).toString("hex");n.renameSync(e,t),n.unlinkSync(t)})(e.absolute)));this[g](i,e)}[E](e,t){const s=4095&e.mode||this.fmode,i=s=>{let i;try{n.closeSync(r)}catch(e){i=e}(s||i)&&this[L](s||i,e),t()};let r;try{r=n.openSync(e.absolute,z(e.size),s)}catch(e){return i(e)}const o=this.transform&&this.transform(e)||e;o!==e&&(o.on("error",(t=>this[L](t,e))),e.pipe(o)),o.on("data",(e=>{try{n.writeSync(r,e,0,e.length)}catch(e){i(e)}})),o.on("end",(t=>{let s=null;if(e.mtime&&!this.noMtime){const t=e.atime||new Date,i=e.mtime;try{n.futimesSync(r,t,i)}catch(r){try{n.utimesSync(e.absolute,t,i)}catch(e){s=r}}}if(this[B](e)){const t=this[M](e),i=this[F](e);try{n.fchownSync(r,t,i)}catch(r){try{n.chownSync(e.absolute,t,i)}catch(e){s=s||r}}}i(s)}))}[S](e,t){const s=4095&e.mode||this.dmode,i=this[T](e.absolute,s);if(i)return this[L](i,e),void t();if(e.mtime&&!this.noMtime)try{n.utimesSync(e.absolute,e.atime||new Date,e.mtime)}catch(i){}if(this[B](e))try{n.chownSync(e.absolute,this[M](e),this[F](e))}catch(i){}t(),e.resume()}[T](e,t){try{return a.sync(d(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:t})}catch(e){return e}}[v](e,t,s,i){try{n[s+"Sync"](t,e.absolute),i(),e.resume()}catch(t){return this[L](t,e)}}},e.exports=q},9318:(e,t,s)=>{"use strict";const i=s(764),r=s(5650);e.exports=(e,t,s)=>{const o=i(e);if(!o.file)throw new TypeError("file is required");if(o.gzip)throw new TypeError("cannot append to compressed archives");if(!t||!Array.isArray(t)||!t.length)throw new TypeError("no files or directories specified");return t=Array.from(t),n(o),r(o,t,s)};const n=e=>{const t=e.filter;e.mtimeCache||(e.mtimeCache=new Map),e.filter=t?(s,i)=>t(s,i)&&!(e.mtimeCache.get(s)>i.mtime):(t,s)=>!(e.mtimeCache.get(t)>s.mtime)}},4914:e=>{"use strict";e.exports=e=>class extends e{warn(e,t,s={}){this.file&&(s.file=this.file),this.cwd&&(s.cwd=this.cwd),s.code=t instanceof Error&&t.code||e,s.tarCode=e,this.strict||!1===s.recoverable?t instanceof Error?this.emit("error",Object.assign(t,s)):this.emit("error",Object.assign(new Error(`${e}: ${t}`),s)):(t instanceof Error&&(s=Object.assign(t,s),t=t.message),this.emit("warn",s.tarCode,t,s))}}},2853:e=>{"use strict";const t=["|","<",">","?",":"],s=t.map((e=>String.fromCharCode(61440+e.charCodeAt(0)))),i=new Map(t.map(((e,t)=>[e,s[t]]))),r=new Map(s.map(((e,s)=>[e,t[s]])));e.exports={encode:e=>t.reduce(((e,t)=>e.split(t).join(i.get(t))),e),decode:e=>s.reduce(((e,t)=>e.split(t).join(r.get(t))),e)}},2944:(e,t,s)=>{"use strict";const i=s(7008),r=s(630),n=s(1549),o=s(7147),h=s(1017),a=s(1593),l=s(6433),c=(e,t)=>t?(e=a(e).replace(/^\.(\/|$)/,""),l(t)+"/"+e):a(e),u=Symbol("process"),d=Symbol("file"),f=Symbol("directory"),p=Symbol("symlink"),m=Symbol("hardlink"),_=Symbol("header"),y=Symbol("read"),w=Symbol("lstat"),b=Symbol("onlstat"),g=Symbol("onread"),E=Symbol("onreadlink"),S=Symbol("openfile"),v=Symbol("onopenfile"),k=Symbol("close"),R=Symbol("mode"),O=Symbol("awaitDrain"),x=Symbol("ondrain"),T=Symbol("prefix"),L=Symbol("hadError"),C=s(4914),N=s(2853),I=s(6208),A=s(513),D=C(class extends i{constructor(e,t){if(super(t=t||{}),"string"!=typeof e)throw new TypeError("path is required");this.path=a(e),this.portable=!!t.portable,this.myuid=process.getuid&&process.getuid()||0,this.myuser={}.USER||"",this.maxReadSize=t.maxReadSize||16777216,this.linkCache=t.linkCache||new Map,this.statCache=t.statCache||new Map,this.preservePaths=!!t.preservePaths,this.cwd=a(t.cwd||process.cwd()),this.strict=!!t.strict,this.noPax=!!t.noPax,this.noMtime=!!t.noMtime,this.mtime=t.mtime||null,this.prefix=t.prefix?a(t.prefix):null,this.fd=null,this.blockLen=null,this.blockRemain=null,this.buf=null,this.offset=null,this.length=null,this.pos=null,this.remain=null,"function"==typeof t.onwarn&&this.on("warn",t.onwarn);let s=!1;if(!this.preservePaths){const[e,t]=I(this.path);e&&(this.path=t,s=e)}this.win32=!!t.win32||"win32"===process.platform,this.win32&&(this.path=N.decode(this.path.replace(/\\/g,"/")),e=e.replace(/\\/g,"/")),this.absolute=a(t.absolute||h.resolve(this.cwd,e)),""===this.path&&(this.path="./"),s&&this.warn("TAR_ENTRY_INFO",`stripping ${s} from absolute path`,{entry:this,path:s+this.path}),this.statCache.has(this.absolute)?this[b](this.statCache.get(this.absolute)):this[w]()}emit(e,...t){return"error"===e&&(this[L]=!0),super.emit(e,...t)}[w](){o.lstat(this.absolute,((e,t)=>{if(e)return this.emit("error",e);this[b](t)}))}[b](e){this.statCache.set(this.absolute,e),this.stat=e,e.isFile()||(e.size=0),this.type=B(e),this.emit("stat",e),this[u]()}[u](){switch(this.type){case"File":return this[d]();case"Directory":return this[f]();case"SymbolicLink":return this[p]();default:return this.end()}}[R](e){return A(e,"Directory"===this.type,this.portable)}[T](e){return c(e,this.prefix)}[_](){"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.header=new n({path:this[T](this.path),linkpath:"Link"===this.type?this[T](this.linkpath):this.linkpath,mode:this[R](this.stat.mode),uid:this.portable?null:this.stat.uid,gid:this.portable?null:this.stat.gid,size:this.stat.size,mtime:this.noMtime?null:this.mtime||this.stat.mtime,type:this.type,uname:this.portable?null:this.stat.uid===this.myuid?this.myuser:"",atime:this.portable?null:this.stat.atime,ctime:this.portable?null:this.stat.ctime}),this.header.encode()&&!this.noPax&&super.write(new r({atime:this.portable?null:this.header.atime,ctime:this.portable?null:this.header.ctime,gid:this.portable?null:this.header.gid,mtime:this.noMtime?null:this.mtime||this.header.mtime,path:this[T](this.path),linkpath:"Link"===this.type?this[T](this.linkpath):this.linkpath,size:this.header.size,uid:this.portable?null:this.header.uid,uname:this.portable?null:this.header.uname,dev:this.portable?null:this.stat.dev,ino:this.portable?null:this.stat.ino,nlink:this.portable?null:this.stat.nlink}).encode()),super.write(this.header.block)}[f](){"/"!==this.path.substr(-1)&&(this.path+="/"),this.stat.size=0,this[_](),this.end()}[p](){o.readlink(this.absolute,((e,t)=>{if(e)return this.emit("error",e);this[E](t)}))}[E](e){this.linkpath=a(e),this[_](),this.end()}[m](e){this.type="Link",this.linkpath=a(h.relative(this.cwd,e)),this.stat.size=0,this[_](),this.end()}[d](){if(this.stat.nlink>1){const e=this.stat.dev+":"+this.stat.ino;if(this.linkCache.has(e)){const t=this.linkCache.get(e);if(0===t.indexOf(this.cwd))return this[m](t)}this.linkCache.set(e,this.absolute)}if(this[_](),0===this.stat.size)return this.end();this[S]()}[S](){o.open(this.absolute,"r",((e,t)=>{if(e)return this.emit("error",e);this[v](t)}))}[v](e){if(this.fd=e,this[L])return this[k]();this.blockLen=512*Math.ceil(this.stat.size/512),this.blockRemain=this.blockLen;const t=Math.min(this.blockLen,this.maxReadSize);this.buf=Buffer.allocUnsafe(t),this.offset=0,this.pos=0,this.remain=this.stat.size,this.length=this.buf.length,this[y]()}[y](){const{fd:e,buf:t,offset:s,length:i,pos:r}=this;o.read(e,t,s,i,r,((e,t)=>{if(e)return this[k]((()=>this.emit("error",e)));this[g](t)}))}[k](e){o.close(this.fd,e)}[g](e){if(e<=0&&this.remain>0){const e=new Error("encountered unexpected EOF");return e.path=this.absolute,e.syscall="read",e.code="EOF",this[k]((()=>this.emit("error",e)))}if(e>this.remain){const e=new Error("did not encounter expected EOF");return e.path=this.absolute,e.syscall="read",e.code="EOF",this[k]((()=>this.emit("error",e)))}if(e===this.remain)for(let t=e;t<this.length&&e<this.blockRemain;t++)this.buf[t+this.offset]=0,e++,this.remain++;const t=0===this.offset&&e===this.buf.length?this.buf:this.buf.slice(this.offset,this.offset+e);this.write(t)?this[x]():this[O]((()=>this[x]()))}[O](e){this.once("drain",e)}write(e){if(this.blockRemain<e.length){const e=new Error("writing more data than expected");return e.path=this.absolute,this.emit("error",e)}return this.remain-=e.length,this.blockRemain-=e.length,this.pos+=e.length,this.offset+=e.length,super.write(e)}[x](){if(!this.remain)return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),this[k]((e=>e?this.emit("error",e):this.end()));this.offset>=this.length&&(this.buf=Buffer.allocUnsafe(Math.min(this.blockRemain,this.buf.length)),this.offset=0),this.length=this.buf.length-this.offset,this[y]()}});const P=C(class extends i{constructor(e,t){super(t=t||{}),this.preservePaths=!!t.preservePaths,this.portable=!!t.portable,this.strict=!!t.strict,this.noPax=!!t.noPax,this.noMtime=!!t.noMtime,this.readEntry=e,this.type=e.type,"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.prefix=t.prefix||null,this.path=a(e.path),this.mode=this[R](e.mode),this.uid=this.portable?null:e.uid,this.gid=this.portable?null:e.gid,this.uname=this.portable?null:e.uname,this.gname=this.portable?null:e.gname,this.size=e.size,this.mtime=this.noMtime?null:t.mtime||e.mtime,this.atime=this.portable?null:e.atime,this.ctime=this.portable?null:e.ctime,this.linkpath=a(e.linkpath),"function"==typeof t.onwarn&&this.on("warn",t.onwarn);let s=!1;if(!this.preservePaths){const[e,t]=I(this.path);e&&(this.path=t,s=e)}this.remain=e.size,this.blockRemain=e.startBlockSize,this.header=new n({path:this[T](this.path),linkpath:"Link"===this.type?this[T](this.linkpath):this.linkpath,mode:this.mode,uid:this.portable?null:this.uid,gid:this.portable?null:this.gid,size:this.size,mtime:this.noMtime?null:this.mtime,type:this.type,uname:this.portable?null:this.uname,atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime}),s&&this.warn("TAR_ENTRY_INFO",`stripping ${s} from absolute path`,{entry:this,path:s+this.path}),this.header.encode()&&!this.noPax&&super.write(new r({atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime,gid:this.portable?null:this.gid,mtime:this.noMtime?null:this.mtime,path:this[T](this.path),linkpath:"Link"===this.type?this[T](this.linkpath):this.linkpath,size:this.size,uid:this.portable?null:this.uid,uname:this.portable?null:this.uname,dev:this.portable?null:this.readEntry.dev,ino:this.portable?null:this.readEntry.ino,nlink:this.portable?null:this.readEntry.nlink}).encode()),super.write(this.header.block),e.pipe(this)}[T](e){return c(e,this.prefix)}[R](e){return A(e,"Directory"===this.type,this.portable)}write(e){const t=e.length;if(t>this.blockRemain)throw new Error("writing more to entry than is appropriate");return this.blockRemain-=t,super.write(e)}end(){return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),super.end()}});D.Sync=class extends D{[w](){this[b](o.lstatSync(this.absolute))}[p](){this[E](o.readlinkSync(this.absolute))}[S](){this[v](o.openSync(this.absolute,"r"))}[y](){let e=!0;try{const{fd:t,buf:s,offset:i,length:r,pos:n}=this,h=o.readSync(t,s,i,r,n);this[g](h),e=!1}finally{if(e)try{this[k]((()=>{}))}catch(e){}}}[O](e){e()}[k](e){o.closeSync(this.fd),e()}},D.Tar=P;const B=e=>e.isFile()?"File":e.isDirectory()?"Directory":e.isSymbolicLink()?"SymbolicLink":"Unsupported";e.exports=D},7073:e=>{"use strict";e.exports=function(e){const t=e.length;let s=0;for(;s<t;)if(0==(128&e[s]))s++;else if(192==(224&e[s])){if(s+1===t||128!=(192&e[s+1])||192==(254&e[s]))return!1;s+=2}else if(224==(240&e[s])){if(s+2>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||224===e[s]&&128==(224&e[s+1])||237===e[s]&&160==(224&e[s+1]))return!1;s+=3}else{if(240!=(248&e[s]))return!1;if(s+3>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||128!=(192&e[s+3])||240===e[s]&&128==(240&e[s+1])||244===e[s]&&e[s+1]>143||e[s]>244)return!1;s+=4}return!0}},8403:(e,t,s)=>{"use strict";try{e.exports=s(8495)(__dirname)}catch(t){e.exports=s(7073)}},1737:(e,t,s)=>{"use strict";const{EMPTY_BUFFER:i}=s(9336);function r(e,t){if(0===e.length)return i;if(1===e.length)return e[0];const s=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const i=e[t];s.set(i,r),r+=i.length}return r<t?s.slice(0,r):s}function n(e,t,s,i,r){for(let n=0;n<r;n++)s[i+n]=e[n]^t[3&n]}function o(e,t){for(let s=0;s<e.length;s++)e[s]^=t[3&s]}function h(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function a(e){if(a.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),a.readOnly=!1),t}try{const t=s(1098);e.exports={concat:r,mask(e,s,i,r,o){o<48?n(e,s,i,r,o):t.mask(e,s,i,r,o)},toArrayBuffer:h,toBuffer:a,unmask(e,s){e.length<32?o(e,s):t.unmask(e,s)}}}catch(t){e.exports={concat:r,mask:n,toArrayBuffer:h,toBuffer:a,unmask:o}}},9336:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},131:(e,t,s)=>{"use strict";const{kForOnEventAttribute:i,kListener:r}=s(9336),n=Symbol("kCode"),o=Symbol("kData"),h=Symbol("kError"),a=Symbol("kMessage"),l=Symbol("kReason"),c=Symbol("kTarget"),u=Symbol("kType"),d=Symbol("kWasClean");class f{constructor(e){this[c]=null,this[u]=e}get target(){return this[c]}get type(){return this[u]}}Object.defineProperty(f.prototype,"target",{enumerable:!0}),Object.defineProperty(f.prototype,"type",{enumerable:!0});class p extends f{constructor(e,t={}){super(e),this[n]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[d]=void 0!==t.wasClean&&t.wasClean}get code(){return this[n]}get reason(){return this[l]}get wasClean(){return this[d]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class m extends f{constructor(e,t={}){super(e),this[h]=void 0===t.error?null:t.error,this[a]=void 0===t.message?"":t.message}get error(){return this[h]}get message(){return this[a]}}Object.defineProperty(m.prototype,"error",{enumerable:!0}),Object.defineProperty(m.prototype,"message",{enumerable:!0});class _ extends f{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}Object.defineProperty(_.prototype,"data",{enumerable:!0});const y={addEventListener(e,t,s={}){let n;if("message"===e)n=function(e,s){const i=new _("message",{data:s?e:e.toString()});i[c]=this,t.call(this,i)};else if("close"===e)n=function(e,s){const i=new p("close",{code:e,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[c]=this,t.call(this,i)};else if("error"===e)n=function(e){const s=new m("error",{error:e,message:e.message});s[c]=this,t.call(this,s)};else{if("open"!==e)return;n=function(){const e=new f("open");e[c]=this,t.call(this,e)}}n[i]=!!s[i],n[r]=t,s.once?this.once(e,n):this.on(e,n)},removeEventListener(e,t){for(const s of this.listeners(e))if(s[r]===t&&!s[i]){this.removeListener(e,s);break}}};e.exports={CloseEvent:p,ErrorEvent:m,Event:f,EventTarget:y,MessageEvent:_}},9450:(e,t,s)=>{"use strict";const{tokenChars:i}=s(7908);function r(e,t,s){void 0===e[t]?e[t]=[s]:e[t].push(s)}e.exports={format:function(e){return Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>[t].concat(Object.keys(e).map((t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let s,n,o=Object.create(null),h=!1,a=!1,l=!1,c=-1,u=-1,d=-1,f=0;for(;f<e.length;f++)if(u=e.charCodeAt(f),void 0===s)if(-1===d&&1===i[u])-1===c&&(c=f);else if(0===f||32!==u&&9!==u){if(59!==u&&44!==u)throw new SyntaxError(`Unexpected character at index ${f}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);const i=e.slice(c,d);44===u?(r(t,i,o),o=Object.create(null)):s=i,c=d=-1}}else-1===d&&-1!==c&&(d=f);else if(void 0===n)if(-1===d&&1===i[u])-1===c&&(c=f);else if(32===u||9===u)-1===d&&-1!==c&&(d=f);else if(59===u||44===u){if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f),r(o,e.slice(c,d),!0),44===u&&(r(t,s,o),o=Object.create(null),s=void 0),c=d=-1}else{if(61!==u||-1===c||-1!==d)throw new SyntaxError(`Unexpected character at index ${f}`);n=e.slice(c,f),c=d=-1}else if(a){if(1!==i[u])throw new SyntaxError(`Unexpected character at index ${f}`);-1===c?c=f:h||(h=!0),a=!1}else if(l)if(1===i[u])-1===c&&(c=f);else if(34===u&&-1!==c)l=!1,d=f;else{if(92!==u)throw new SyntaxError(`Unexpected character at index ${f}`);a=!0}else if(34===u&&61===e.charCodeAt(f-1))l=!0;else if(-1===d&&1===i[u])-1===c&&(c=f);else if(-1===c||32!==u&&9!==u){if(59!==u&&44!==u)throw new SyntaxError(`Unexpected character at index ${f}`);{if(-1===c)throw new SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let i=e.slice(c,d);h&&(i=i.replace(/\\/g,""),h=!1),r(o,n,i),44===u&&(r(t,s,o),o=Object.create(null),s=void 0),n=void 0,c=d=-1}}else-1===d&&(d=f);if(-1===c||l||32===u||9===u)throw new SyntaxError("Unexpected end of input");-1===d&&(d=f);const p=e.slice(c,d);return void 0===s?r(t,p,o):(void 0===n?r(o,p,!0):r(o,n,h?p.replace(/\\/g,""):p),r(t,s,o)),t}}},7876:e=>{"use strict";const t=Symbol("kDone"),s=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[s]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[s]()}[s](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},2106:(e,t,s)=>{"use strict";const i=s(9796),r=s(1737),n=s(7876),{kStatusCode:o}=s(9336),h=Buffer.from([0,0,255,255]),a=Symbol("permessage-deflate"),l=Symbol("total-length"),c=Symbol("callback"),u=Symbol("buffers"),d=Symbol("error");let f;function p(e){this[u].push(e),this[l]+=e.length}function m(e){this[l]+=e.length,this[a]._maxPayload<1||this[l]<=this[a]._maxPayload?this[u].push(e):(this[d]=new RangeError("Max payload size exceeded"),this[d].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[d][o]=1009,this.removeListener("data",m),this.reset())}function _(e){this[a]._inflate=null,e[o]=1007,this[c](e)}e.exports=class{constructor(e,t,s){if(this._maxPayload=0|s,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!f){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;f=new n(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[c];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,s=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!s)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(s.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?s.client_max_window_bits=t.clientMaxWindowBits:!0!==s.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete s.client_max_window_bits,s}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let s=e[t];if(s.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(s=s[0],"client_max_window_bits"===t){if(!0!==s){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}else if("server_max_window_bits"===t){const e=+s;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==s)throw new TypeError(`Invalid value for parameter "${t}": ${s}`)}e[t]=s}))})),e}decompress(e,t,s){f.add((i=>{this._decompress(e,t,((e,t)=>{i(),s(e,t)}))}))}compress(e,t,s){f.add((i=>{this._compress(e,t,((e,t)=>{i(),s(e,t)}))}))}_decompress(e,t,s){const n=this._isServer?"client":"server";if(!this._inflate){const e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[a]=this,this._inflate[l]=0,this._inflate[u]=[],this._inflate.on("error",_),this._inflate.on("data",m)}this._inflate[c]=s,this._inflate.write(e),t&&this._inflate.write(h),this._inflate.flush((()=>{const e=this._inflate[d];if(e)return this._inflate.close(),this._inflate=null,void s(e);const i=r.concat(this._inflate[u],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[u]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),s(null,i)}))}_compress(e,t,s){const n=this._isServer?"server":"client";if(!this._deflate){const e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[l]=0,this._deflate[u]=[],this._deflate.on("data",p)}this._deflate[c]=s,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=r.concat(this._deflate[u],this._deflate[l]);t&&(e=e.slice(0,e.length-4)),this._deflate[c]=null,this._deflate[l]=0,this._deflate[u]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),s(null,e)}))}}},7728:(e,t,s)=>{"use strict";const{Writable:i}=s(2781),r=s(2106),{BINARY_TYPES:n,EMPTY_BUFFER:o,kStatusCode:h,kWebSocket:a}=s(9336),{concat:l,toArrayBuffer:c,unmask:u}=s(1737),{isValidStatusCode:d,isValidUTF8:f}=s(7908);function p(e,t,s,i,r){const n=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(n,p),n.code=r,n[h]=i,n}e.exports=class extends i{constructor(e={}){super(),this._binaryType=e.binaryType||n[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[a]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,s){if(8===this._opcode&&0==this._state)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const s=this._buffers[0],i=t.length-e;e>=s.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),i),this._buffers[0]=s.slice(e)),e-=s.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,p(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[r.extensionName])return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,p(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,p(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,p(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,p(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,p(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,p(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,p(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,p(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,p(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,p(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&u(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[r.extensionName].decompress(e,this._fin,((e,s)=>{if(e)return t(e);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(p(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(s)}const i=this.dataMessage();if(i)return t(i);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?l(t,e):"arraybuffer"===this._binaryType?c(l(t,e)):t,this.emit("message",s,!0)}else{const s=l(t,e);if(!this._skipUTF8Validation&&!f(s))return this._loop=!1,p(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,o),this.end();else{if(1===e.length)return p(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const t=e.readUInt16BE(0);if(!d(t))return p(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const s=e.slice(2);if(!this._skipUTF8Validation&&!f(s))return p(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,s),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},4601:(e,t,s)=>{"use strict";s(1808),s(4404);const{randomFillSync:i}=s(6113),r=s(2106),{EMPTY_BUFFER:n}=s(9336),{isValidStatusCode:o}=s(7908),{mask:h,toBuffer:a}=s(1737),l=Symbol("kByteLength"),c=Buffer.alloc(4);class u{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let s,r,n=!1,o=2,a=!1;t.mask&&(s=t.maskBuffer||c,t.generateMask?t.generateMask(s):i(s,0,4),a=0==(s[0]|s[1]|s[2]|s[3]),o=6),"string"==typeof e?r=t.mask&&!a||void 0===t[l]?(e=Buffer.from(e)).length:t[l]:(r=e.length,n=t.mask&&t.readOnly&&!a);let u=r;r>=65536?(o+=8,u=127):r>125&&(o+=2,u=126);const d=Buffer.allocUnsafe(n?r+o:o);return d[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(d[0]|=64),d[1]=u,126===u?d.writeUInt16BE(r,2):127===u&&(d[2]=d[3]=0,d.writeUIntBE(r,4,6)),t.mask?(d[1]|=128,d[o-4]=s[0],d[o-3]=s[1],d[o-2]=s[2],d[o-1]=s[3],a?[d,e]:n?(h(e,s,d,o,r),[d]):(h(e,s,e,0,r),[d,e])):[d,e]}close(e,t,s,i){let r;if(void 0===e)r=n;else{if("number"!=typeof e||!o(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const s=Buffer.byteLength(t);if(s>123)throw new RangeError("The message must not be greater than 123 bytes");r=Buffer.allocUnsafe(2+s),r.writeUInt16BE(e,0),"string"==typeof t?r.write(t,2):r.set(t,2)}else r=Buffer.allocUnsafe(2),r.writeUInt16BE(e,0)}const h={[l]:r.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,r,!1,h,i]):this.sendFrame(u.frame(r,h),i)}ping(e,t,s){let i,r;if("string"==typeof e?(i=Buffer.byteLength(e),r=!1):(i=(e=a(e)).length,r=a.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[l]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:r,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,n,s]):this.sendFrame(u.frame(e,n),s)}pong(e,t,s){let i,r;if("string"==typeof e?(i=Buffer.byteLength(e),r=!1):(i=(e=a(e)).length,r=a.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const n={[l]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:r,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,n,s]):this.sendFrame(u.frame(e,n),s)}send(e,t,s){const i=this._extensions[r.extensionName];let n,o,h=t.binary?2:1,c=t.compress;if("string"==typeof e?(n=Buffer.byteLength(e),o=!1):(n=(e=a(e)).length,o=a.readOnly),this._firstFragment?(this._firstFragment=!1,c&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=n>=i._threshold),this._compress=c):(c=!1,h=0),t.fin&&(this._firstFragment=!0),i){const i={[l]:n,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:o,rsv1:c};this._deflating?this.enqueue([this.dispatch,e,this._compress,i,s]):this.dispatch(e,this._compress,i,s)}else this.sendFrame(u.frame(e,{[l]:n,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:o,rsv1:!1}),s)}dispatch(e,t,s,i){if(!t)return void this.sendFrame(u.frame(e,s),i);const n=this._extensions[r.extensionName];this._bufferedBytes+=s[l],this._deflating=!0,n.compress(e,s.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof i&&i(e);for(let t=0;t<this._queue.length;t++){const s=this._queue[t],i=s[s.length-1];"function"==typeof i&&i(e)}}else this._bufferedBytes-=s[l],this._deflating=!1,s.readOnly=!1,this.sendFrame(u.frame(t,s),i),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][l],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][l],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=u},3419:(e,t,s)=>{"use strict";const{Duplex:i}=s(2781);function r(e){e.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let s=!0;const h=new i({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,s){const i=!s&&h._readableState.objectMode?t.toString():t;h.push(i)||e.pause()})),e.once("error",(function(e){h.destroyed||(s=!1,h.destroy(e))})),e.once("close",(function(){h.destroyed||h.push(null)})),h._destroy=function(t,i){if(e.readyState===e.CLOSED)return i(t),void process.nextTick(r,h);let n=!1;e.once("error",(function(e){n=!0,i(e)})),e.once("close",(function(){n||i(t),process.nextTick(r,h)})),s&&e.terminate()},h._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),h._readableState.endEmitted&&h.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){h._final(t)}))},h._read=function(){e.isPaused&&e.resume()},h._write=function(t,s,i){e.readyState!==e.CONNECTING?e.send(t,i):e.once("open",(function(){h._write(t,s,i)}))},h.on("end",n),h.on("error",o),h}},7467:(e,t,s)=>{"use strict";const{tokenChars:i}=s(7908);e.exports={parse:function(e){const t=new Set;let s=-1,r=-1,n=0;for(;n<e.length;n++){const o=e.charCodeAt(n);if(-1===r&&1===i[o])-1===s&&(s=n);else if(0===n||32!==o&&9!==o){if(44!==o)throw new SyntaxError(`Unexpected character at index ${n}`);{if(-1===s)throw new SyntaxError(`Unexpected character at index ${n}`);-1===r&&(r=n);const i=e.slice(s,r);if(t.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);t.add(i),s=r=-1}}else-1===r&&-1!==s&&(r=n)}if(-1===s||-1!==r)throw new SyntaxError("Unexpected end of input");const o=e.slice(s,n);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},7908:(e,t,s)=>{"use strict";const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function r(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999}function n(e){const t=e.length;let s=0;for(;s<t;)if(0==(128&e[s]))s++;else if(192==(224&e[s])){if(s+1===t||128!=(192&e[s+1])||192==(254&e[s]))return!1;s+=2}else if(224==(240&e[s])){if(s+2>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||224===e[s]&&128==(224&e[s+1])||237===e[s]&&160==(224&e[s+1]))return!1;s+=3}else{if(240!=(248&e[s]))return!1;if(s+3>=t||128!=(192&e[s+1])||128!=(192&e[s+2])||128!=(192&e[s+3])||240===e[s]&&128==(240&e[s+1])||244===e[s]&&e[s+1]>143||e[s]>244)return!1;s+=4}return!0}try{const t=s(8403);e.exports={isValidStatusCode:r,isValidUTF8:e=>e.length<150?n(e):t(e),tokenChars:i}}catch(t){e.exports={isValidStatusCode:r,isValidUTF8:n,tokenChars:i}}},6087:(e,t,s)=>{"use strict";const i=s(2361),r=s(3685),{createHash:n}=(s(5687),s(1808),s(4404),s(6113)),o=s(9450),h=s(2106),a=s(7467),l=s(8955),{GUID:c,kWebSocket:u}=s(9336),d=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function p(){this.destroy()}function m(e,t,s,i){e.writable&&(s=s||r.STATUS_CODES[t],i={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(s),...i},e.write(`HTTP/1.1 ${t} ${r.STATUS_CODES[t]}\r\n`+Object.keys(i).map((e=>`${e}: ${i[e]}`)).join("\r\n")+"\r\n\r\n"+s)),e.removeListener("error",p),e.destroy()}e.exports=class extends i{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=r.createServer(((e,t)=>{const s=r.STATUS_CODES[426];t.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),t.end(s)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const s of Object.keys(t))e.on(s,t[s]);return function(){for(const s of Object.keys(t))e.removeListener(s,t[s])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,s,i)=>{this.handleUpgrade(t,s,i,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(f,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{f(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,s,i){t.on("error",p);const r=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"],n=+e.headers["sec-websocket-version"];if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!r||!d.test(r)||8!==n&&13!==n||!this.shouldHandle(e))return m(t,400);const l=e.headers["sec-websocket-protocol"];let c=new Set;if(void 0!==l)try{c=a.parse(l)}catch(e){return m(t,400)}const u=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==u){const e=new h(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=o.parse(u);t[h.extensionName]&&(e.accept(t[h.extensionName]),f[h.extensionName]=e)}catch(e){return m(t,400)}}if(this.options.verifyClient){const o={origin:e.headers[""+(8===n?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(o,((n,o,h,a)=>{if(!n)return m(t,o||401,h,a);this.completeUpgrade(f,r,c,e,t,s,i)}));if(!this.options.verifyClient(o))return m(t,401)}this.completeUpgrade(f,r,c,e,t,s,i)}completeUpgrade(e,t,s,i,r,a,l){if(!r.readable||!r.writable)return r.destroy();if(r[u])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return m(r,503);const d=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${n("sha1").update(t+c).digest("base64")}`],_=new this.options.WebSocket(null);if(s.size){const e=this.options.handleProtocols?this.options.handleProtocols(s,i):s.values().next().value;e&&(d.push(`Sec-WebSocket-Protocol: ${e}`),_._protocol=e)}if(e[h.extensionName]){const t=e[h.extensionName].params,s=o.format({[h.extensionName]:[t]});d.push(`Sec-WebSocket-Extensions: ${s}`),_._extensions=e}this.emit("headers",d,i),r.write(d.concat("\r\n").join("\r\n")),r.removeListener("error",p),_.setSocket(r,a,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(_),_.on("close",(()=>{this.clients.delete(_),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)}))),l(_,i)}}},8955:(e,t,s)=>{"use strict";const i=s(2361),r=s(5687),n=s(3685),o=s(1808),h=s(4404),{randomBytes:a,createHash:l}=s(6113),{Readable:c}=s(2781),{URL:u}=s(7310),d=s(2106),f=s(7728),p=s(4601),{BINARY_TYPES:m,EMPTY_BUFFER:_,GUID:y,kForOnEventAttribute:w,kListener:b,kStatusCode:g,kWebSocket:E,NOOP:S}=s(9336),{EventTarget:{addEventListener:v,removeEventListener:k}}=s(131),{format:R,parse:O}=s(9450),{toBuffer:x}=s(1737),T=["CONNECTING","OPEN","CLOSING","CLOSED"],L=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,C=[8,13];class N extends i{constructor(e,t,s){super(),this._binaryType=m[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=_,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=N.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(s=t,t=[]):t=[t]),I(this,e,t,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){const i=new f({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new p(e,this._extensions,s.generateMask),this._receiver=i,this._socket=e,i[E]=this,e[E]=this,i.on("conclude",F),i.on("drain",U),i.on("error",j),i.on("message",W),i.on("ping",G),i.on("pong",V),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",H),e.on("data",$),e.on("end",Z),e.on("error",Y),this._readyState=N.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=N.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=N.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==N.CLOSED){if(this.readyState===N.CONNECTING){const e="WebSocket was closed before the connection was established";return B(this,this._req,e)}this.readyState!==N.CLOSING?(this._readyState=N.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}}pause(){this.readyState!==N.CONNECTING&&this.readyState!==N.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===N.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||_,t,s)):M(this,e,s)}pong(e,t,s){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===N.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||_,t,s)):M(this,e,s)}resume(){this.readyState!==N.CONNECTING&&this.readyState!==N.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===N.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(s=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==N.OPEN)return void M(this,e,s);const i={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[d.extensionName]||(i.compress=!1),this._sender.send(e||_,i,s)}terminate(){if(this.readyState!==N.CLOSED){if(this.readyState===N.CONNECTING){const e="WebSocket was closed before the connection was established";return B(this,this._req,e)}this._socket&&(this._readyState=N.CLOSING,this._socket.destroy())}}}function I(e,t,s,i){const o={protocolVersion:C[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...i,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!C.includes(o.protocolVersion))throw new RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${C.join(", ")})`);let h;if(t instanceof u)h=t,e._url=t.href;else{try{h=new u(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const c="wss:"===h.protocol,f="ws+unix:"===h.protocol;let p;if("ws:"===h.protocol||c||f?f&&!h.pathname?p="The URL's pathname is empty":h.hash&&(p="The URL contains a fragment identifier"):p='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',p){const t=new SyntaxError(p);if(0===e._redirects)throw t;return void A(e,t)}const m=c?443:80,_=a(16).toString("base64"),w=c?r.get:n.get,b=new Set;let g;if(o.createConnection=c?P:D,o.defaultPort=o.defaultPort||m,o.port=h.port||m,o.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,o.headers={"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket",...o.headers},o.path=h.pathname+h.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(g=new d(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=R({[d.extensionName]:g.offer()})),s.length){for(const e of s){if("string"!=typeof e||!L.test(e)||b.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");b.add(e)}o.headers["Sec-WebSocket-Protocol"]=s.join(",")}if(o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(h.username||h.password)&&(o.auth=`${h.username}:${h.password}`),f){const e=o.path.split(":");o.socketPath=e[0],o.path=e[1]}if(o.followRedirects){if(0===e._redirects){e._originalHost=h.host;const t=i&&i.headers;if(i={...i,headers:{}},t)for(const[e,s]of Object.entries(t))i.headers[e.toLowerCase()]=s}else h.host!==e._originalHost&&(delete o.headers.authorization,delete o.headers.cookie,delete o.headers.host,o.auth=void 0);o.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64"))}let E=e._req=w(o);o.timeout&&E.on("timeout",(()=>{B(e,E,"Opening handshake has timed out")})),E.on("error",(t=>{null===E||E.aborted||(E=e._req=null,A(e,t))})),E.on("response",(r=>{const n=r.headers.location,h=r.statusCode;if(n&&o.followRedirects&&h>=300&&h<400){if(++e._redirects>o.maxRedirects)return void B(e,E,"Maximum redirects exceeded");let r;E.abort();try{r=new u(n,t)}catch(t){const s=new SyntaxError(`Invalid URL: ${n}`);return void A(e,s)}I(e,r,s,i)}else e.emit("unexpected-response",E,r)||B(e,E,`Unexpected server response: ${r.statusCode}`)})),E.on("upgrade",((t,s,i)=>{if(e.emit("upgrade",t),e.readyState!==N.CONNECTING)return;E=e._req=null;const r=l("sha1").update(_+y).digest("base64");if(t.headers["sec-websocket-accept"]!==r)return void B(e,s,"Invalid Sec-WebSocket-Accept header");const n=t.headers["sec-websocket-protocol"];let h;if(void 0!==n?b.size?b.has(n)||(h="Server sent an invalid subprotocol"):h="Server sent a subprotocol but none was requested":b.size&&(h="Server sent no subprotocol"),h)return void B(e,s,h);n&&(e._protocol=n);const a=t.headers["sec-websocket-extensions"];if(void 0!==a){if(!g){return void B(e,s,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=O(a)}catch(t){return void B(e,s,"Invalid Sec-WebSocket-Extensions header")}const i=Object.keys(t);if(1!==i.length||i[0]!==d.extensionName){return void B(e,s,"Server indicated an extension that was not requested")}try{g.accept(t[d.extensionName])}catch(t){return void B(e,s,"Invalid Sec-WebSocket-Extensions header")}e._extensions[d.extensionName]=g}e.setSocket(s,i,{generateMask:o.generateMask,maxPayload:o.maxPayload,skipUTF8Validation:o.skipUTF8Validation})}))}function A(e,t){e._readyState=N.CLOSING,e.emit("error",t),e.emitClose()}function D(e){return e.path=e.socketPath,o.connect(e)}function P(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),h.connect(e)}function B(e,t,s){e._readyState=N.CLOSING;const i=new Error(s);Error.captureStackTrace(i,B),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",e.emitClose.bind(e)),e.emit("error",i)):(t.destroy(i),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function M(e,t,s){if(t){const s=x(t).length;e._socket?e._sender._bufferedBytes+=s:e._bufferedAmount+=s}if(s){s(new Error(`WebSocket is not open: readyState ${e.readyState} (${T[e.readyState]})`))}}function F(e,t){const s=this[E];s._closeFrameReceived=!0,s._closeMessage=t,s._closeCode=e,void 0!==s._socket[E]&&(s._socket.removeListener("data",$),process.nextTick(q,s._socket),1005===e?s.close():s.close(e,t))}function U(){const e=this[E];e.isPaused||e._socket.resume()}function j(e){const t=this[E];void 0!==t._socket[E]&&(t._socket.removeListener("data",$),process.nextTick(q,t._socket),t.close(e[g])),t.emit("error",e)}function z(){this[E].emitClose()}function W(e,t){this[E].emit("message",e,t)}function G(e){const t=this[E];t.pong(e,!t._isServer,S),t.emit("ping",e)}function V(e){this[E].emit("pong",e)}function q(e){e.resume()}function H(){const e=this[E];let t;this.removeListener("close",H),this.removeListener("data",$),this.removeListener("end",Z),e._readyState=N.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[E]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",z),e._receiver.on("finish",z))}function $(e){this[E]._receiver.write(e)||this.pause()}function Z(){const e=this[E];e._readyState=N.CLOSING,e._receiver.end(),this.end()}function Y(){const e=this[E];this.removeListener("error",Y),this.on("error",S),e&&(e._readyState=N.CLOSING,this.destroy())}Object.defineProperty(N,"CONNECTING",{enumerable:!0,value:T.indexOf("CONNECTING")}),Object.defineProperty(N.prototype,"CONNECTING",{enumerable:!0,value:T.indexOf("CONNECTING")}),Object.defineProperty(N,"OPEN",{enumerable:!0,value:T.indexOf("OPEN")}),Object.defineProperty(N.prototype,"OPEN",{enumerable:!0,value:T.indexOf("OPEN")}),Object.defineProperty(N,"CLOSING",{enumerable:!0,value:T.indexOf("CLOSING")}),Object.defineProperty(N.prototype,"CLOSING",{enumerable:!0,value:T.indexOf("CLOSING")}),Object.defineProperty(N,"CLOSED",{enumerable:!0,value:T.indexOf("CLOSED")}),Object.defineProperty(N.prototype,"CLOSED",{enumerable:!0,value:T.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(N.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(N.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[w])return t[b];return null},set(t){for(const t of this.listeners(e))if(t[w]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[w]:!0})}})})),N.prototype.addEventListener=v,N.prototype.removeEventListener=k,e.exports=N},1678:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},1123:(e,t,s)=>{"use strict";function i(e){var t=this;if(t instanceof i||(t=new i),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var s=0,r=arguments.length;s<r;s++)t.push(arguments[s]);return t}function r(e,t,s){var i=t===e.head?new h(s,null,t,e):new h(s,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function n(e,t){e.tail=new h(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new h(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function h(e,t,s,i){if(!(this instanceof h))return new h(e,t,s,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,s?(s.prev=this,this.next=s):this.next=null}e.exports=i,i.Node=h,i.create=i,i.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,s=e.prev;return t&&(t.prev=s),s&&(s.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=s),e.list.length--,e.next=null,e.prev=null,e.list=null,t},i.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},i.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},i.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},i.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},i.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},i.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},i.prototype.forEach=function(e,t){t=t||this;for(var s=this.head,i=0;null!==s;i++)e.call(t,s.value,i,this),s=s.next},i.prototype.forEachReverse=function(e,t){t=t||this;for(var s=this.tail,i=this.length-1;null!==s;i--)e.call(t,s.value,i,this),s=s.prev},i.prototype.get=function(e){for(var t=0,s=this.head;null!==s&&t<e;t++)s=s.next;if(t===e&&null!==s)return s.value},i.prototype.getReverse=function(e){for(var t=0,s=this.tail;null!==s&&t<e;t++)s=s.prev;if(t===e&&null!==s)return s.value},i.prototype.map=function(e,t){t=t||this;for(var s=new i,r=this.head;null!==r;)s.push(e.call(t,r.value,this)),r=r.next;return s},i.prototype.mapReverse=function(e,t){t=t||this;for(var s=new i,r=this.tail;null!==r;)s.push(e.call(t,r.value,this)),r=r.prev;return s},i.prototype.reduce=function(e,t){var s,i=this.head;if(arguments.length>1)s=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,s=this.head.value}for(var r=0;null!==i;r++)s=e(s,i.value,r),i=i.next;return s},i.prototype.reduceReverse=function(e,t){var s,i=this.tail;if(arguments.length>1)s=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,s=this.tail.value}for(var r=this.length-1;null!==i;r--)s=e(s,i.value,r),i=i.prev;return s},i.prototype.toArray=function(){for(var e=new Array(this.length),t=0,s=this.head;null!==s;t++)e[t]=s.value,s=s.next;return e},i.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,s=this.tail;null!==s;t++)e[t]=s.value,s=s.prev;return e},i.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var s=new i;if(t<e||t<0)return s;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,n=this.head;null!==n&&r<e;r++)n=n.next;for(;null!==n&&r<t;r++,n=n.next)s.push(n.value);return s},i.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var s=new i;if(t<e||t<0)return s;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,n=this.tail;null!==n&&r>t;r--)n=n.prev;for(;null!==n&&r>e;r--,n=n.prev)s.push(n.value);return s},i.prototype.splice=function(e,t,...s){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,n=this.head;null!==n&&i<e;i++)n=n.next;var o=[];for(i=0;n&&i<t;i++)o.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(i=0;i<s.length;i++)n=r(this,n,s[i]);return o},i.prototype.reverse=function(){for(var e=this.head,t=this.tail,s=e;null!==s;s=s.prev){var i=s.prev;s.prev=s.next,s.next=i}return this.head=t,this.tail=e,this};try{s(1678)(i)}catch(e){}},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=require("process");var t=s.n(e),i=s(1017),r=s.n(i),n=s(7147),o=s.n(n);const h=require("electron");var a=s.n(h);const l=require("child_process");var c=s.n(l);function u(e){let s=new URL(e);if("http:"!==s.protocol&&"https:"!==s.protocol)return!1;if(!s.hostname)return!1;if(s.port&&Number.isNaN(s.port))return!1;let i=s.protocol+"//"+s.hostname;return s.port&&(i+=":"+s.port),s.pathname&&(i+=s.pathname),s.search&&(i+=s.search),s.hash&&(i+=s.hash),"linux"===t().platform?c().execFile("xdg-open",[i],(e=>{e&&a().shell.openExternal(i)})):a().shell.openExternal(i),!0}s(3419),s(7728),s(4601);var d=s(8955);s(6087);const f=d;var p=s(3685),m=s.n(p),_=s(5687),y=s.n(_);class w extends Error{constructor(e,t,s,i){if(super(),i)for(let e in i)s+=" "+e+"="+i[e];t&&(s+="\n"+t),this.name=e,this.message=s,t&&(this.stack=t.stack)}}class b extends w{constructor(e,t,s){super("ReadError",e,t,s)}}class g extends w{constructor(e,t,s){super("WriteError",e,t,s)}}class E extends w{constructor(e,t,s){super("RequestError",e,t,s)}}function S(e,t){let s=new Date;t="["+s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" "+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds()+"]["+e+"] "+t+"\n",console.error(t);let i=r().join(a().app.getPath("userData"),"pritunl.log");o().appendFile(i,t,(e=>{e&&(e=new g(e,"Logger: Failed to write log"),console.error(e))}))}function v(e){S("ERROR",e)}class k{constructor(e){this.response=e,this.status=e.statusCode,this.message=e.statusMessage}get(e){if(this.headers)return this.headers.get(e);let t=null,s=new Map;for(let e of this.response.rawHeaders)t?(s.set(t,e),t=null):t=e;return this.headers=s,this.headers.get(e)}json(){return JSON.parse(this.data||null)}jsonPassive(){try{return JSON.parse(this.data||null)}catch(e){return null}}string(){return this.data}}class R{constructor(){this.headers=new Map}tcp(e){let t=e.split("://");return this.ssl="https"===t[0],t=t[1].split(":"),t.length>1?this.port=parseInt(t.pop(),10):this.port=80,this.hostname=t.join(":"),this}unix(e){return this.socketPath=e,this}timeout(e){this.ttl=1e3*e}get(e){return this.method="GET",this.path=e,this}put(e){return this.method="PUT",this.path=e,this}post(e){return this.method="POST",this.path=e,this}delete(e){return this.method="DELETE",this.path=e,this}set(e,t){return this.headers.set(e,t),this}send(e){return"string"==typeof e?this.data=e:(this.headers.set("Content-Type","application/json"),this.data=JSON.stringify(e)),this}end(){return new Promise(((e,t)=>{try{let s={path:this.path,method:this.method,headers:Object.fromEntries(this.headers)};this.socketPath?s.socketPath=this.socketPath:(s.hostname=this.hostname,s.port=this.port),s.timeout=this.ttl||2e4;let i,r=t=>{let s=new k(t);t.on("data",(e=>{e&&(s.data=e.toString())})),t.on("end",(()=>{e(s)}))};i=this.ssl?y().request(s,r):m().request(s,r),i.on("timeout",(()=>{let e=new E(null,"Request: Timeout error");i.destroy(e),v(e.message),t(e)})),i.on("error",(e=>{v((e=new E(e,"Request: HTTP error")).message),t(e)})),this.data&&i.write(this.data),i.end()}catch(e){v((e=new E(e,"Request: Exception")).message),t(e)}}))}}class O extends Error{constructor(e,t,s,i){if(super(),i)for(let e in i)" "+e+"="+i[e];t&&"\n"+t,this.name=e,this.message=s,t&&(this.stack=t.stack)}}s(9610);let x=!1;const T="/var/run/pritunl.sock",L="http://127.0.0.1:9770",C="ws+unix://"+r().join(r().sep,"var","run","pritunl.sock")+":";let N,I=!1,A=[],D="C:\\",P=t().env.SYSTEMDRIVE;function B(){return new Promise(((e,s)=>{o().readFile(-1!==t().argv.indexOf("--dev")?r().join(__dirname,"..","..","dev","auth"):"win32"===t().platform?r().join(D,"ProgramData","Pritunl","auth"):r().join(r().sep,"var","run","pritunl.auth"),"utf-8",((t,s)=>{e(s?s.trim():"")}))}))}P&&(D=P+"\\"),"linux"!==t().platform&&"darwin"!==t().platform||(x=!0);let M=0,F=0,U=!1,j="";function z(e){let t=(+new Date+Math.floor(999999*Math.random())).toString(36);return j=t,new Promise((async(s,i)=>{let r;try{r=await B()}catch(e){r=""}if(!r)return void(M>10?U||(U=!0,a().dialog.showMessageBox(null,{type:"error",buttons:["Retry","Exit"],title:"Pritunl - Service Error (6729",message:"Unable to authenticate communication with background service, try restarting computer"}).then((function(t){0==t.response?(M=0,F=0,U=!1,z(e)):a().app.quit()}))):(M+=1,setTimeout((()=>{z(e)}),500)));s();let n=!1,o="",h={"User-Agent":"pritunl","Auth-Token":r};x?(o=C,h.Host="unix"):o="ws://127.0.0.1:9770";let l=()=>{setTimeout((()=>{n||(n=!0,F>10?U||(U=!0,a().dialog.showMessageBox(null,{type:"error",buttons:["Retry","Exit"],title:"Pritunl - Service Error (8362)",message:"Unable to establish communication with background service, try restarting computer"}).then((function(t){0==t.response?(M=0,F=0,U=!1,z(e)):a().app.quit()}))):F+=1,z(e))}),1e3)};N=new f(o+"/events",{headers:h}),N.on("open",(()=>{t===j&&(F=0,I&&(I=!1,console.log("Events: Service reconnected")))})),N.on("error",(e=>{t===j&&(console.error("Events: Socket error "+e),I=!0,l())})),N.on("onerror",(e=>{t===j&&(console.error("Events: Socket error "+e),I=!0,l())})),N.on("close",(()=>{t===j&&(I=!0,l())})),N.on("message",(e=>{if(t!==j)return;let s=JSON.parse(e.toString());for(let e of A)e(s)}))}))}const W=new class{constructor(){this.window_width=0,this.window_height=0,this.disable_tray_icon=!1,this.classic_interface=!1,this.frameless=null,this.theme="dark"}_load(e){void 0!==e.disable_tray_icon&&(this.disable_tray_icon=e.disable_tray_icon),void 0!==e.classic_interface&&(this.classic_interface=e.classic_interface),void 0!==e.theme&&(this.theme=e.theme),void 0!==e.window_width&&(this.window_width=e.window_width),void 0!==e.window_height&&(this.window_height=e.window_height),void 0!==e.frameless&&(this.frameless=e.frameless)}path(){return r().join(a().app.getPath("userData"),"pritunl.json")}load(){return new Promise((e=>{o().readFile(this.path(),"utf-8",((t,s)=>{if(t)return"ENOENT"!==t.code&&v((t=new b(t,"Config: Read error")).message),void e();let i={};if(s)try{i=JSON.parse(s)}catch(t){v((t=new b(t,"Config: Parse error")).message),i={}}this._load(i),e()}))}))}save(e){let t={disable_tray_icon:e.disable_tray_icon,classic_interface:e.classic_interface,window_width:e.window_width,window_height:e.window_height,frameless:e.frameless,theme:e.theme};return new Promise(((e,s)=>{this.load().then((()=>{void 0===t.disable_tray_icon&&(t.disable_tray_icon=this.disable_tray_icon),void 0===t.classic_interface&&(t.classic_interface=this.classic_interface),void 0===t.window_width&&(t.window_width=this.window_width),void 0===t.theme&&(t.theme=this.theme),void 0===t.frameless&&(t.frameless=this.frameless),this._load(t),o().writeFile(this.path(),JSON.stringify(t),(t=>{t&&v((t=new b(t,"Config: Write error")).message),e()}))}))}))}};let G,V,q,H,$,Z;a().app.dock&&a().app.dock.hide(),t().on("uncaughtException",(function(e){let t;t=e&&e.stack?e.stack:String(e),q?a().dialog.showMessageBox(null,{type:"error",buttons:["Exit"],title:"Pritunl Client - Process Error",message:"Error occured in main process:\n\n"+t}).then((function(){a().app.quit()})):H=t})),t().on("unhandledRejection",(function(e){let t=String(e);q?a().dialog.showMessageBox(null,{type:"error",buttons:["Exit"],title:"Pritunl Client - Process Error",message:"Error occured in main process:\n\n"+t}).then((function(){a().app.quit()})):H=t})),new Promise((async e=>{let t;try{t=await B()}catch(t){return v(t.message||t),void e(!1)}let s=new R;x?s.unix(T):s.tcp(L),s.post("/wakeup").set("Auth-Token",t).set("User-Agent","pritunl").end().then((t=>{200===t.status&&e(!0),e(!1)}),(t=>{v(t.message),e(!1)}))})).then((e=>{V=e,q&&K()}));class Y{showWindow(){this.window.show()}createWindow(){let e,s=!1,i=!1,n=424,o=528,h=405,l=440,c=670,d=800,f=W.classic_interface;("win32"===t().platform&&!f||W.frameless&&!f)&&(s=!0,i=!0,n=430,h=430,"win32"===t().platform&&(s=!1,e="hidden")),W.window_width&&W.window_height&&(n=W.window_width,n<h&&(n=h),o=W.window_height,o<l&&(o=l));let p=1;"darwin"===t().platform&&f&&(p=.8),1!==p&&(n=Math.round(n*p),o=Math.round(o*p),h=Math.round(h*p),l=Math.round(l*p),c=Math.round(c*p),d=Math.round(d*p)),this.window=new(a().BrowserWindow)({title:"Pritunl Client",icon:r().join(__dirname,"..","logo.png"),titleBarStyle:e,frame:!s,autoHideMenuBar:!0,fullscreen:!1,show:!1,width:n,height:o,minWidth:h,minHeight:l,maxWidth:c,maxHeight:d,backgroundColor:"#151719",webPreferences:{zoomFactor:p,devTools:!0,nodeIntegration:!0,contextIsolation:!1}}),a().ipcMain.on("control",((e,t,s)=>{"service-auth-error"===t?a().dialog.showMessageBox(null,{type:"error",buttons:["Exit"],title:"Pritunl - Service Error (4827)",message:"Failed to load service key. Restart computer and verify background service is running"}).then((function(){a().app.quit()})):"service-conn-error"===t?a().dialog.showMessageBox(null,{type:"error",buttons:["Exit"],title:"Pritunl - Service Error (2754)",message:"Unable to establish communication with background service, try restarting computer"}).then((function(){a().app.quit()})):"dev-tools"===t?this.window.webContents.openDevTools({mode:"undocked"}):"reload"===t?this.window.reload():"minimize"===t?this.window.minimize():"download-update"===t&&u("https://client.pritunl.com/#install")})),this.window.on("close",(()=>{try{Z=this.window.getSize()}catch(e){}})),this.window.on("closed",(async()=>{a().ipcMain.removeAllListeners("control"),$=null}));let m=!1;this.window.on("ready-to-show",(()=>{m||(m=!0,this.window.show(),-1!==t().argv.indexOf("--dev-tools")&&this.window.webContents.openDevTools({mode:"undocked"}))})),setTimeout((()=>{m||(m=!0,this.window.show(),-1!==t().argv.indexOf("--dev-tools")&&this.window.webContents.openDevTools({mode:"undocked"}))}),800);let _="";_=f?"file://"+r().join(__dirname,"..","index_orig.html"):"file://"+r().join(__dirname,"..","index.html"),_+="?dev="+(-1!==t().argv.indexOf("--dev")?"true":"false"),_+="&dataPath="+encodeURIComponent(a().app.getPath("userData")),_+="&frameless="+(i?"true":"false"),this.window.loadURL(_,{userAgent:"pritunl"}),a().app.dock&&a().app.dock.show()}run(){$?$.showWindow():(this.createWindow(),$=this)}}function X(){G=new(a().Tray)(J(!1)),G.on("click",(function(){(new Y).run()})),G.on("double-click",(function(){(new Y).run()}));let e=a().Menu.buildFromTemplate([{label:"Open Pritunl Client",click:function(){(new Y).run()}},{label:"Exit",click:function(){a().app.quit()}}]);G.setToolTip("Pritunl Client"),G.setContextMenu(e),new Promise((async e=>{let t;try{t=await B()}catch(t){return v(t.message||t),void e(!1)}let s=new R;x?s.unix(T):s.tcp(L),s.get("/status").set("Auth-Token",t).set("User-Agent","pritunl").end().then((t=>{if(200===t.status){let s=t.jsonPassive();e(!!s&&s.status)}e(!1)}),(t=>{v(t.message),e(!1)}))})).then((e=>{G.setImage(J(e))}))}function K(){void 0!==V&&(V?a().app.quit():W.load().then((()=>{z(-1!==t().argv.indexOf("--dev")).then((()=>{if(-1!==t().argv.indexOf("--no-main")){if(W.disable_tray_icon)return void a().app.quit()}else{(new Y).run()}var e;!function(){let e=a().Menu.buildFromTemplate([{label:"Pritunl",submenu:[{label:"Pritunl Client"},{label:"Close",accelerator:"CmdOrCtrl+Q",role:"close"},{label:"Exit",click:function(){a().app.quit()}}]},{label:"Edit",submenu:[{label:"Undo",accelerator:"CmdOrCtrl+Z",role:"undo"},{label:"Redo",accelerator:"Shift+CmdOrCtrl+Z",role:"redo"},{type:"separator"},{label:"Cut",accelerator:"CmdOrCtrl+X",role:"cut"},{label:"Copy",accelerator:"CmdOrCtrl+C",role:"copy"},{label:"Paste",accelerator:"CmdOrCtrl+V",role:"paste"},{label:"Select All",accelerator:"CmdOrCtrl+A",role:"selectall"}]}]);a().Menu.setApplicationMenu(e)}(),W.disable_tray_icon||X(),e=e=>{var t;"connected"===e.type?G&&G.setImage(J(!0)):"disconnected"===e.type?G&&G.setImage(J(!1)):"wakeup"===e.type?(t="awake",N&&N.send(t),(new Y).run()):"sso_auth"===e.type&&u(e.data.url)},A.push(e)}))})))}function J(e){let s="",i="";return"darwin"===t().platform?(s=r().join(__dirname,"..","img","tray_connected_osxTemplate.png"),i=r().join(__dirname,"..","img","tray_disconnected_osxTemplate.png")):"win32"===t().platform?(s=r().join(__dirname,"..","img","tray_connected_win.png"),i=r().join(__dirname,"..","img","tray_disconnected_win.png")):"linux"===t().platform?(s=r().join(__dirname,"..","img","tray_connected_linux_light.png"),i=r().join(__dirname,"..","img","tray_disconnected_linux_light.png")):(s=r().join(__dirname,"..","img","tray_connected.png"),i=r().join(__dirname,"..","img","tray_disconnected.png")),e?s:i}a().app.on("window-all-closed",(()=>{try{W.load().then((async()=>{Z&&2==Z.length&&(W.window_width=Z[0],W.window_height=Z[1],await W.save({window_width:W.window_width,window_height:W.window_height})),W.disable_tray_icon||!G?a().app.quit():a().app.dock&&a().app.dock.hide()}))}catch(e){throw e}})),a().app.on("open-file",(()=>{try{(new Y).run()}catch(e){throw e}})),a().app.on("open-url",(()=>{try{(new Y).run()}catch(e){throw e}})),a().app.on("activate",(()=>{try{(new Y).run()}catch(e){throw e}})),a().app.on("quit",(()=>{try{a().app.quit()}catch(e){throw e}})),a().app.on("ready",(()=>{let e=r().join(a().app.getPath("userData"),"profiles");o().exists(e,(function(t){t||o().mkdir(e,(function(){}))}));try{if(H)return void a().dialog.showMessageBox(null,{type:"error",buttons:["Exit"],title:"Pritunl Client - Process Error",message:"Error occured in main process:\n\n"+H}).then((function(){a().app.quit()}));q=!0,K()}catch(e){throw e}}))})()})();
//# sourceMappingURL=main.js.map
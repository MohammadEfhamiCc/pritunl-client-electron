{"version":3,"file":"main.js","mappings":"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","sources":["webpack://pritunl/./node_modules/@electron/remote/dist/src/common/get-electron-binding.js","webpack://pritunl/./node_modules/@electron/remote/dist/src/common/type-utils.js","webpack://pritunl/./node_modules/@electron/remote/dist/src/main/index.js","webpack://pritunl/./node_modules/@electron/remote/dist/src/main/objects-registry.js","webpack://pritunl/./node_modules/@electron/remote/dist/src/main/server.js","webpack://pritunl/./node_modules/@electron/remote/main/index.js","webpack://pritunl/./node_modules/bufferutil/fallback.js","webpack://pritunl/./node_modules/bufferutil/index.js","webpack://pritunl/./node_modules/node-gyp-build/index.js","webpack://pritunl/./node_modules/utf-8-validate/fallback.js","webpack://pritunl/./node_modules/utf-8-validate/index.js","webpack://pritunl/./node_modules/ws/lib/buffer-util.js","webpack://pritunl/./node_modules/ws/lib/constants.js","webpack://pritunl/./node_modules/ws/lib/event-target.js","webpack://pritunl/./node_modules/ws/lib/extension.js","webpack://pritunl/./node_modules/ws/lib/limiter.js","webpack://pritunl/./node_modules/ws/lib/permessage-deflate.js","webpack://pritunl/./node_modules/ws/lib/receiver.js","webpack://pritunl/./node_modules/ws/lib/sender.js","webpack://pritunl/./node_modules/ws/lib/stream.js","webpack://pritunl/./node_modules/ws/lib/subprotocol.js","webpack://pritunl/./node_modules/ws/lib/validation.js","webpack://pritunl/./node_modules/ws/lib/websocket-server.js","webpack://pritunl/./node_modules/ws/lib/websocket.js","webpack://pritunl/external node-commonjs \"crypto\"","webpack://pritunl/external node-commonjs \"electron\"","webpack://pritunl/external node-commonjs \"events\"","webpack://pritunl/external node-commonjs \"fs\"","webpack://pritunl/external node-commonjs \"http\"","webpack://pritunl/external node-commonjs \"https\"","webpack://pritunl/external node-commonjs \"net\"","webpack://pritunl/external node-commonjs \"os\"","webpack://pritunl/external node-commonjs \"path\"","webpack://pritunl/external node-commonjs \"stream\"","webpack://pritunl/external node-commonjs \"tls\"","webpack://pritunl/external node-commonjs \"url\"","webpack://pritunl/external node-commonjs \"zlib\"","webpack://pritunl/webpack/bootstrap","webpack://pritunl/webpack/runtime/compat get default export","webpack://pritunl/webpack/runtime/define property getters","webpack://pritunl/webpack/runtime/hasOwnProperty shorthand","webpack://pritunl/external node-commonjs \"process\"","webpack://pritunl/./node_modules/ws/wrapper.mjs","webpack://pritunl/./main/Errors.ts","webpack://pritunl/./main/Logger.ts","webpack://pritunl/./main/Request.ts","webpack://pritunl/./main/Service.ts","webpack://pritunl/./main/Config.ts","webpack://pritunl/./main/Main.tsx"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getElectronBinding = void 0;\nconst getElectronBinding = (name) => {\n    if (process._linkedBinding) {\n        return process._linkedBinding('electron_common_' + name);\n    }\n    else if (process.electronBinding) {\n        return process.electronBinding(name);\n    }\n    else {\n        return null;\n    }\n};\nexports.getElectronBinding = getElectronBinding;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.deserialize = exports.serialize = exports.isSerializableObject = exports.isPromise = void 0;\nconst electron_1 = require(\"electron\");\nfunction isPromise(val) {\n    return (val &&\n        val.then &&\n        val.then instanceof Function &&\n        val.constructor &&\n        val.constructor.reject &&\n        val.constructor.reject instanceof Function &&\n        val.constructor.resolve &&\n        val.constructor.resolve instanceof Function);\n}\nexports.isPromise = isPromise;\nconst serializableTypes = [\n    Boolean,\n    Number,\n    String,\n    Date,\n    Error,\n    RegExp,\n    ArrayBuffer\n];\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm#Supported_types\nfunction isSerializableObject(value) {\n    return value === null || ArrayBuffer.isView(value) || serializableTypes.some(type => value instanceof type);\n}\nexports.isSerializableObject = isSerializableObject;\nconst objectMap = function (source, mapper) {\n    const sourceEntries = Object.entries(source);\n    const targetEntries = sourceEntries.map(([key, val]) => [key, mapper(val)]);\n    return Object.fromEntries(targetEntries);\n};\nfunction serializeNativeImage(image) {\n    const representations = [];\n    const scaleFactors = image.getScaleFactors();\n    // Use Buffer when there's only one representation for better perf.\n    // This avoids compressing to/from PNG where it's not necessary to\n    // ensure uniqueness of dataURLs (since there's only one).\n    if (scaleFactors.length === 1) {\n        const scaleFactor = scaleFactors[0];\n        const size = image.getSize(scaleFactor);\n        const buffer = image.toBitmap({ scaleFactor });\n        representations.push({ scaleFactor, size, buffer });\n    }\n    else {\n        // Construct from dataURLs to ensure that they are not lost in creation.\n        for (const scaleFactor of scaleFactors) {\n            const size = image.getSize(scaleFactor);\n            const dataURL = image.toDataURL({ scaleFactor });\n            representations.push({ scaleFactor, size, dataURL });\n        }\n    }\n    return { __ELECTRON_SERIALIZED_NativeImage__: true, representations };\n}\nfunction deserializeNativeImage(value) {\n    const image = electron_1.nativeImage.createEmpty();\n    // Use Buffer when there's only one representation for better perf.\n    // This avoids compressing to/from PNG where it's not necessary to\n    // ensure uniqueness of dataURLs (since there's only one).\n    if (value.representations.length === 1) {\n        const { buffer, size, scaleFactor } = value.representations[0];\n        const { width, height } = size;\n        image.addRepresentation({ buffer, scaleFactor, width, height });\n    }\n    else {\n        // Construct from dataURLs to ensure that they are not lost in creation.\n        for (const rep of value.representations) {\n            const { dataURL, size, scaleFactor } = rep;\n            const { width, height } = size;\n            image.addRepresentation({ dataURL, scaleFactor, width, height });\n        }\n    }\n    return image;\n}\nfunction serialize(value) {\n    if (value && value.constructor && value.constructor.name === 'NativeImage') {\n        return serializeNativeImage(value);\n    }\n    if (Array.isArray(value)) {\n        return value.map(serialize);\n    }\n    else if (isSerializableObject(value)) {\n        return value;\n    }\n    else if (value instanceof Object) {\n        return objectMap(value, serialize);\n    }\n    else {\n        return value;\n    }\n}\nexports.serialize = serialize;\nfunction deserialize(value) {\n    if (value && value.__ELECTRON_SERIALIZED_NativeImage__) {\n        return deserializeNativeImage(value);\n    }\n    else if (Array.isArray(value)) {\n        return value.map(deserialize);\n    }\n    else if (isSerializableObject(value)) {\n        return value;\n    }\n    else if (value instanceof Object) {\n        return objectMap(value, deserialize);\n    }\n    else {\n        return value;\n    }\n}\nexports.deserialize = deserialize;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initialize = void 0;\nvar server_1 = require(\"./server\");\nObject.defineProperty(exports, \"initialize\", { enumerable: true, get: function () { return server_1.initialize; } });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst getOwnerKey = (webContents, contextId) => {\n    return `${webContents.id}-${contextId}`;\n};\nclass ObjectsRegistry {\n    constructor() {\n        this.nextId = 0;\n        // Stores all objects by ref-counting.\n        // (id) => {object, count}\n        this.storage = {};\n        // Stores the IDs + refCounts of objects referenced by WebContents.\n        // (ownerKey) => { id: refCount }\n        this.owners = {};\n        this.electronIds = new WeakMap();\n    }\n    // Register a new object and return its assigned ID. If the object is already\n    // registered then the already assigned ID would be returned.\n    add(webContents, contextId, obj) {\n        // Get or assign an ID to the object.\n        const id = this.saveToStorage(obj);\n        // Add object to the set of referenced objects.\n        const ownerKey = getOwnerKey(webContents, contextId);\n        let owner = this.owners[ownerKey];\n        if (!owner) {\n            owner = this.owners[ownerKey] = new Map();\n            this.registerDeleteListener(webContents, contextId);\n        }\n        if (!owner.has(id)) {\n            owner.set(id, 0);\n            // Increase reference count if not referenced before.\n            this.storage[id].count++;\n        }\n        owner.set(id, owner.get(id) + 1);\n        return id;\n    }\n    // Get an object according to its ID.\n    get(id) {\n        const pointer = this.storage[id];\n        if (pointer != null)\n            return pointer.object;\n    }\n    // Dereference an object according to its ID.\n    // Note that an object may be double-freed (cleared when page is reloaded, and\n    // then garbage collected in old page).\n    remove(webContents, contextId, id) {\n        const ownerKey = getOwnerKey(webContents, contextId);\n        const owner = this.owners[ownerKey];\n        if (owner && owner.has(id)) {\n            const newRefCount = owner.get(id) - 1;\n            // Only completely remove if the number of references GCed in the\n            // renderer is the same as the number of references we sent them\n            if (newRefCount <= 0) {\n                // Remove the reference in owner.\n                owner.delete(id);\n                // Dereference from the storage.\n                this.dereference(id);\n            }\n            else {\n                owner.set(id, newRefCount);\n            }\n        }\n    }\n    // Clear all references to objects refrenced by the WebContents.\n    clear(webContents, contextId) {\n        const ownerKey = getOwnerKey(webContents, contextId);\n        const owner = this.owners[ownerKey];\n        if (!owner)\n            return;\n        for (const id of owner.keys())\n            this.dereference(id);\n        delete this.owners[ownerKey];\n    }\n    // Saves the object into storage and assigns an ID for it.\n    saveToStorage(object) {\n        let id = this.electronIds.get(object);\n        if (!id) {\n            id = ++this.nextId;\n            this.storage[id] = {\n                count: 0,\n                object: object\n            };\n            this.electronIds.set(object, id);\n        }\n        return id;\n    }\n    // Dereference the object from store.\n    dereference(id) {\n        const pointer = this.storage[id];\n        if (pointer == null) {\n            return;\n        }\n        pointer.count -= 1;\n        if (pointer.count === 0) {\n            this.electronIds.delete(pointer.object);\n            delete this.storage[id];\n        }\n    }\n    // Clear the storage when renderer process is destroyed.\n    registerDeleteListener(webContents, contextId) {\n        // contextId => ${processHostId}-${contextCount}\n        const processHostId = contextId.split('-')[0];\n        const listener = (_, deletedProcessHostId) => {\n            if (deletedProcessHostId &&\n                deletedProcessHostId.toString() === processHostId) {\n                webContents.removeListener('render-view-deleted', listener);\n                this.clear(webContents, contextId);\n            }\n        };\n        // Note that the \"render-view-deleted\" event may not be emitted on time when\n        // the renderer process get destroyed because of navigation, we rely on the\n        // renderer process to send \"ELECTRON_BROWSER_CONTEXT_RELEASE\" message to\n        // guard this situation.\n        webContents.on('render-view-deleted', listener);\n    }\n}\nexports.default = new ObjectsRegistry();\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initialize = exports.isRemoteModuleEnabled = void 0;\nconst events_1 = require(\"events\");\nconst objects_registry_1 = __importDefault(require(\"./objects-registry\"));\nconst type_utils_1 = require(\"../common/type-utils\");\nconst electron_1 = require(\"electron\");\nconst get_electron_binding_1 = require(\"../common/get-electron-binding\");\nconst v8Util = get_electron_binding_1.getElectronBinding('v8_util');\n// The internal properties of Function.\nconst FUNCTION_PROPERTIES = [\n    'length', 'name', 'arguments', 'caller', 'prototype'\n];\n// The remote functions in renderer processes.\nconst rendererFunctionCache = new Map();\n// eslint-disable-next-line no-undef\nconst finalizationRegistry = new FinalizationRegistry((fi) => {\n    const mapKey = fi.id[0] + '~' + fi.id[1];\n    const ref = rendererFunctionCache.get(mapKey);\n    if (ref !== undefined && ref.deref() === undefined) {\n        rendererFunctionCache.delete(mapKey);\n        if (!fi.webContents.isDestroyed()) {\n            try {\n                fi.webContents.sendToFrame(fi.frameId, \"REMOTE_RENDERER_RELEASE_CALLBACK\" /* RENDERER_RELEASE_CALLBACK */, fi.id[0], fi.id[1]);\n            }\n            catch (error) {\n                console.warn(`sendToFrame() failed: ${error}`);\n            }\n        }\n    }\n});\nfunction getCachedRendererFunction(id) {\n    const mapKey = id[0] + '~' + id[1];\n    const ref = rendererFunctionCache.get(mapKey);\n    if (ref !== undefined) {\n        const deref = ref.deref();\n        if (deref !== undefined)\n            return deref;\n    }\n}\nfunction setCachedRendererFunction(id, wc, frameId, value) {\n    // eslint-disable-next-line no-undef\n    const wr = new WeakRef(value);\n    const mapKey = id[0] + '~' + id[1];\n    rendererFunctionCache.set(mapKey, wr);\n    finalizationRegistry.register(value, {\n        id,\n        webContents: wc,\n        frameId\n    });\n    return value;\n}\nconst locationInfo = new WeakMap();\n// Return the description of object's members:\nconst getObjectMembers = function (object) {\n    let names = Object.getOwnPropertyNames(object);\n    // For Function, we should not override following properties even though they\n    // are \"own\" properties.\n    if (typeof object === 'function') {\n        names = names.filter((name) => {\n            return !FUNCTION_PROPERTIES.includes(name);\n        });\n    }\n    // Map properties to descriptors.\n    return names.map((name) => {\n        const descriptor = Object.getOwnPropertyDescriptor(object, name);\n        let type;\n        let writable = false;\n        if (descriptor.get === undefined && typeof object[name] === 'function') {\n            type = 'method';\n        }\n        else {\n            if (descriptor.set || descriptor.writable)\n                writable = true;\n            type = 'get';\n        }\n        return { name, enumerable: descriptor.enumerable, writable, type };\n    });\n};\n// Return the description of object's prototype.\nconst getObjectPrototype = function (object) {\n    const proto = Object.getPrototypeOf(object);\n    if (proto === null || proto === Object.prototype)\n        return null;\n    return {\n        members: getObjectMembers(proto),\n        proto: getObjectPrototype(proto)\n    };\n};\n// Convert a real value into meta data.\nconst valueToMeta = function (sender, contextId, value, optimizeSimpleObject = false) {\n    // Determine the type of value.\n    let type;\n    switch (typeof value) {\n        case 'object':\n            // Recognize certain types of objects.\n            if (value instanceof Buffer) {\n                type = 'buffer';\n            }\n            else if (value && value.constructor && value.constructor.name === 'NativeImage') {\n                type = 'nativeimage';\n            }\n            else if (Array.isArray(value)) {\n                type = 'array';\n            }\n            else if (value instanceof Error) {\n                type = 'error';\n            }\n            else if (type_utils_1.isSerializableObject(value)) {\n                type = 'value';\n            }\n            else if (type_utils_1.isPromise(value)) {\n                type = 'promise';\n            }\n            else if (Object.prototype.hasOwnProperty.call(value, 'callee') && value.length != null) {\n                // Treat the arguments object as array.\n                type = 'array';\n            }\n            else if (optimizeSimpleObject && v8Util.getHiddenValue(value, 'simple')) {\n                // Treat simple objects as value.\n                type = 'value';\n            }\n            else {\n                type = 'object';\n            }\n            break;\n        case 'function':\n            type = 'function';\n            break;\n        default:\n            type = 'value';\n            break;\n    }\n    // Fill the meta object according to value's type.\n    if (type === 'array') {\n        return {\n            type,\n            members: value.map((el) => valueToMeta(sender, contextId, el, optimizeSimpleObject))\n        };\n    }\n    else if (type === 'nativeimage') {\n        return { type, value: type_utils_1.serialize(value) };\n    }\n    else if (type === 'object' || type === 'function') {\n        return {\n            type,\n            name: value.constructor ? value.constructor.name : '',\n            // Reference the original value if it's an object, because when it's\n            // passed to renderer we would assume the renderer keeps a reference of\n            // it.\n            id: objects_registry_1.default.add(sender, contextId, value),\n            members: getObjectMembers(value),\n            proto: getObjectPrototype(value)\n        };\n    }\n    else if (type === 'buffer') {\n        return { type, value };\n    }\n    else if (type === 'promise') {\n        // Add default handler to prevent unhandled rejections in main process\n        // Instead they should appear in the renderer process\n        value.then(function () { }, function () { });\n        return {\n            type,\n            then: valueToMeta(sender, contextId, function (onFulfilled, onRejected) {\n                value.then(onFulfilled, onRejected);\n            })\n        };\n    }\n    else if (type === 'error') {\n        return {\n            type,\n            value,\n            members: Object.keys(value).map(name => ({\n                name,\n                value: valueToMeta(sender, contextId, value[name])\n            }))\n        };\n    }\n    else {\n        return {\n            type: 'value',\n            value\n        };\n    }\n};\nconst throwRPCError = function (message) {\n    const error = new Error(message);\n    error.code = 'EBADRPC';\n    error.errno = -72;\n    throw error;\n};\nconst removeRemoteListenersAndLogWarning = (sender, callIntoRenderer) => {\n    const location = locationInfo.get(callIntoRenderer);\n    let message = 'Attempting to call a function in a renderer window that has been closed or released.' +\n        `\\nFunction provided here: ${location}`;\n    if (sender instanceof events_1.EventEmitter) {\n        const remoteEvents = sender.eventNames().filter((eventName) => {\n            return sender.listeners(eventName).includes(callIntoRenderer);\n        });\n        if (remoteEvents.length > 0) {\n            message += `\\nRemote event names: ${remoteEvents.join(', ')}`;\n            remoteEvents.forEach((eventName) => {\n                sender.removeListener(eventName, callIntoRenderer);\n            });\n        }\n    }\n    console.warn(message);\n};\nconst fakeConstructor = (constructor, name) => new Proxy(Object, {\n    get(target, prop, receiver) {\n        if (prop === 'name') {\n            return name;\n        }\n        else {\n            return Reflect.get(target, prop, receiver);\n        }\n    }\n});\n// Convert array of meta data from renderer into array of real values.\nconst unwrapArgs = function (sender, frameId, contextId, args) {\n    const metaToValue = function (meta) {\n        switch (meta.type) {\n            case 'nativeimage':\n                return type_utils_1.deserialize(meta.value);\n            case 'value':\n                return meta.value;\n            case 'remote-object':\n                return objects_registry_1.default.get(meta.id);\n            case 'array':\n                return unwrapArgs(sender, frameId, contextId, meta.value);\n            case 'buffer':\n                return Buffer.from(meta.value.buffer, meta.value.byteOffset, meta.value.byteLength);\n            case 'promise':\n                return Promise.resolve({\n                    then: metaToValue(meta.then)\n                });\n            case 'object': {\n                const ret = meta.name !== 'Object' ? Object.create({\n                    constructor: fakeConstructor(Object, meta.name)\n                }) : {};\n                for (const { name, value } of meta.members) {\n                    ret[name] = metaToValue(value);\n                }\n                return ret;\n            }\n            case 'function-with-return-value': {\n                const returnValue = metaToValue(meta.value);\n                return function () {\n                    return returnValue;\n                };\n            }\n            case 'function': {\n                // Merge contextId and meta.id, since meta.id can be the same in\n                // different webContents.\n                const objectId = [contextId, meta.id];\n                // Cache the callbacks in renderer.\n                const cachedFunction = getCachedRendererFunction(objectId);\n                if (cachedFunction !== undefined) {\n                    return cachedFunction;\n                }\n                const callIntoRenderer = function (...args) {\n                    let succeed = false;\n                    if (!sender.isDestroyed()) {\n                        try {\n                            succeed = sender.sendToFrame(frameId, \"REMOTE_RENDERER_CALLBACK\" /* RENDERER_CALLBACK */, contextId, meta.id, valueToMeta(sender, contextId, args)) !== false;\n                        }\n                        catch (error) {\n                            console.warn(`sendToFrame() failed: ${error}`);\n                        }\n                    }\n                    if (!succeed) {\n                        removeRemoteListenersAndLogWarning(this, callIntoRenderer);\n                    }\n                };\n                locationInfo.set(callIntoRenderer, meta.location);\n                Object.defineProperty(callIntoRenderer, 'length', { value: meta.length });\n                setCachedRendererFunction(objectId, sender, frameId, callIntoRenderer);\n                return callIntoRenderer;\n            }\n            default:\n                throw new TypeError(`Unknown type: ${meta.type}`);\n        }\n    };\n    return args.map(metaToValue);\n};\nconst isRemoteModuleEnabledImpl = function (contents) {\n    const webPreferences = contents.getLastWebPreferences() || {};\n    return webPreferences.enableRemoteModule != null ? !!webPreferences.enableRemoteModule : false;\n};\nconst isRemoteModuleEnabledCache = new WeakMap();\nconst isRemoteModuleEnabled = function (contents) {\n    if (!isRemoteModuleEnabledCache.has(contents)) {\n        isRemoteModuleEnabledCache.set(contents, isRemoteModuleEnabledImpl(contents));\n    }\n    return isRemoteModuleEnabledCache.get(contents);\n};\nexports.isRemoteModuleEnabled = isRemoteModuleEnabled;\nconst handleRemoteCommand = function (channel, handler) {\n    electron_1.ipcMain.on(channel, (event, contextId, ...args) => {\n        let returnValue;\n        if (!exports.isRemoteModuleEnabled(event.sender)) {\n            event.returnValue = {\n                type: 'exception',\n                value: valueToMeta(event.sender, contextId, new Error('@electron/remote is disabled for this WebContents. Set {enableRemoteModule: true} in WebPreferences to enable it.'))\n            };\n            return;\n        }\n        try {\n            returnValue = handler(event, contextId, ...args);\n        }\n        catch (error) {\n            returnValue = {\n                type: 'exception',\n                value: valueToMeta(event.sender, contextId, error),\n            };\n        }\n        if (returnValue !== undefined) {\n            event.returnValue = returnValue;\n        }\n    });\n};\nconst emitCustomEvent = function (contents, eventName, ...args) {\n    const event = { sender: contents, returnValue: undefined, defaultPrevented: false };\n    electron_1.app.emit(eventName, event, contents, ...args);\n    contents.emit(eventName, event, ...args);\n    return event;\n};\nconst logStack = function (contents, code, stack) {\n    if (stack) {\n        console.warn(`WebContents (${contents.id}): ${code}`, stack);\n    }\n};\nlet initialized = false;\nfunction initialize() {\n    if (initialized)\n        throw new Error('electron-remote has already been initialized');\n    initialized = true;\n    handleRemoteCommand(\"REMOTE_BROWSER_WRONG_CONTEXT_ERROR\" /* BROWSER_WRONG_CONTEXT_ERROR */, function (event, contextId, passedContextId, id) {\n        const objectId = [passedContextId, id];\n        const cachedFunction = getCachedRendererFunction(objectId);\n        if (cachedFunction === undefined) {\n            // Do nothing if the error has already been reported before.\n            return;\n        }\n        removeRemoteListenersAndLogWarning(event.sender, cachedFunction);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_REQUIRE\" /* BROWSER_REQUIRE */, function (event, contextId, moduleName, stack) {\n        logStack(event.sender, `remote.require('${moduleName}')`, stack);\n        const customEvent = emitCustomEvent(event.sender, 'remote-require', moduleName);\n        if (customEvent.returnValue === undefined) {\n            if (customEvent.defaultPrevented) {\n                throw new Error(`Blocked remote.require('${moduleName}')`);\n            }\n            else {\n                customEvent.returnValue = process.mainModule.require(moduleName);\n            }\n        }\n        return valueToMeta(event.sender, contextId, customEvent.returnValue);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_GET_BUILTIN\" /* BROWSER_GET_BUILTIN */, function (event, contextId, moduleName, stack) {\n        logStack(event.sender, `remote.getBuiltin('${moduleName}')`, stack);\n        const customEvent = emitCustomEvent(event.sender, 'remote-get-builtin', moduleName);\n        if (customEvent.returnValue === undefined) {\n            if (customEvent.defaultPrevented) {\n                throw new Error(`Blocked remote.getBuiltin('${moduleName}')`);\n            }\n            else {\n                customEvent.returnValue = require('electron')[moduleName];\n            }\n        }\n        return valueToMeta(event.sender, contextId, customEvent.returnValue);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_GET_GLOBAL\" /* BROWSER_GET_GLOBAL */, function (event, contextId, globalName, stack) {\n        logStack(event.sender, `remote.getGlobal('${globalName}')`, stack);\n        const customEvent = emitCustomEvent(event.sender, 'remote-get-global', globalName);\n        if (customEvent.returnValue === undefined) {\n            if (customEvent.defaultPrevented) {\n                throw new Error(`Blocked remote.getGlobal('${globalName}')`);\n            }\n            else {\n                customEvent.returnValue = global[globalName];\n            }\n        }\n        return valueToMeta(event.sender, contextId, customEvent.returnValue);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_GET_CURRENT_WINDOW\" /* BROWSER_GET_CURRENT_WINDOW */, function (event, contextId, stack) {\n        logStack(event.sender, 'remote.getCurrentWindow()', stack);\n        const customEvent = emitCustomEvent(event.sender, 'remote-get-current-window');\n        if (customEvent.returnValue === undefined) {\n            if (customEvent.defaultPrevented) {\n                throw new Error('Blocked remote.getCurrentWindow()');\n            }\n            else {\n                customEvent.returnValue = event.sender.getOwnerBrowserWindow();\n            }\n        }\n        return valueToMeta(event.sender, contextId, customEvent.returnValue);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS\" /* BROWSER_GET_CURRENT_WEB_CONTENTS */, function (event, contextId, stack) {\n        logStack(event.sender, 'remote.getCurrentWebContents()', stack);\n        const customEvent = emitCustomEvent(event.sender, 'remote-get-current-web-contents');\n        if (customEvent.returnValue === undefined) {\n            if (customEvent.defaultPrevented) {\n                throw new Error('Blocked remote.getCurrentWebContents()');\n            }\n            else {\n                customEvent.returnValue = event.sender;\n            }\n        }\n        return valueToMeta(event.sender, contextId, customEvent.returnValue);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_CONSTRUCTOR\" /* BROWSER_CONSTRUCTOR */, function (event, contextId, id, args) {\n        args = unwrapArgs(event.sender, event.frameId, contextId, args);\n        const constructor = objects_registry_1.default.get(id);\n        if (constructor == null) {\n            throwRPCError(`Cannot call constructor on missing remote object ${id}`);\n        }\n        return valueToMeta(event.sender, contextId, new constructor(...args));\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_FUNCTION_CALL\" /* BROWSER_FUNCTION_CALL */, function (event, contextId, id, args) {\n        args = unwrapArgs(event.sender, event.frameId, contextId, args);\n        const func = objects_registry_1.default.get(id);\n        if (func == null) {\n            throwRPCError(`Cannot call function on missing remote object ${id}`);\n        }\n        try {\n            return valueToMeta(event.sender, contextId, func(...args), true);\n        }\n        catch (error) {\n            const err = new Error(`Could not call remote function '${func.name || 'anonymous'}'. Check that the function signature is correct. Underlying error: ${error.message}\\nUnderlying stack: ${error.stack}\\n`);\n            err.cause = error;\n            throw err;\n        }\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_MEMBER_CONSTRUCTOR\" /* BROWSER_MEMBER_CONSTRUCTOR */, function (event, contextId, id, method, args) {\n        args = unwrapArgs(event.sender, event.frameId, contextId, args);\n        const object = objects_registry_1.default.get(id);\n        if (object == null) {\n            throwRPCError(`Cannot call constructor '${method}' on missing remote object ${id}`);\n        }\n        return valueToMeta(event.sender, contextId, new object[method](...args));\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_MEMBER_CALL\" /* BROWSER_MEMBER_CALL */, function (event, contextId, id, method, args) {\n        args = unwrapArgs(event.sender, event.frameId, contextId, args);\n        const object = objects_registry_1.default.get(id);\n        if (object == null) {\n            throwRPCError(`Cannot call method '${method}' on missing remote object ${id}`);\n        }\n        try {\n            return valueToMeta(event.sender, contextId, object[method](...args), true);\n        }\n        catch (error) {\n            const err = new Error(`Could not call remote method '${method}'. Check that the method signature is correct. Underlying error: ${error.message}\\nUnderlying stack: ${error.stack}\\n`);\n            err.cause = error;\n            throw err;\n        }\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_MEMBER_SET\" /* BROWSER_MEMBER_SET */, function (event, contextId, id, name, args) {\n        args = unwrapArgs(event.sender, event.frameId, contextId, args);\n        const obj = objects_registry_1.default.get(id);\n        if (obj == null) {\n            throwRPCError(`Cannot set property '${name}' on missing remote object ${id}`);\n        }\n        obj[name] = args[0];\n        return null;\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_MEMBER_GET\" /* BROWSER_MEMBER_GET */, function (event, contextId, id, name) {\n        const obj = objects_registry_1.default.get(id);\n        if (obj == null) {\n            throwRPCError(`Cannot get property '${name}' on missing remote object ${id}`);\n        }\n        return valueToMeta(event.sender, contextId, obj[name]);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_DEREFERENCE\" /* BROWSER_DEREFERENCE */, function (event, contextId, id) {\n        objects_registry_1.default.remove(event.sender, contextId, id);\n    });\n    handleRemoteCommand(\"REMOTE_BROWSER_CONTEXT_RELEASE\" /* BROWSER_CONTEXT_RELEASE */, (event, contextId) => {\n        objects_registry_1.default.clear(event.sender, contextId);\n        return null;\n    });\n}\nexports.initialize = initialize;\n","module.exports = require('../dist/src/main')\n","'use strict';\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nconst mask = (source, mask, output, offset, length) => {\n  for (var i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n};\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nconst unmask = (buffer, mask) => {\n  // Required until https://github.com/nodejs/node/issues/9006 is resolved.\n  const length = buffer.length;\n  for (var i = 0; i < length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n};\n\nmodule.exports = { mask, unmask };\n","'use strict';\n\ntry {\n  module.exports = require('node-gyp-build')(__dirname);\n} catch (e) {\n  module.exports = require('./fallback');\n}\n","var fs = require('fs')\nvar path = require('path')\nvar os = require('os')\n\n// Workaround to fix webpack's build warnings: 'the request of a dependency is an expression'\nvar runtimeRequire = typeof __webpack_require__ === 'function' ? __non_webpack_require__ : require // eslint-disable-line\n\nvar vars = (process.config && process.config.variables) || {}\nvar prebuildsOnly = !!process.env.PREBUILDS_ONLY\nvar abi = process.versions.modules // TODO: support old node where this is undef\nvar runtime = isElectron() ? 'electron' : 'node'\nvar arch = os.arch()\nvar platform = os.platform()\nvar libc = process.env.LIBC || (isAlpine(platform) ? 'musl' : 'glibc')\nvar armv = process.env.ARM_VERSION || (arch === 'arm64' ? '8' : vars.arm_version) || ''\nvar uv = (process.versions.uv || '').split('.')[0]\n\nmodule.exports = load\n\nfunction load (dir) {\n  return runtimeRequire(load.path(dir))\n}\n\nload.path = function (dir) {\n  dir = path.resolve(dir || '.')\n\n  try {\n    var name = runtimeRequire(path.join(dir, 'package.json')).name.toUpperCase().replace(/-/g, '_')\n    if (process.env[name + '_PREBUILD']) dir = process.env[name + '_PREBUILD']\n  } catch (err) {}\n\n  if (!prebuildsOnly) {\n    var release = getFirst(path.join(dir, 'build/Release'), matchBuild)\n    if (release) return release\n\n    var debug = getFirst(path.join(dir, 'build/Debug'), matchBuild)\n    if (debug) return debug\n  }\n\n  var prebuild = resolve(dir)\n  if (prebuild) return prebuild\n\n  var nearby = resolve(path.dirname(process.execPath))\n  if (nearby) return nearby\n\n  var target = [\n    'platform=' + platform,\n    'arch=' + arch,\n    'runtime=' + runtime,\n    'abi=' + abi,\n    'uv=' + uv,\n    armv ? 'armv=' + armv : '',\n    'libc=' + libc,\n    'node=' + process.versions.node,\n    process.versions.electron ? 'electron=' + process.versions.electron : '',\n    typeof __webpack_require__ === 'function' ? 'webpack=true' : '' // eslint-disable-line\n  ].filter(Boolean).join(' ')\n\n  throw new Error('No native build was found for ' + target + '\\n    loaded from: ' + dir + '\\n')\n\n  function resolve (dir) {\n    // Find matching \"prebuilds/<platform>-<arch>\" directory\n    var tuples = readdirSync(path.join(dir, 'prebuilds')).map(parseTuple)\n    var tuple = tuples.filter(matchTuple(platform, arch)).sort(compareTuples)[0]\n    if (!tuple) return\n\n    // Find most specific flavor first\n    var prebuilds = path.join(dir, 'prebuilds', tuple.name)\n    var parsed = readdirSync(prebuilds).map(parseTags)\n    var candidates = parsed.filter(matchTags(runtime, abi))\n    var winner = candidates.sort(compareTags(runtime))[0]\n    if (winner) return path.join(prebuilds, winner.file)\n  }\n}\n\nfunction readdirSync (dir) {\n  try {\n    return fs.readdirSync(dir)\n  } catch (err) {\n    return []\n  }\n}\n\nfunction getFirst (dir, filter) {\n  var files = readdirSync(dir).filter(filter)\n  return files[0] && path.join(dir, files[0])\n}\n\nfunction matchBuild (name) {\n  return /\\.node$/.test(name)\n}\n\nfunction parseTuple (name) {\n  // Example: darwin-x64+arm64\n  var arr = name.split('-')\n  if (arr.length !== 2) return\n\n  var platform = arr[0]\n  var architectures = arr[1].split('+')\n\n  if (!platform) return\n  if (!architectures.length) return\n  if (!architectures.every(Boolean)) return\n\n  return { name, platform, architectures }\n}\n\nfunction matchTuple (platform, arch) {\n  return function (tuple) {\n    if (tuple == null) return false\n    if (tuple.platform !== platform) return false\n    return tuple.architectures.includes(arch)\n  }\n}\n\nfunction compareTuples (a, b) {\n  // Prefer single-arch prebuilds over multi-arch\n  return a.architectures.length - b.architectures.length\n}\n\nfunction parseTags (file) {\n  var arr = file.split('.')\n  var extension = arr.pop()\n  var tags = { file: file, specificity: 0 }\n\n  if (extension !== 'node') return\n\n  for (var i = 0; i < arr.length; i++) {\n    var tag = arr[i]\n\n    if (tag === 'node' || tag === 'electron' || tag === 'node-webkit') {\n      tags.runtime = tag\n    } else if (tag === 'napi') {\n      tags.napi = true\n    } else if (tag.slice(0, 3) === 'abi') {\n      tags.abi = tag.slice(3)\n    } else if (tag.slice(0, 2) === 'uv') {\n      tags.uv = tag.slice(2)\n    } else if (tag.slice(0, 4) === 'armv') {\n      tags.armv = tag.slice(4)\n    } else if (tag === 'glibc' || tag === 'musl') {\n      tags.libc = tag\n    } else {\n      continue\n    }\n\n    tags.specificity++\n  }\n\n  return tags\n}\n\nfunction matchTags (runtime, abi) {\n  return function (tags) {\n    if (tags == null) return false\n    if (tags.runtime !== runtime && !runtimeAgnostic(tags)) return false\n    if (tags.abi !== abi && !tags.napi) return false\n    if (tags.uv && tags.uv !== uv) return false\n    if (tags.armv && tags.armv !== armv) return false\n    if (tags.libc && tags.libc !== libc) return false\n\n    return true\n  }\n}\n\nfunction runtimeAgnostic (tags) {\n  return tags.runtime === 'node' && tags.napi\n}\n\nfunction compareTags (runtime) {\n  // Precedence: non-agnostic runtime, abi over napi, then by specificity.\n  return function (a, b) {\n    if (a.runtime !== b.runtime) {\n      return a.runtime === runtime ? -1 : 1\n    } else if (a.abi !== b.abi) {\n      return a.abi ? -1 : 1\n    } else if (a.specificity !== b.specificity) {\n      return a.specificity > b.specificity ? -1 : 1\n    } else {\n      return 0\n    }\n  }\n}\n\nfunction isElectron () {\n  if (process.versions && process.versions.electron) return true\n  if (process.env.ELECTRON_RUN_AS_NODE) return true\n  return typeof window !== 'undefined' && window.process && window.process.type === 'renderer'\n}\n\nfunction isAlpine (platform) {\n  return platform === 'linux' && fs.existsSync('/etc/alpine-release')\n}\n\n// Exposed for unit tests\n// TODO: move to lib\nload.parseTags = parseTags\nload.matchTags = matchTags\nload.compareTags = compareTags\nload.parseTuple = parseTuple\nload.matchTuple = matchTuple\nload.compareTuples = compareTuples\n","'use strict';\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0x00) {  // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {  // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0  // overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {  // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80 ||  // overlong\n        buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0  // surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {  // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80 ||  // overlong\n        buf[i] === 0xf4 && buf[i + 1] > 0x8f || buf[i] > 0xf4  // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nmodule.exports = isValidUTF8;\n","'use strict';\n\ntry {\n  module.exports = require('node-gyp-build')(__dirname);\n} catch (e) {\n  module.exports = require('./fallback');\n}\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) return target.slice(0, offset);\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.byteLength === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = Buffer.from(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = Buffer.from(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\ntry {\n  const bufferUtil = require('bufferutil');\n\n  module.exports = {\n    concat,\n    mask(source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    },\n    toArrayBuffer,\n    toBuffer,\n    unmask(buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    }\n  };\n} catch (e) /* istanbul ignore next */ {\n  module.exports = {\n    concat,\n    mask: _mask,\n    toArrayBuffer,\n    toBuffer,\n    unmask: _unmask\n  };\n}\n","'use strict';\n\nmodule.exports = {\n  BINARY_TYPES: ['nodebuffer', 'arraybuffer', 'fragments'],\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {Function} listener The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, listener, options = {}) {\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        listener.call(this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        listener.call(this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        listener.call(this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        listener.call(this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = listener;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {Function} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) data = data.slice(0, data.length - 4);\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._state = GET_INFO;\n    this._loop = false;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = buf.slice(n);\n      return buf.slice(0, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = buf.slice(n);\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    let err;\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          err = this.getInfo();\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          err = this.getPayloadLength16();\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          err = this.getPayloadLength64();\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          err = this.getData(cb);\n          break;\n        default:\n          // `INFLATING`\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    cb(err);\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @return {(RangeError|undefined)} A possible error\n   * @private\n   */\n  getInfo() {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      this._loop = false;\n      return error(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      this._loop = false;\n      return error(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n      }\n\n      if (!this._fragmented) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        this._loop = false;\n        return error(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n      }\n\n      if (compressed) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n      }\n\n      if (this._payloadLength > 0x7d) {\n        this._loop = false;\n        return error(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n      }\n    } else {\n      this._loop = false;\n      return error(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n      }\n    } else if (this._masked) {\n      this._loop = false;\n      return error(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else return this.haveLength();\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @return {(RangeError|undefined)} A possible error\n   * @private\n   */\n  getPayloadLength16() {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    return this.haveLength();\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @return {(RangeError|undefined)} A possible error\n   * @private\n   */\n  getPayloadLength64() {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      this._loop = false;\n      return error(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    return this.haveLength();\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @return {(RangeError|undefined)} A possible error\n   * @private\n   */\n  haveLength() {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        this._loop = false;\n        return error(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) return this.controlMessage(data);\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    return this.dataMessage();\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          return cb(\n            error(\n              RangeError,\n              'Max payload size exceeded',\n              false,\n              1009,\n              'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n            )\n          );\n        }\n\n        this._fragments.push(buf);\n      }\n\n      const er = this.dataMessage();\n      if (er) return cb(er);\n\n      this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @return {(Error|undefined)} A possible error\n   * @private\n   */\n  dataMessage() {\n    if (this._fin) {\n      const messageLength = this._messageLength;\n      const fragments = this._fragments;\n\n      this._totalPayloadLength = 0;\n      this._messageLength = 0;\n      this._fragmented = 0;\n      this._fragments = [];\n\n      if (this._opcode === 2) {\n        let data;\n\n        if (this._binaryType === 'nodebuffer') {\n          data = concat(fragments, messageLength);\n        } else if (this._binaryType === 'arraybuffer') {\n          data = toArrayBuffer(concat(fragments, messageLength));\n        } else {\n          data = fragments;\n        }\n\n        this.emit('message', data, true);\n      } else {\n        const buf = concat(fragments, messageLength);\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          this._loop = false;\n          return error(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n        }\n\n        this.emit('message', buf, false);\n      }\n    }\n\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data) {\n    if (this._opcode === 0x08) {\n      this._loop = false;\n\n      if (data.length === 0) {\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else if (data.length === 1) {\n        return error(\n          RangeError,\n          'invalid payload length 1',\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          return error(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n        }\n\n        const buf = data.slice(2);\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          return error(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n        }\n\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n    } else if (this._opcode === 0x09) {\n      this.emit('ping', data);\n    } else {\n      this.emit('pong', data);\n    }\n\n    this._state = GET_INFO;\n  }\n}\n\nmodule.exports = Receiver;\n\n/**\n * Builds an error object.\n *\n * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n * @param {String} message The error message\n * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n *     `message`\n * @param {Number} statusCode The status code\n * @param {String} errorCode The exposed error code\n * @return {(Error|RangeError)} The error\n * @private\n */\nfunction error(ErrorCtor, message, prefix, statusCode, errorCode) {\n  const err = new ErrorCtor(\n    prefix ? `Invalid WebSocket frame: ${message}` : message\n  );\n\n  Error.captureStackTrace(err, error);\n  err.code = errorCode;\n  err[kStatusCode] = statusCode;\n  return err;\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^net|tls$\" }] */\n\n'use strict';\n\nconst net = require('net');\nconst tls = require('tls');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER } = require('./constants');\nconst { isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {(net.Socket|tls.Socket)} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._deflating = false;\n    this._queue = [];\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        randomFillSync(mask, 0, 4);\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._deflating) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (this._deflating) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (this._deflating) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    if (perMessageDeflate) {\n      const opts = {\n        [kByteLength]: byteLength,\n        fin: options.fin,\n        generateMask: this._generateMask,\n        mask: options.mask,\n        maskBuffer: this._maskBuffer,\n        opcode,\n        readOnly,\n        rsv1\n      };\n\n      if (this._deflating) {\n        this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n      } else {\n        this.dispatch(data, this._compress, opts, cb);\n      }\n    } else {\n      this.sendFrame(\n        Sender.frame(data, {\n          [kByteLength]: byteLength,\n          fin: options.fin,\n          generateMask: this._generateMask,\n          mask: options.mask,\n          maskBuffer: this._maskBuffer,\n          opcode,\n          readOnly,\n          rsv1: false\n        }),\n        cb\n      );\n    }\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._deflating = true;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        if (typeof cb === 'function') cb(err);\n\n        for (let i = 0; i < this._queue.length; i++) {\n          const params = this._queue[i];\n          const callback = params[params.length - 1];\n\n          if (typeof callback === 'function') callback(err);\n        }\n\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._deflating = false;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (!this._deflating && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {Buffer[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n","'use strict';\n\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","'use strict';\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\ntry {\n  const isValidUTF8 = require('utf-8-validate');\n\n  module.exports = {\n    isValidStatusCode,\n    isValidUTF8(buf) {\n      return buf.length < 150 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    },\n    tokenChars\n  };\n} catch (e) /* istanbul ignore next */ {\n  module.exports = {\n    isValidStatusCode,\n    isValidUTF8: _isValidUTF8,\n    tokenChars\n  };\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^net|tls|https$\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst https = require('https');\nconst net = require('net');\nconst tls = require('tls');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {(net.Socket|tls.Socket)} socket The network socket between the\n   *     server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key =\n      req.headers['sec-websocket-key'] !== undefined\n        ? req.headers['sec-websocket-key']\n        : false;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (\n      req.method !== 'GET' ||\n      req.headers.upgrade.toLowerCase() !== 'websocket' ||\n      !key ||\n      !keyRegex.test(key) ||\n      (version !== 8 && version !== 13) ||\n      !this.shouldHandle(req)\n    ) {\n      return abortHandshake(socket, 400);\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        return abortHandshake(socket, 400);\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        return abortHandshake(socket, 400);\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {(net.Socket|tls.Socket)} socket The network socket between the\n   *     server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle premature socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {(net.Socket|tls.Socket)} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  if (socket.writable) {\n    message = message || http.STATUS_CODES[code];\n    headers = {\n      Connection: 'close',\n      'Content-Type': 'text/html',\n      'Content-Length': Buffer.byteLength(message),\n      ...headers\n    };\n\n    socket.write(\n      `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n        Object.keys(headers)\n          .map((h) => `${h}: ${headers[h]}`)\n          .join('\\r\\n') +\n        '\\r\\n\\r\\n' +\n        message\n    );\n  }\n\n  socket.removeListener('error', socketOnError);\n  socket.destroy();\n}\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Readable$\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\nconst protocolVersions = [8, 13];\nconst closeTimeout = 30 * 1000;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * This deviates from the WHATWG interface since ws doesn't support the\n   * required default \"blob\" type (instead we define a custom \"nodebuffer\"\n   * type).\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {(net.Socket|tls.Socket)} socket The network socket between the\n   *     server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    this._sender = new Sender(socket, this._extensions, options.generateMask);\n    this._receiver = receiver;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    socket.setTimeout(0);\n    socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      return abortHandshake(this, this._req, msg);\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    //\n    // Specify a timeout for the closing handshake to complete.\n    //\n    this._closeTimer = setTimeout(\n      this._socket.destroy.bind(this._socket),\n      closeTimeout\n    );\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      return abortHandshake(this, this._req, msg);\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    createConnection: undefined,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: undefined,\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n    websocket._url = address.href;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n\n    websocket._url = address;\n  }\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isUnixSocket = parsedUrl.protocol === 'ws+unix:';\n  let invalidURLMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isUnixSocket) {\n    invalidURLMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", or \"ws+unix:\"';\n  } else if (isUnixSocket && !parsedUrl.pathname) {\n    invalidURLMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidURLMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidURLMessage) {\n    const err = new SyntaxError(invalidURLMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const get = isSecure ? https.get : http.get;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection = isSecure ? tlsConnect : netConnect;\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket',\n    ...opts.headers\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isUnixSocket) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalHost = parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (parsedUrl.host !== websocket._originalHost) {\n      //\n      // Match curl 7.77.0 behavior and drop the following headers. These\n      // headers are also dropped when following a redirect to a subdomain.\n      //\n      delete opts.headers.authorization;\n      delete opts.headers.cookie;\n      delete opts.headers.host;\n      opts.auth = undefined;\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n  }\n\n  let req = (websocket._req = get(opts));\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req.aborted) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the `upgrade`\n    // event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n}\n\n/**\n * Emit the `'error'` and `'close'` event.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    stream.once('abort', websocket.emitClose.bind(websocket));\n    websocket.emit('error', err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    cb(err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  websocket.emit('error', err);\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  websocket.pong(data, !websocket._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The listener of the `net.Socket` `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the `net.Socket` `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the `net.Socket` `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the `net.Socket` `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","module.exports = require(\"crypto\");","module.exports = require(\"electron\");","module.exports = require(\"events\");","module.exports = require(\"fs\");","module.exports = require(\"http\");","module.exports = require(\"https\");","module.exports = require(\"net\");","module.exports = require(\"os\");","module.exports = require(\"path\");","module.exports = require(\"stream\");","module.exports = require(\"tls\");","module.exports = require(\"url\");","module.exports = require(\"zlib\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"process\");","import createWebSocketStream from './lib/stream.js';\nimport Receiver from './lib/receiver.js';\nimport Sender from './lib/sender.js';\nimport WebSocket from './lib/websocket.js';\nimport WebSocketServer from './lib/websocket-server.js';\n\nexport { createWebSocketStream, Receiver, Sender, WebSocket, WebSocketServer };\nexport default WebSocket;\n","export class BaseError extends Error {\n\tconstructor(name: string, wrapErr: Error, message: string,\n\t\targs?: {[key: string]: any}) {\n\n\t\tsuper()\n\n\t\tif (args) {\n\t\t\tfor (let key in args) {\n\t\t\t\tmessage += \" \" + key + \"=\" + args[key]\n\t\t\t}\n\t\t}\n\n\t\tif (wrapErr) {\n\t\t\tmessage += \"\\n\" + wrapErr\n\t\t}\n\n\t\tthis.name = name\n\t\tthis.message = message\n\t\tif (wrapErr) {\n\t\t\tthis.stack = wrapErr.stack\n\t\t}\n\t}\n}\n\nexport class ReadError extends BaseError {\n\tconstructor(wrapErr: Error, message: string, args?: {[key: string]: any}) {\n\t\tsuper(\"ReadError\", wrapErr, message, args)\n\t}\n}\n\nexport class WriteError extends BaseError {\n\tconstructor(wrapErr: Error, message: string, args?: {[key: string]: any}) {\n\t\tsuper(\"WriteError\", wrapErr, message, args)\n\t}\n}\n\nexport class RequestError extends BaseError {\n\tconstructor(wrapErr: Error, message: string, args?: {[key: string]: any}) {\n\t\tsuper(\"RequestError\", wrapErr, message, args)\n\t}\n}\n","import fs from \"fs\"\nimport path from \"path\"\nimport electron from \"electron\"\nimport * as Errors from \"./Errors\"\n\nfunction push(level: string, msg: string): void {\n\tlet time = new Date()\n\tmsg = \"[\" + time.getFullYear() + \"-\" + (time.getMonth() + 1) + \"-\" +\n\t\ttime.getDate() + \" \" + time.getHours() + \":\" + time.getMinutes() + \":\" +\n\t\ttime.getSeconds() + \"][\" + level  + \"] \" + msg + \"\\n\"\n\n\tconsole.error(msg)\n\n\tlet logPath = path.join(electron.app.getPath(\"userData\"), \"pritunl.log\")\n\n\tfs.appendFile(logPath, msg, (err: Error): void => {\n\t\tif (err) {\n\t\t\terr = new Errors.WriteError(err, \"Logger: Failed to write log\")\n\t\t\tconsole.error(err)\n\t\t}\n\t})\n}\n\nexport function info(msg: string): void {\n\tpush(\"INFO\", msg)\n}\n\nexport function warning(msg: string): void {\n\tpush(\"WARN\", msg)\n}\n\nexport function error(msg: string): void {\n\tpush(\"ERROR\", msg)\n}\n","import http from \"http\"\nimport https from \"https\"\nimport * as Logger from \"./Logger\"\nimport * as Errors from \"./Errors\"\n\nexport var DefaultTimeout = 5\n\nexport class Response {\n\tresponse: http.IncomingMessage\n\theaders: Map<string, string>\n\tstatus: number\n\tmessage: string\n\tdata: string\n\n\tconstructor(res: http.IncomingMessage) {\n\t\tthis.response = res\n\t\tthis.status = res.statusCode\n\t\tthis.message = res.statusMessage\n\t}\n\n\tget(key: string): string {\n\t\tif (this.headers) {\n\t\t\treturn this.headers.get(key)\n\t\t}\n\n\t\tlet curKey: string = null\n\t\tlet headers = new Map<string, string>()\n\n\t\tfor (let item of this.response.rawHeaders) {\n\t\t\tif (curKey) {\n\t\t\t\theaders.set(curKey, item)\n\t\t\t\tcurKey = null\n\t\t\t} else {\n\t\t\t\tcurKey = item\n\t\t\t}\n\t\t}\n\n\t\tthis.headers = headers\n\n\t\treturn this.headers.get(key)\n\t}\n\n\tjson(): object {\n\t\treturn JSON.parse(this.data || null)\n\t}\n\n\tjsonPassive(): object {\n\t\ttry {\n\t\t\treturn JSON.parse(this.data || null)\n\t\t} catch {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tstring(): string {\n\t\treturn this.data\n\t}\n}\n\nexport class Request {\n\tssl: boolean\n\thostname: string\n\tport: number\n\tsocketPath: string\n\tttl: number\n\tmethod: string\n\tpath: string\n\theaders: Map<string, string>\n\tdata: string\n\n\tconstructor() {\n\t\tthis.headers = new Map<string, string>()\n\t}\n\n\ttcp(host: string): Request {\n\t\tlet hosts = host.split(\"://\")\n\n\t\tthis.ssl = hosts[0] === \"https\"\n\n\t\thosts = hosts[1].split(\":\")\n\n\t\tif (hosts.length > 1) {\n\t\t\tthis.port = parseInt(hosts.pop(), 10)\n\t\t} else {\n\t\t\tthis.port = 80\n\t\t}\n\n\t\tthis.hostname = hosts.join(\":\")\n\n\t\treturn this\n\t}\n\n\tunix(path: string): Request {\n\t\tthis.socketPath = path\n\t\treturn this\n\t}\n\n\ttimeout(timeout: number) {\n\t\tthis.ttl = timeout * 1000\n\t}\n\n\tget(path: string): Request {\n\t\tthis.method = \"GET\"\n\t\tthis.path = path\n\t\treturn this\n\t}\n\n\tput(path: string): Request {\n\t\tthis.method = \"PUT\"\n\t\tthis.path = path\n\t\treturn this\n\t}\n\n\tpost(path: string): Request {\n\t\tthis.method = \"POST\"\n\t\tthis.path = path\n\t\treturn this\n\t}\n\n\tdelete(path: string): Request {\n\t\tthis.method = \"DELETE\"\n\t\tthis.path = path\n\t\treturn this\n\t}\n\n\tset(key: string, value: string): Request {\n\t\tthis.headers.set(key, value)\n\t\treturn this\n\t}\n\n\tsend(data: string|object): Request {\n\t\tif (typeof data === \"string\") {\n\t\t\tthis.data = data\n\t\t} else {\n\t\t\tthis.headers.set(\"Content-Type\", \"application/json\")\n\t\t\tthis.data = JSON.stringify(data)\n\t\t}\n\n\t\treturn this\n\t}\n\n\tend(): Promise<Response> {\n\t\treturn new Promise<Response>((resolve, reject): void => {\n\t\t\ttry {\n\t\t\t\tlet options: http.RequestOptions = {\n\t\t\t\t\tpath: this.path,\n\t\t\t\t\tmethod: this.method,\n\t\t\t\t\theaders: Object.fromEntries(this.headers)\n\t\t\t\t}\n\n\t\t\t\tif (this.socketPath) {\n\t\t\t\t\toptions.socketPath = this.socketPath\n\t\t\t\t} else {\n\t\t\t\t\toptions.hostname = this.hostname\n\t\t\t\t\toptions.port = this.port\n\t\t\t\t}\n\n\t\t\t\toptions.timeout = this.ttl || (DefaultTimeout * 1000)\n\n\t\t\t\tlet callback = (nodeResp: http.IncomingMessage) => {\n\t\t\t\t\tlet resp = new Response(nodeResp)\n\n\t\t\t\t\tnodeResp.on(\"data\", (data) => {\n\t\t\t\t\t\tif (data) {\n\t\t\t\t\t\t\tresp.data = data.toString()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tnodeResp.on(\"end\", () => {\n\t\t\t\t\t\tresolve(resp)\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tlet req: http.ClientRequest\n\t\t\t\tif (this.ssl) {\n\t\t\t\t\treq = https.request(options, callback)\n\t\t\t\t} else {\n\t\t\t\t\treq = http.request(options, callback)\n\t\t\t\t}\n\n\t\t\t\treq.on(\"timeout\", () => {\n\t\t\t\t\tlet err = new Errors.RequestError(null, \"Request: Timeout error\")\n\t\t\t\t\treq.destroy(err)\n\t\t\t\t\tLogger.error(err.message)\n\t\t\t\t\treject(err)\n\t\t\t\t})\n\n\t\t\t\treq.on(\"error\", (err) => {\n\t\t\t\t\terr = new Errors.RequestError(err, \"Request: HTTP error\")\n\t\t\t\t\tLogger.error(err.message)\n\t\t\t\t\treject(err)\n\t\t\t\t})\n\n\t\t\t\tif (this.data) {\n\t\t\t\t\treq.write(this.data)\n\t\t\t\t}\n\n\t\t\t\treq.end()\n\t\t\t} catch (err) {\n\t\t\t\terr = new Errors.RequestError(err, \"Request: Exception\")\n\t\t\t\tLogger.error(err.message)\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n}\n","import WebSocket from \"ws\"\nimport fs from \"fs\"\nimport path from \"path\"\nimport process from \"process\"\nimport * as Request from \"./Request\"\nimport * as Logger from \"./Logger\"\n\nexport interface Event {\n\tid: string\n\ttype: string\n\tdata?: any\n}\n\nexport type Callback = (event: Event) => void\n\nlet unix = false\nconst unixPath = \"/var/run/pritunl.sock\"\nconst webHost = \"http://127.0.0.1:9770\"\nconst unixWsHost = \"ws+unix://\" + path.join(\n\tpath.sep, \"var\", \"run\", \"pritunl.sock\") + \":\"\nconst webWsHost = \"ws://127.0.0.1:9770\"\n\nlet showConnect = false\nlet socket: WebSocket.WebSocket\nlet callbacks: Callback[] = []\n\nexport let winDrive = 'C:\\\\';\nlet systemDrv = process.env.SYSTEMDRIVE;\nif (systemDrv) {\n\twinDrive = systemDrv + '\\\\';\n}\n\nif (process.platform === \"linux\" || process.platform === \"darwin\") {\n\tunix = true\n}\n\nfunction getAuthPath(): string {\n\tif (process.argv.indexOf(\"--dev\") !== -1) {\n\t\treturn path.join(__dirname, \"..\", \"..\", \"dev\", \"auth\")\n\t} else {\n\t\tif (process.platform === \"win32\") {\n\t\t\treturn path.join(winDrive, \"ProgramData\", \"Pritunl\", \"auth\")\n\t\t} else {\n\t\t\treturn path.join(path.sep, \"var\", \"run\", \"pritunl.auth\")\n\t\t}\n\t}\n}\n\nfunction getAuthToken(): Promise<string> {\n\treturn new Promise<string>((resolve, reject): void => {\n\t\tfs.readFile(getAuthPath(), \"utf-8\", (err, data: string): void => {\n\t\t\tresolve(data.trim())\n\t\t})\n\t})\n}\n\nexport function sync(): Promise<boolean> {\n\treturn new Promise<boolean>(async (resolve) => {\n\t\tlet token: string\n\t\ttry {\n\t\t\ttoken = await getAuthToken()\n\t\t} catch(err) {\n\t\t\tLogger.error(err.message || err)\n\t\t\tresolve(false)\n\t\t\treturn\n\t\t}\n\n\t\tlet req = new Request.Request()\n\n\t\tif (unix) {\n\t\t\treq.unix(unixPath)\n\t\t} else {\n\t\t\treq.tcp(webHost)\n\t\t}\n\n\t\treq.get(\"/status\")\n\t\t\t.set(\"Auth-Token\", token)\n\t\t\t.set(\"User-Agent\", \"pritunl\")\n\t\t\t.end()\n\t\t\t.then((resp: Request.Response) => {\n\t\t\t\tif (resp.status === 200) {\n\t\t\t\t\tlet data = resp.jsonPassive() as any\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\tresolve(data.status)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(false)\n\t\t\t\t\t}\n\t\t\t\t} {\n\t\t\t\t\tresolve(false)\n\t\t\t\t}\n\t\t\t}, (err) => {\n\t\t\t\tLogger.error(err.message)\n\t\t\t\tresolve(false)\n\t\t\t})\n\t})\n}\n\nexport function wakeup(): Promise<boolean> {\n\treturn new Promise<boolean>(async (resolve) => {\n\t\tlet token: string\n\t\ttry {\n\t\t\ttoken = await getAuthToken()\n\t\t} catch(err) {\n\t\t\tLogger.error(err.message || err)\n\t\t\tresolve(false)\n\t\t\treturn\n\t\t}\n\n\t\tlet req = new Request.Request()\n\n\t\tif (unix) {\n\t\t\treq.unix(unixPath)\n\t\t} else {\n\t\t\treq.tcp(webHost)\n\t\t}\n\n\t\treq.post(\"/wakeup\")\n\t\t\t.set(\"Auth-Token\", token)\n\t\t\t.set(\"User-Agent\", \"pritunl\")\n\t\t\t.end()\n\t\t\t.then((resp: Request.Response) => {\n\t\t\t\tif (resp.status === 200) {\n\t\t\t\t\tresolve(true)\n\t\t\t\t} {\n\t\t\t\t\tresolve(false)\n\t\t\t\t}\n\t\t\t}, (err) => {\n\t\t\t\tLogger.error(err.message)\n\t\t\t\tresolve(false)\n\t\t\t})\n\t})\n}\n\nexport function connect(dev: boolean): Promise<void> {\n\treturn new Promise<void>(async (resolve, reject) => {\n\t\tlet token: string\n\t\ttry {\n\t\t\ttoken = await getAuthToken()\n\t\t} catch(err) {\n\t\t\ttoken = \"\"\n\t\t}\n\n\t\tif (!token) {\n\t\t\tsetTimeout((): void => {\n\t\t\t\tconnect(dev)\n\t\t\t}, 200)\n\t\t\treturn\n\t\t}\n\n\t\tresolve()\n\n\t\tif (token === \"\") {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconnect(dev)\n\t\t\t}, 300)\n\t\t\treturn\n\t\t}\n\n\t\tlet reconnected = false\n\t\tlet wsHost = \"\"\n\t\tlet headers = {\n\t\t\t\"User-Agent\": \"pritunl\",\n\t\t\t\"Auth-Token\": token,\n\t\t} as any\n\n\t\tif (unix) {\n\t\t\twsHost = unixWsHost\n\t\t\theaders[\"Host\"] = \"unix\"\n\t\t} else {\n\t\t\twsHost = webWsHost\n\t\t}\n\n\t\tlet reconnect = (): void => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (reconnected) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treconnected = true\n\t\t\t\tconnect(dev)\n\t\t\t}, 1000)\n\t\t}\n\n\t\tsocket = new WebSocket(wsHost + \"/events\", {\n\t\t\theaders: headers,\n\t\t})\n\n\t\tsocket.on(\"open\", (): void => {\n\t\t\tif (showConnect) {\n\t\t\t\tshowConnect = false\n\t\t\t\tconsole.log(\"Events: Service reconnected\")\n\t\t\t}\n\t\t})\n\n\t\tsocket.on(\"error\", (err: Error) => {\n\t\t\tconsole.error(\"Events: Socket error \" + err)\n\t\t\tshowConnect = true\n\t\t\treconnect()\n\t\t})\n\n\t\tsocket.on(\"onerror\", (err) => {\n\t\t\tconsole.error(\"Events: Socket error \" + err)\n\t\t\tshowConnect = true\n\t\t\treconnect()\n\t\t})\n\n\t\tsocket.on(\"close\", () => {\n\t\t\tshowConnect = true\n\t\t\treconnect()\n\t\t})\n\n\t\tsocket.on(\"message\", (dataBuf: Buffer): void => {\n\t\t\tlet data = JSON.parse(dataBuf.toString())\n\t\t\tfor (let callback of callbacks) {\n\t\t\t\tcallback(data as Event)\n\t\t\t}\n\t\t})\n\t})\n}\n\nexport function send(msg: string) {\n\tif (socket) {\n\t\tsocket.send(msg)\n\t}\n}\n\nexport function subscribe(callback: Callback) {\n\tcallbacks.push(callback)\n}\n","import fs from \"fs\"\nimport path from \"path\"\nimport electron from \"electron\"\nimport * as Errors from \"./Errors\"\nimport * as Logger from \"./Logger\"\n\nclass ConfigData {\n\tdisable_tray_icon = false\n\ttheme = \"dark\"\n\n\tpath(): string {\n\t\treturn path.join(electron.app.getPath(\"userData\"), \"pritunl.json\")\n\t}\n\n\tload(): Promise<void> {\n\t\treturn new Promise<void>((resolve): void => {\n\t\t\tfs.readFile(\n\t\t\t\tthis.path(), \"utf-8\",\n\t\t\t\t(err: NodeJS.ErrnoException, data: string): void => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tif (err.code !== \"ENOENT\") {\n\t\t\t\t\t\t\terr = new Errors.ReadError(err, \"Config: Read error\")\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve()\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tlet configData: any\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconfigData = JSON.parse(data)\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\terr = new Errors.ReadError(err, \"Config: Parse error\")\n\t\t\t\t\t\tLogger.error(err.message)\n\n\t\t\t\t\t\tconfigData = {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (configData[\"disable_tray_icon\"] !== undefined) {\n\t\t\t\t\t\tthis.disable_tray_icon = configData[\"disable_tray_icon\"]\n\t\t\t\t\t}\n\t\t\t\t\tif (configData[\"theme\"] !== undefined) {\n\t\t\t\t\t\tthis.theme = configData[\"theme\"]\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve()\n\t\t\t\t},\n\t\t\t)\n\t\t})\n\t}\n\n\tsave(): Promise<void> {\n\t\treturn new Promise<void>((resolve, reject): void => {\n\t\t\tfs.writeFile(\n\t\t\t\tthis.path(), JSON.stringify({\n\t\t\t\t\tdisable_tray_icon: this.disable_tray_icon,\n\t\t\t\t\ttheme: this.theme,\n\t\t\t\t}),\n\t\t\t\t(err: NodeJS.ErrnoException): void => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\terr = new Errors.ReadError(err, \"Config: Write error\")\n\t\t\t\t\t\tLogger.error(err.message)\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve()\n\t\t\t\t},\n\t\t\t)\n\t\t})\n\t}\n}\n\nconst Config = new ConfigData()\nexport default Config\n","import process from \"process\"\nimport path from \"path\"\nimport fs from \"fs\"\nimport electron from \"electron\"\nimport * as Service from \"./Service\"\nimport Config from \"./Config\"\n\nlet tray: electron.Tray\nlet awaken: boolean\nlet ready: boolean\nlet readyError: string\nlet main: Main\n\nlet orig = true\nif (process.argv.indexOf(\"--beta\") !== -1) {\n\torig = false\n}\n\nif (orig) {\n\trequire(\"@electron/remote/main\").initialize()\n}\n\nif (electron.app.dock) {\n\telectron.app.dock.hide()\n}\n\nprocess.on(\"uncaughtException\", function (error) {\n\tlet errorMsg: string\n\tif (error && error.stack) {\n\t\terrorMsg = error.stack\n\t} else {\n\t\terrorMsg = String(error)\n\t}\n\n\tif (!ready) {\n\t\treadyError = errorMsg\n\t\treturn\n\t}\n\n\telectron.dialog.showMessageBox(null, {\n\t\ttype: \"error\",\n\t\tbuttons: [\"Exit\"],\n\t\ttitle: \"Pritunl Client - Process Error\",\n\t\tmessage: \"Error occured in main process:\\n\\n\" + errorMsg,\n\t}).then(function() {\n\t\telectron.app.quit()\n\t})\n})\n\nprocess.on(\"unhandledRejection\", function (error) {\n\tlet errorMsg: string = String(error)\n\n\tif (!ready) {\n\t\treadyError = errorMsg\n\t\treturn\n\t}\n\n\telectron.dialog.showMessageBox(null, {\n\t\ttype: \"error\",\n\t\tbuttons: [\"Exit\"],\n\t\ttitle: \"Pritunl Client - Process Error\",\n\t\tmessage: \"Error occured in main process:\\n\\n\" + errorMsg,\n\t}).then(function() {\n\t\telectron.app.quit()\n\t})\n})\n\nService.wakeup().then((awake: boolean) => {\n\tawaken = awake\n\tif (ready) {\n\t\tinit()\n\t}\n})\n\nclass Main {\n\twindow: electron.BrowserWindow\n\n\tshowWindow(): void {\n\t\tthis.window.show()\n\t}\n\n\tcreateWindow(): void {\n\t\tlet width: number\n\t\tlet height: number\n\t\tlet minWidth: number\n\t\tlet minHeight: number\n\t\tlet maxWidth: number\n\t\tlet maxHeight: number\n\t\tif (process.platform === \"darwin\") {\n\t\t\twidth = 340\n\t\t\theight = 423\n\t\t\tminWidth = 304\n\t\t\tminHeight = 352\n\t\t\tmaxWidth = 540\n\t\t\tmaxHeight = 642\n\t\t} else {\n\t\t\twidth = 420\n\t\t\theight = 528\n\t\t\tminWidth = 380\n\t\t\tminHeight = 440\n\t\t\tmaxWidth = 670\n\t\t\tmaxHeight = 800\n\t\t}\n\n\t\tlet zoomFactor = 1\n\t\tif (process.platform === \"darwin\") {\n\t\t\tzoomFactor = 0.8\n\t\t}\n\n\t\tif (orig) {\n\t\t\tthis.window = new electron.BrowserWindow({\n\t\t\t\ttitle: \"Pritunl Client\",\n\t\t\t\ticon: path.join(__dirname, \"..\", \"logo.png\"),\n\t\t\t\tframe: true,\n\t\t\t\tautoHideMenuBar: true,\n\t\t\t\tfullscreen: false,\n\t\t\t\tshow: false,\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tminWidth: minWidth,\n\t\t\t\tminHeight: minHeight,\n\t\t\t\tmaxWidth: maxWidth,\n\t\t\t\tmaxHeight: maxHeight,\n\t\t\t\tbackgroundColor: \"#151719\",\n\t\t\t\twebPreferences: {\n\t\t\t\t\tzoomFactor: zoomFactor,\n\t\t\t\t\tdevTools: true,\n\t\t\t\t\tenableRemoteModule: true,\n\t\t\t\t\tnodeIntegration: true,\n\t\t\t\t\tcontextIsolation: false\n\t\t\t\t} as any\n\t\t\t})\n\t\t\tlet main = require(\"@electron/remote/main\")\n\t\t\tif (main && main.enable) {\n\t\t\t\tmain.enable(this.window.webContents)\n\t\t\t}\n\t\t} else {\n\t\t\tthis.window = new electron.BrowserWindow({\n\t\t\t\ttitle: \"Pritunl Client\",\n\t\t\t\ticon: path.join(__dirname, \"..\", \"logo.png\"),\n\t\t\t\tframe: true,\n\t\t\t\tautoHideMenuBar: true,\n\t\t\t\tfullscreen: false,\n\t\t\t\tshow: false,\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tminWidth: minWidth,\n\t\t\t\tminHeight: minHeight,\n\t\t\t\tmaxWidth: maxWidth,\n\t\t\t\tmaxHeight: maxHeight,\n\t\t\t\tbackgroundColor: \"#151719\",\n\t\t\t\twebPreferences: {\n\t\t\t\t\tzoomFactor: zoomFactor,\n\t\t\t\t\tdevTools: true,\n\t\t\t\t\tnodeIntegration: true,\n\t\t\t\t\tcontextIsolation: false\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tthis.window.on(\"closed\", (): void => {\n\t\t\tif (Config.disable_tray_icon || !tray) {\n\t\t\t\telectron.app.quit()\n\t\t\t}\n\t\t\tmain = null\n\t\t})\n\n\t\tlet shown = false\n\t\tthis.window.on(\"ready-to-show\", (): void => {\n\t\t\tif (shown) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tshown = true\n\t\t\tthis.window.show()\n\n\t\t\tif (process.argv.indexOf(\"--dev-tools\") !== -1) {\n\t\t\t\tthis.window.webContents.openDevTools()\n\t\t\t}\n\t\t})\n\t\tsetTimeout((): void => {\n\t\t\tif (shown) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tshown = true\n\t\t\tthis.window.show()\n\n\t\t\tif (process.argv.indexOf(\"--dev-tools\") !== -1) {\n\t\t\t\tthis.window.webContents.openDevTools()\n\t\t\t}\n\t\t}, 800)\n\n\t\tlet indexUrl = \"\"\n\t\tif (orig) {\n\t\t\tindexUrl = \"file://\" + path.join(__dirname, \"..\",\n\t\t\t\t\"index_orig.html\")\n\t\t} else {\n\t\t\tindexUrl = \"file://\" + path.join(__dirname, \"..\",\n\t\t\t\t\"index.html\")\n\t\t}\n\t\tindexUrl += \"?dev=\" + (process.argv.indexOf(\"--dev\") !== -1 ?\n\t\t\t\"true\" : \"false\")\n\t\tindexUrl += \"&dataPath=\" + encodeURIComponent(\n\t\t\telectron.app.getPath(\"userData\"))\n\n\t\tthis.window.loadURL(indexUrl, {\n\t\t\tuserAgent: \"pritunl\",\n\t\t})\n\n\t\tif (electron.app.dock) {\n\t\t\telectron.app.dock.show()\n\t\t}\n\t}\n\n\trun(): void {\n\t\tif (main) {\n\t\t\tmain.showWindow()\n\t\t\treturn\n\t\t}\n\n\t\tthis.createWindow()\n\t\tmain = this\n\t}\n}\n\nfunction initTray() {\n\ttray = new electron.Tray(getTrayIcon(false))\n\n\ttray.on(\"click\", function() {\n\t\tlet main = new Main()\n\t\tmain.run()\n\t})\n\ttray.on(\"double-click\", function() {\n\t\tlet main = new Main()\n\t\tmain.run()\n\t})\n\n\tlet trayMenu = electron.Menu.buildFromTemplate([\n\t\t{\n\t\t\tlabel: \"Open Pritunl Client\",\n\t\t\tclick: function () {\n\t\t\t\tlet main = new Main()\n\t\t\t\tmain.run()\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tlabel: \"Exit\",\n\t\t\tclick: function() {\n\t\t\t\telectron.app.quit()\n\t\t\t}\n\t\t}\n\t])\n\n\ttray.setToolTip(\"Pritunl Client\")\n\ttray.setContextMenu(trayMenu)\n\n\tService.sync().then((status: boolean): void => {\n\t\ttray.setImage(getTrayIcon(status))\n\t})\n}\n\nfunction initAppMenu() {\n\tlet appMenu = electron.Menu.buildFromTemplate([\n\t\t{\n\t\t\tlabel: \"Pritunl\",\n\t\t\tsubmenu: [\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Pritunl Client\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Close\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+Q\",\n\t\t\t\t\trole: \"close\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Exit\",\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\telectron.app.quit()\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tlabel: \"Edit\",\n\t\t\tsubmenu: [\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Undo\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+Z\",\n\t\t\t\t\trole: \"undo\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Redo\",\n\t\t\t\t\taccelerator: \"Shift+CmdOrCtrl+Z\",\n\t\t\t\t\trole: \"redo\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: \"separator\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Cut\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+X\",\n\t\t\t\t\trole: \"cut\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Copy\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+C\",\n\t\t\t\t\trole: \"copy\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Paste\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+V\",\n\t\t\t\t\trole: \"paste\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Select All\",\n\t\t\t\t\taccelerator: \"CmdOrCtrl+A\",\n\t\t\t\t\trole: \"selectall\",\n\t\t\t\t},\n\t\t\t],\n\t\t}\n\t] as any)\n\telectron.Menu.setApplicationMenu(appMenu)\n}\n\nfunction init() {\n\tif (awaken === undefined) {\n\t\treturn\n\t} else if (awaken) {\n\t\telectron.app.quit()\n\t\treturn\n\t}\n\n\tConfig.load().then(() => {\n\t\tService.connect(process.argv.indexOf(\"--dev\") !== -1).then(() => {\n\t\t\tif (process.argv.indexOf(\"--no-main\") !== -1) {\n\t\t\t\tif (Config.disable_tray_icon) {\n\t\t\t\t\telectron.app.quit()\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet main = new Main()\n\t\t\t\tmain.run()\n\t\t\t}\n\n\t\t\tinitAppMenu()\n\n\t\t\tif (!Config.disable_tray_icon) {\n\t\t\t\tinitTray()\n\t\t\t}\n\n\t\t\tService.subscribe((event: Service.Event): void => {\n\t\t\t\tif (event.type === \"connected\") {\n\t\t\t\t\tif (tray) {\n\t\t\t\t\t\ttray.setImage(getTrayIcon(true))\n\t\t\t\t\t}\n\t\t\t\t} else if (event.type === \"disconnected\") {\n\t\t\t\t\tif (tray) {\n\t\t\t\t\t\ttray.setImage(getTrayIcon(false))\n\t\t\t\t\t}\n\t\t\t\t} else if (event.type === \"wakeup\") {\n\t\t\t\t\tService.send(\"awake\")\n\n\t\t\t\t\tlet main = new Main()\n\t\t\t\t\tmain.run()\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t})\n}\n\nfunction getTrayIcon(state: boolean): string {\n\tlet connTray = \"\"\n\tlet disconnTray = \"\"\n\n\tif (process.platform === \"darwin\") {\n\t\tconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_connected_osxTemplate.png\")\n\t\tdisconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_disconnected_osxTemplate.png\")\n\t} else if (process.platform === \"win32\") {\n\t\tconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_connected_win.png\")\n\t\tdisconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_disconnected_win.png\")\n\t} else if (process.platform === \"linux\") {\n\t\tconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_connected_linux_light.png\")\n\t\tdisconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_disconnected_linux_light.png\")\n\t} else {\n\t\tconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_connected.png\")\n\t\tdisconnTray = path.join(__dirname, \"..\", \"img\",\n\t\t\t\"tray_disconnected.png\")\n\t}\n\n\tif (state) {\n\t\treturn connTray\n\t} else {\n\t\treturn disconnTray\n\t}\n}\n\nelectron.app.on(\"window-all-closed\", (): void => {\n\ttry {\n\t\tConfig.load().then(() => {\n\t\t\tif (Config.disable_tray_icon || !tray) {\n\t\t\t\telectron.app.quit()\n\t\t\t} else {\n\t\t\t\tif (electron.app.dock) {\n\t\t\t\t\telectron.app.dock.hide()\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n\nelectron.app.on(\"open-file\", (): void => {\n\ttry {\n\t\tlet main = new Main()\n\t\tmain.run()\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n\nelectron.app.on(\"open-url\", (): void => {\n\ttry {\n\t\tlet main = new Main()\n\t\tmain.run()\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n\nelectron.app.on(\"activate\", (): void => {\n\ttry {\n\t\tlet main = new Main()\n\t\tmain.run()\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n\nelectron.app.on(\"quit\", (): void => {\n\ttry {\n\t\telectron.app.quit()\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n\nelectron.app.on(\"ready\", (): void => {\n\tlet profilesPth = path.join(electron.app.getPath(\"userData\"), \"profiles\")\n\t\tfs.exists(profilesPth, function(exists) {\n\t\tif (!exists) {\n\t\t\tfs.mkdir(profilesPth, function() {})\n\t\t}\n\t})\n\n\ttry {\n\t\tif (readyError) {\n\t\t\telectron.dialog.showMessageBox(null, {\n\t\t\t\ttype: \"error\",\n\t\t\t\tbuttons: [\"Exit\"],\n\t\t\t\ttitle: \"Pritunl Client - Process Error\",\n\t\t\t\tmessage: \"Error occured in main process:\\n\\n\" + readyError,\n\t\t\t}).then(function() {\n\t\t\t\telectron.app.quit()\n\t\t\t})\n\t\t\treturn\n\t\t}\n\n\t\tready = true\n\t\tinit()\n\t} catch (error) {\n\t\tthrow error\n\t}\n})\n"],"names":["Object","defineProperty","exports","value","getElectronBinding","name","process","_linkedBinding","electronBinding","deserialize","serialize","isSerializableObject","isPromise","electron_1","val","then","Function","constructor","reject","resolve","serializableTypes","Boolean","Number","String","Date","Error","RegExp","ArrayBuffer","isView","some","type","objectMap","source","mapper","targetEntries","entries","map","key","fromEntries","image","representations","scaleFactors","getScaleFactors","length","scaleFactor","size","getSize","buffer","toBitmap","push","dataURL","toDataURL","__ELECTRON_SERIALIZED_NativeImage__","serializeNativeImage","Array","isArray","nativeImage","createEmpty","width","height","addRepresentation","rep","deserializeNativeImage","initialize","server_1","enumerable","get","getOwnerKey","webContents","contextId","id","this","nextId","storage","owners","electronIds","WeakMap","add","obj","saveToStorage","ownerKey","owner","Map","registerDeleteListener","has","set","count","pointer","object","remove","newRefCount","delete","dereference","clear","keys","processHostId","split","listener","_","deletedProcessHostId","toString","removeListener","on","__importDefault","mod","__esModule","isRemoteModuleEnabled","events_1","objects_registry_1","type_utils_1","v8Util","FUNCTION_PROPERTIES","rendererFunctionCache","finalizationRegistry","FinalizationRegistry","fi","mapKey","ref","undefined","deref","isDestroyed","sendToFrame","frameId","error","console","warn","getCachedRendererFunction","locationInfo","getObjectMembers","names","getOwnPropertyNames","filter","includes","descriptor","getOwnPropertyDescriptor","writable","getObjectPrototype","proto","getPrototypeOf","prototype","members","valueToMeta","sender","optimizeSimpleObject","Buffer","hasOwnProperty","call","getHiddenValue","el","default","onFulfilled","onRejected","throwRPCError","message","code","errno","removeRemoteListenersAndLogWarning","callIntoRenderer","EventEmitter","remoteEvents","eventNames","eventName","listeners","join","forEach","unwrapArgs","args","metaToValue","meta","from","byteOffset","byteLength","Promise","ret","create","Proxy","target","prop","receiver","Reflect","returnValue","objectId","cachedFunction","succeed","location","wc","wr","WeakRef","register","setCachedRendererFunction","TypeError","isRemoteModuleEnabledCache","contents","webPreferences","getLastWebPreferences","enableRemoteModule","isRemoteModuleEnabledImpl","handleRemoteCommand","channel","handler","ipcMain","event","emitCustomEvent","defaultPrevented","app","emit","logStack","stack","initialized","passedContextId","moduleName","customEvent","mainModule","require","globalName","global","getOwnerBrowserWindow","func","err","cause","method","module","mask","output","offset","i","unmask","__dirname","e","fs","path","os","runtimeRequire","vars","config","variables","prebuildsOnly","PREBUILDS_ONLY","abi","versions","modules","runtime","electron","ELECTRON_RUN_AS_NODE","window","arch","platform","libc","LIBC","existsSync","isAlpine","armv","ARM_VERSION","arm_version","uv","load","dir","readdirSync","getFirst","files","matchBuild","test","parseTuple","arr","architectures","every","matchTuple","tuple","compareTuples","a","b","parseTags","file","tags","specificity","pop","tag","napi","slice","matchTags","runtimeAgnostic","compareTags","toUpperCase","replace","release","debug","prebuild","nearby","dirname","execPath","node","sort","prebuilds","winner","buf","len","EMPTY_BUFFER","concat","list","totalLength","allocUnsafe","_mask","_unmask","toArrayBuffer","toBuffer","data","readOnly","isBuffer","bufferUtil","BINARY_TYPES","alloc","GUID","kForOnEventAttribute","Symbol","kListener","kStatusCode","kWebSocket","NOOP","kCode","kData","kError","kMessage","kReason","kTarget","kType","kWasClean","Event","CloseEvent","options","super","reason","wasClean","ErrorEvent","MessageEvent","EventTarget","addEventListener","wrapper","isBinary","_closeFrameReceived","_closeFrameSent","once","removeEventListener","tokenChars","dest","elem","format","extensions","extension","configurations","params","k","values","v","parse","header","offers","extensionName","paramName","mustUnescape","isEscaping","inQuotes","start","end","charCodeAt","SyntaxError","token","kDone","kRun","concurrency","pending","Infinity","jobs","job","shift","zlib","Limiter","TRAILER","kPerMessageDeflate","kTotalLength","kCallback","kBuffers","zlibLimiter","deflateOnData","chunk","inflateOnData","_maxPayload","RangeError","reset","inflateOnError","_inflate","isServer","maxPayload","_options","_threshold","threshold","_isServer","_deflate","concurrencyLimit","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","accept","normalizeParams","acceptAsServer","acceptAsClient","cleanup","close","callback","opts","accepted","find","response","num","isInteger","decompress","fin","done","_decompress","result","compress","_compress","endpoint","windowBits","Z_DEFAULT_WINDOWBITS","createInflateRaw","zlibInflateOptions","write","flush","_readableState","endEmitted","createDeflateRaw","zlibDeflateOptions","Z_SYNC_FLUSH","Writable","PerMessageDeflate","isValidStatusCode","isValidUTF8","ErrorCtor","prefix","statusCode","errorCode","captureStackTrace","_binaryType","binaryType","_extensions","_skipUTF8Validation","skipUTF8Validation","_bufferedBytes","_buffers","_compressed","_payloadLength","_fragmented","_masked","_fin","_opcode","_totalPayloadLength","_messageLength","_fragments","_state","_loop","_write","encoding","cb","startLoop","consume","n","dst","Uint8Array","getInfo","getPayloadLength16","getPayloadLength64","getMask","getData","compressed","haveLength","readUInt16BE","readUInt32BE","Math","pow","controlMessage","dataMessage","er","messageLength","fragments","randomFillSync","applyMask","kByteLength","maskBuffer","Sender","socket","generateMask","_generateMask","_maskBuffer","_socket","_firstFragment","_deflating","_queue","static","dataLength","merge","skipMasking","payloadLength","opcode","rsv1","writeUInt16BE","writeUIntBE","enqueue","dispatch","sendFrame","frame","ping","pong","send","perMessageDeflate","binary","destroyed","dequeue","apply","cork","uncork","Duplex","emitClose","stream","duplexOnEnd","_writableState","finished","destroy","duplexOnError","listenerCount","ws","terminateOnDestroy","duplex","autoDestroy","objectMode","writableObjectMode","msg","pause","_destroy","readyState","CLOSED","nextTick","called","terminate","_final","CONNECTING","_read","isPaused","resume","protocols","Set","protocol","_isValidUTF8","http","createHash","subprotocol","WebSocket","keyRegex","server","socketOnError","abortHandshake","headers","STATUS_CODES","Connection","h","handleProtocols","clientTracking","verifyClient","noServer","backlog","host","port","_server","createServer","req","res","body","writeHead","listen","emitConnection","bind","_removeListeners","addListeners","listening","upgrade","head","handleUpgrade","clients","_shouldEmitClose","address","shouldHandle","index","url","indexOf","version","toLowerCase","secWebSocketProtocol","secWebSocketExtensions","info","origin","secure","authorized","encrypted","verified","completeUpgrade","readable","update","digest","next","_protocol","setSocket","https","net","tls","randomBytes","Readable","URL","Receiver","readyStates","subprotocolRegex","protocolVersions","_closeCode","_closeMessage","_closeTimer","_paused","_readyState","_receiver","_sender","_bufferedAmount","_redirects","initAsClient","bufferedAmount","onclose","onerror","onopen","onmessage","_url","receiverOnConclude","receiverOnDrain","receiverOnError","receiverOnMessage","receiverOnPing","receiverOnPong","setTimeout","setNoDelay","unshift","socketOnClose","socketOnData","socketOnEnd","OPEN","removeAllListeners","_req","CLOSING","errorEmitted","sendAfterClose","needDrain","websocket","protocolVersion","followRedirects","maxRedirects","createConnection","socketPath","hostname","timeout","parsedUrl","href","isSecure","isUnixSocket","invalidURLMessage","pathname","hash","emitErrorAndClose","defaultPort","protocolSet","tlsConnect","netConnect","startsWith","Upgrade","search","handshakeTimeout","Origin","username","password","auth","parts","_originalHost","authorization","cookie","aborted","addr","abort","serverProt","protError","extensionNames","connect","servername","isIP","setHeader","receiverOnFinish","read","clearTimeout","property","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","d","definition","o","BaseError","wrapErr","ReadError","WriteError","RequestError","level","time","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","logPath","Response","status","statusMessage","curKey","item","rawHeaders","json","JSON","jsonPassive","string","Request","tcp","hosts","ssl","parseInt","unix","ttl","put","post","stringify","nodeResp","resp","unixPath","webHost","unixWsHost","showConnect","callbacks","winDrive","systemDrv","getAuthToken","trim","dev","async","reconnected","wsHost","reconnect","log","dataBuf","disable_tray_icon","theme","configData","save","tray","awaken","ready","readyError","main","orig","errorMsg","buttons","title","awake","init","Main","showWindow","show","createWindow","minWidth","minHeight","maxWidth","maxHeight","zoomFactor","icon","autoHideMenuBar","fullscreen","backgroundColor","devTools","nodeIntegration","contextIsolation","enable","shown","openDevTools","indexUrl","encodeURIComponent","loadURL","userAgent","run","initTray","getTrayIcon","trayMenu","label","click","setToolTip","setContextMenu","setImage","appMenu","submenu","accelerator","role","initAppMenu","state","connTray","disconnTray","profilesPth","exists"],"sourceRoot":""}